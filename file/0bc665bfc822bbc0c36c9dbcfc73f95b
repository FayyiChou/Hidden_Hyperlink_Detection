<!DOCTYPE html>
<!--[if IE 7]>
<html class="ie ie7" lang="zh-CN">
<![endif]-->
<!--[if IE 8]>
<html class="ie ie8" lang="zh-CN">
<![endif]-->
<!--[if !(IE 7) & !(IE 8)]><!-->
<html lang="zh-CN">
<!--<![endif]-->
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width">
	<title>蔺晨 | 一只工科Ph.D的狗窝</title>
	<link rel="profile" href="http://gmpg.org/xfn/11">
	<link rel="pingback" href="http://www.baojun-liu.com/xmlrpc.php">
	<!--[if lt IE 9]>
	<script src="http://www.baojun-liu.com/wp-content/themes/twentyfourteen/js/html5.js"></script>
	<![endif]-->
	<link rel="alternate" type="application/rss+xml" title="蔺晨 &raquo; Feed" href="http://www.baojun-liu.com/?feed=rss2" />
<link rel="alternate" type="application/rss+xml" title="蔺晨 &raquo; 评论Feed" href="http://www.baojun-liu.com/?feed=comments-rss2" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/72x72\/","ext":".png","source":{"concatemoji":"http:\/\/www.baojun-liu.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.5.2"}};
			!function(a,b,c){function d(a){var c,d,e,f=b.createElement("canvas"),g=f.getContext&&f.getContext("2d"),h=String.fromCharCode;if(!g||!g.fillText)return!1;switch(g.textBaseline="top",g.font="600 32px Arial",a){case"flag":return g.fillText(h(55356,56806,55356,56826),0,0),f.toDataURL().length>3e3;case"diversity":return g.fillText(h(55356,57221),0,0),c=g.getImageData(16,16,1,1).data,d=c[0]+","+c[1]+","+c[2]+","+c[3],g.fillText(h(55356,57221,55356,57343),0,0),c=g.getImageData(16,16,1,1).data,e=c[0]+","+c[1]+","+c[2]+","+c[3],d!==e;case"simple":return g.fillText(h(55357,56835),0,0),0!==g.getImageData(16,16,1,1).data[0];case"unicode8":return g.fillText(h(55356,57135),0,0),0!==g.getImageData(16,16,1,1).data[0]}return!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g,h,i;for(i=Array("simple","flag","unicode8","diversity"),c.supports={everything:!0,everythingExceptFlag:!0},h=0;h<i.length;h++)c.supports[i[h]]=d(i[h]),c.supports.everything=c.supports.everything&&c.supports[i[h]],"flag"!==i[h]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[i[h]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel='stylesheet' id='twentyfourteen-lato-css'  href='https://fonts.googleapis.com/css?family=Lato%3A300%2C400%2C700%2C900%2C300italic%2C400italic%2C700italic&#038;subset=latin%2Clatin-ext' type='text/css' media='all' />
<link rel='stylesheet' id='genericons-css'  href='http://www.baojun-liu.com/wp-content/themes/twentyfourteen/genericons/genericons.css?ver=3.0.3' type='text/css' media='all' />
<link rel='stylesheet' id='twentyfourteen-style-css'  href='http://www.baojun-liu.com/wp-content/themes/twentyfourteen/style.css?ver=4.5.2' type='text/css' media='all' />
<!--[if lt IE 9]>
<link rel='stylesheet' id='twentyfourteen-ie-css'  href='http://www.baojun-liu.com/wp-content/themes/twentyfourteen/css/ie.css?ver=20131205' type='text/css' media='all' />
<![endif]-->
<script type='text/javascript' src='http://www.baojun-liu.com/wp-includes/js/jquery/jquery.js?ver=1.12.3'></script>
<script type='text/javascript' src='http://www.baojun-liu.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.0'></script>
<link rel='https://api.w.org/' href='http://www.baojun-liu.com/?rest_route=/' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://www.baojun-liu.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://www.baojun-liu.com/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 4.5.2" />
<link rel="icon" href="http://www.baojun-liu.com/wp-content/uploads/2016/06/cropped-20151015035803326-32x32.jpg" sizes="32x32" />
<link rel="icon" href="http://www.baojun-liu.com/wp-content/uploads/2016/06/cropped-20151015035803326-192x192.jpg" sizes="192x192" />
<link rel="apple-touch-icon-precomposed" href="http://www.baojun-liu.com/wp-content/uploads/2016/06/cropped-20151015035803326-180x180.jpg" />
<meta name="msapplication-TileImage" content="http://www.baojun-liu.com/wp-content/uploads/2016/06/cropped-20151015035803326-270x270.jpg" />
</head>

<body class="home blog group-blog masthead-fixed list-view full-width slider">
<div id="page" class="hfeed site">
	
	<header id="masthead" class="site-header" role="banner">
		<div class="header-main">
			<h1 class="site-title"><a href="http://www.baojun-liu.com/" rel="home">蔺晨</a></h1>

			<div class="search-toggle">
				<a href="#search-container" class="screen-reader-text" aria-expanded="false" aria-controls="search-container">搜索</a>
			</div>

			<nav id="primary-navigation" class="site-navigation primary-navigation" role="navigation">
				<button class="menu-toggle">主菜单</button>
				<a class="screen-reader-text skip-link" href="#content">跳至内容</a>
				<div id="primary-menu" class="nav-menu"></div>
			</nav>
		</div>

		<div id="search-container" class="search-box-wrapper hide">
			<div class="search-box">
				<form role="search" method="get" class="search-form" action="http://www.baojun-liu.com/">
				<label>
					<span class="screen-reader-text">搜索：</span>
					<input type="search" class="search-field" placeholder="搜索&hellip;" value="" name="s" />
				</label>
				<input type="submit" class="search-submit" value="搜索" />
			</form>			</div>
		</div>
	</header><!-- #masthead -->

	<div id="main" class="site-main">

<div id="main-content" class="main-content">


	<div id="primary" class="content-area">
		<div id="content" class="site-content" role="main">

		
<article id="post-78" class="post-78 post type-post status-publish format-standard hentry category-live-love">
	
	<header class="entry-header">
				<div class="entry-meta">
			<span class="cat-links"><a href="http://www.baojun-liu.com/?cat=2" rel="category">Live &amp; Love</a></span>
		</div>
		<h1 class="entry-title"><a href="http://www.baojun-liu.com/?p=78" rel="bookmark">书单</a></h1>
		<div class="entry-meta">
			<span class="entry-date"><a href="http://www.baojun-liu.com/?p=78" rel="bookmark"><time class="entry-date" datetime="2016-06-18T02:04:44+00:00">2016年6月18日</time></a></span> <span class="byline"><span class="author vcard"><a class="url fn n" href="http://www.baojun-liu.com/?author=1" rel="author">linchen</a></span></span>			<span class="comments-link"><a href="http://www.baojun-liu.com/?p=78#respond">发表回复</a></span>
					</div><!-- .entry-meta -->
	</header><!-- .entry-header -->

		<div class="entry-content">
		<p>创建于16/6， 目标为半年的时间，平均每月看两本专业外书籍。<br />
目前兴趣点在：民主与政治、法律、经济体系、中国社会、心理学、历史等</p>
<p>六月份：<br />
民主的细节 大而不倒<br />
心理学与生活<br />
七月份：<br />
精进 精要主义 明朝那些事儿<br />
中国法律与中国社会</p>
	</div><!-- .entry-content -->
	
	</article><!-- #post-## -->

<article id="post-70" class="post-70 post type-post status-publish format-standard hentry category-tech">
	
	<header class="entry-header">
				<div class="entry-meta">
			<span class="cat-links"><a href="http://www.baojun-liu.com/?cat=3" rel="category">Tech</a></span>
		</div>
		<h1 class="entry-title"><a href="http://www.baojun-liu.com/?p=70" rel="bookmark">如何从CDN/Cache/Proxy Server上稳定的获取页面</a></h1>
		<div class="entry-meta">
			<span class="entry-date"><a href="http://www.baojun-liu.com/?p=70" rel="bookmark"><time class="entry-date" datetime="2016-06-13T04:12:13+00:00">2016年6月13日</time></a></span> <span class="byline"><span class="author vcard"><a class="url fn n" href="http://www.baojun-liu.com/?author=1" rel="author">linchen</a></span></span>			<span class="comments-link"><a href="http://www.baojun-liu.com/?p=70#comments">1条评论</a></span>
					</div><!-- .entry-meta -->
	</header><!-- .entry-header -->

		<div class="entry-content">
		<p>Keyword：微博页面获取<br />
Keyword： Cache Server缓存页面获取</p>
<p>之所以起这个头，是因为前段时间遇到了一些问题。第一：关于微博页面的获取，由于微博进行了一次升级，需要JS脚本在浏览器中执行，因为普通的wget是无法获取页面的。此外，很多模拟浏览器的框架在linux下搭建非常麻烦（不讨论在Windows中的情况）。第二：部分运营商自建Cache Server对HTTP请求进行了严格的限制，目前还没有查到到底是哪个环节出的问题，wget请求会被返回403 forbidden。 本文就是专门解决这一问题的。</p>
<p>使用python模拟浏览器环境，稳定的获取页面。</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>来源：表示这本书买的太值了！</p>
<p><img src="https://img1.doubanio.com/mpic/s28385338.jpg" alt="python绝技：运用python成为顶级黑客" /></p>
	</div><!-- .entry-content -->
	
	</article><!-- #post-## -->

<article id="post-68" class="post-68 post type-post status-publish format-standard hentry category-live-love">
	
	<header class="entry-header">
				<div class="entry-meta">
			<span class="cat-links"><a href="http://www.baojun-liu.com/?cat=2" rel="category">Live &amp; Love</a></span>
		</div>
		<h1 class="entry-title"><a href="http://www.baojun-liu.com/?p=68" rel="bookmark">忆高考</a></h1>
		<div class="entry-meta">
			<span class="entry-date"><a href="http://www.baojun-liu.com/?p=68" rel="bookmark"><time class="entry-date" datetime="2016-06-13T04:07:45+00:00">2016年6月13日</time></a></span> <span class="byline"><span class="author vcard"><a class="url fn n" href="http://www.baojun-liu.com/?author=1" rel="author">linchen</a></span></span>			<span class="comments-link"><a href="http://www.baojun-liu.com/?p=68#respond">发表回复</a></span>
					</div><!-- .entry-meta -->
	</header><!-- .entry-header -->

		<div class="entry-content">
		<p>今天看到了人民日报评价美国高考的文章，觉得最近官媒文章的格局确实不高。不过也想起来我的高考。日后关于高考的所有会议都在这里更吧。</p>
<p><strong>其实，没那么苦逼</strong></p>
<p>语文篇&#8211;不堪回首的记忆</p>
<p>&nbsp;</p>
	</div><!-- .entry-content -->
	
	</article><!-- #post-## -->

<article id="post-65" class="post-65 post type-post status-publish format-standard hentry category-tech">
	
	<header class="entry-header">
				<div class="entry-meta">
			<span class="cat-links"><a href="http://www.baojun-liu.com/?cat=3" rel="category">Tech</a></span>
		</div>
		<h1 class="entry-title"><a href="http://www.baojun-liu.com/?p=65" rel="bookmark">流量劫持 &#8211; 转载自渔村安全</a></h1>
		<div class="entry-meta">
			<span class="entry-date"><a href="http://www.baojun-liu.com/?p=65" rel="bookmark"><time class="entry-date" datetime="2016-06-12T19:35:24+00:00">2016年6月12日</time></a></span> <span class="byline"><span class="author vcard"><a class="url fn n" href="http://www.baojun-liu.com/?author=1" rel="author">linchen</a></span></span>			<span class="comments-link"><a href="http://www.baojun-liu.com/?p=65#respond">发表回复</a></span>
					</div><!-- .entry-meta -->
	</header><!-- .entry-header -->

		<div class="entry-content">
		<h2>一 、本地劫持</h2>
<p><b>在鼠标点击的一刹那，流量在用户系统中流过层层节点，在路由的指引下奔向远程服务器。这段路程中短兵相接的战斗往往是最激烈的，在所有流量可能路过的节点往往都埋伏着劫持者，流量劫持的手段也层出不穷，从主页配置篡改、hosts劫持、进程Hook、启动劫持、LSP注入、浏览器插件劫持、http代理过滤、内核数据包劫持、bootkit等等不断花样翻新。或许从开机的一瞬间，流量劫持的故事就已经开始。</b></p>
<p><b>1.道貌岸然的流氓软件</b></p>
<p>“网址导航”堪称国内互联网最独特的一道风景线，从hao123开始发扬光大，各大导航站开始成为互联网流量最主要的一个入口点，伴随着的是围绕导航主页链接的小尾巴(推广ID)，展开的一场场惊心动魄的攻防狙击战。一方面国内安全软件对传统IE浏览器的主页防护越来越严密， 另一方面用户体验更好的第三方浏览器开始占据主流地位，国内的流氓木马为了谋求导航量也开始“另辟蹊径”。</p>
<p>下面讲到的案例是我们曾经捕获到的一批导航主页劫持样本，历史活跃期最早可以追溯到2014年，主要通过多类流氓软件捆绑传播，其劫持功能模块通过联网更新获取，经过多层的内存解密后再动态加载。其中的主页劫持插件模块通过修改浏览器配置文件实现主页篡改，对国内外的chrome、火狐、safari、傲游、qq、360、搜狗等20余款主流浏览器做到了全部覆盖。实现这些功能显然需要对这批浏览器的配置文件格式和加密算法做逆向分析，在样本分析过程中我们甚至发现其利用某漏洞绕过了其中2款浏览器的主页保护功能，流氓作者可谓非常“走心”，可惜是剑走偏锋。</p>
<p><a class="highslide-image" href="http://image.3001.net/images/20160516/14633682163223.png" target="_blank"><img src="http://image.3001.net/images/20160516/14633682163223.png!small" alt="图片1.png" width="690" data-original="http://image.3001.net/images/20160516/14633682163223.png!small" /></a></p>
<p>[1] 某软件下拉加载主页劫持插件</p>
<p>上图就是我们在其中一款软件中抓取到的主页劫持模块文件和更新数据包，可能你对数据包里这个域名不是很熟悉，但是提到“音速启动”这款软件相信安全圈内很多人都会有所了解，当年各大安全论坛的工具包基本上都是用它来管理配置的，伴随了很多像本文作者这样的三流小黑客的学习成长，所以分析这个样本过程中还是有很多感触的，当然这些木马劫持行为可能和原作者没有太大关系，听说这款软件在停止更新几年后卖给了上海某科技公司，其旗下多款软件产品都曾被发现过流氓劫持行为，感兴趣的读者可以自行百度，这里不再进行更多的披露。</p>
<p>正如前面的案例，一部分曾经的老牌软件开始慢慢变质，离用户渐行渐远；另一方面，随着最近几年国内安全环境的转变，之前流行的盗号、下载者、远控等传统木马日渐式微，另外一大批披着正规软件外衣的流氓也开始兴起，他们的运作方式有以下几个特点：</p>
<p>1.冒充正规软件，但实际功能单一简陋，有些甚至是空壳软件，常见的诸如某某日历、天气预报、色播、输入法等五花八门的伪装形式，企图借助这些正常功能的外衣逃避安全软件的拦截，实现常驻用户系统的目的。</p>
<p>2.背后行为与木马病毒无异，其目的还是为了获取推广流量，如主页锁定，网页劫持、广告弹窗、流量暗刷、静默安装等等。而且其中很大一部分流氓软件的恶意模块和配置都通过云端进行下拉控制，可以做到分时段、分地区、分场景进行投放触发。</p>
<p><a class="highslide-image" href="http://image.3001.net/images/20160516/14633682781783.png" target="_blank"><img src="http://image.3001.net/images/20160516/14633682781783.png!small" alt="图片2.png" width="690" data-original="http://image.3001.net/images/20160516/14633682781783.png!small" /></a></p>
<p>[2] 某流氓软件的云端控制后台</p>
<p>3.变种速度比较快，屡杀不止，被安全软件拦截清理后很快就会更换数字签名，甚至换个软件外壳包装后卷土重来。这些数字签名注册的企业信息很多都是流氓软件作者从其他渠道专门收购的。</p>
<p><a class="highslide-image" href="http://image.3001.net/images/20160516/14633683262201.png" target="_blank"><img src="http://image.3001.net/images/20160516/14633683262201.png!small" alt="图片3.png" width="690" data-original="http://image.3001.net/images/20160516/14633683262201.png!small" /></a></p>
<p>[3]某流氓软件1个月内多次更换数字签名证书逃避安全软件查杀</p>
<p>下面可以通过几个典型案例了解下这些流氓软件进行流量劫持的技术手法：</p>
<p>1）通过浏览器插件进行流量劫持的QTV系列变种，该样本针对IE浏览器通过BHO插件在用户网页中注入JS脚本，针对chrome内核的浏览器利用漏洞绕过了部分浏览器插件的正常安装步骤，通过篡改配置文件添加浏览器插件实现动态劫持。</p>
<p><a class="highslide-image" href="http://image.3001.net/images/20160517/14634565881519.png" target="_blank"><img src="http://image.3001.net/images/20160517/14634565881519.png!small" alt="图片1.png" width="635" data-original="http://image.3001.net/images/20160517/14634565881519.png!small" /></a></p>
<p>[4]被静默安装到浏览器中的插件模块，通过JS注入劫持网页</p>
<p>通过注入JS脚本来劫持用户网页浏览的技术优点也很明显，一方面注入的云端JS脚本比较灵活，可以随时在云端控制修改劫持行为，另一方面对于普通用户来说非常隐蔽，难以察觉。被注入用户网页的JS脚本的对网页浏览中大部分的推广流量都进行了劫持，如下图：</p>
<p><a class="highslide-image" href="http://image.3001.net/images/20160516/14633684122596.png" target="_blank"><img src="http://image.3001.net/images/20160516/14633684122596.png!small" alt="图片5.png" width="690" data-original="http://image.3001.net/images/20160516/14633684122596.png!small" /></a></p>
<p>[5] 在网页中注入JS劫持推广流量</p>
<p>2）下面这个“高清影视流氓病毒”案例是去年曾深入跟踪的一个流氓病毒传播团伙，该类样本主要伪装成播放器类的流氓软件进行传播，技术特点如下图所示，大部分劫持模块都是驱动文件，通过动态内存加载到系统内核，实现浏览器劫持、静默推广等病毒行为。</p>
<p><a class="highslide-image" href="http://image.3001.net/images/20160516/14633684406502.png" target="_blank"><img src="http://image.3001.net/images/20160516/14633684406502.png!small" alt="图片6.png" width="690" data-original="http://image.3001.net/images/20160516/14633684406502.png!small" /></a></p>
<p>[6] “高清影视”木马劫持流程简图</p>
<p>从木马后台服务器取证的文件来看，该样本短期内传播量非常大，单日高峰达到20w+，一周累计感染用户超过100万，安装统计数据库每天的备份文件都超过1G。</p>
<p><a class="highslide-image" href="http://image.3001.net/images/20160517/14634566086867.png" target="_blank"><img src="http://image.3001.net/images/20160517/14634566086867.png!small" alt="图片2.png" width="690" data-original="http://image.3001.net/images/20160517/14634566086867.png!small" /></a></p>
<p>[7] “高清影视”木马后台服务器取证</p>
<p><b>2.持续活跃的广告弹窗挂马</b></p>
<p>提到流量劫持，不得不说到近2年时间内保持高度活跃的广告弹窗挂马攻击案例，原本的广告流量被注入了网页木马，以广告弹窗等形式在客户端触发，这属于一种变相的流量劫持，更确切的说应该称之为“流量污染”或“流量投毒”，这里我们将其归类为本地劫持。</p>
<p>近期挂马利用的漏洞多为IE神洞(cve-2014-6332)和HackingTeam泄漏的多个Flash漏洞。通过网页挂马，流量劫持者将非常廉价的广告弹窗流量转化成了更高价格的安装量，常见的CPM、CPV等形式的广告流量每1000用户展示只有几元钱的成本，假设网页挂马的成功率有5%，这意味着劫持者获取到20个用户的安装量，平均每个用户静默安装5款软件，劫持者的收益保守估计有50元，那么“广告流量投毒”的利润率就近10倍。这应该就是近两年网页挂马事件频发背后的最大源动力。</p>
<p><a class="highslide-image" href="http://image.3001.net/images/20160516/14633684946207.png" target="_blank"><img src="http://image.3001.net/images/20160516/14633684946207.png!small" alt="图片8.png" width="690" data-original="http://image.3001.net/images/20160516/14633684946207.png!small" /></a></p>
<p>[8] 网页木马经常使用的IE神洞(CVE-2014-6332)</p>
<p><a class="highslide-image" href="http://image.3001.net/images/20160516/14633988857329.png" target="_blank"><img src="http://image.3001.net/images/20160516/14633988857329.png!small" alt="图片9.png" width="690" data-original="http://image.3001.net/images/20160516/14633988857329.png!small" /></a></p>
<p>[9] 网页木马利用IE浏览器的res协议检测国内主流安全软件</p>
<p>这些广告流量大多来自于软件弹窗、色情站点、垃圾站群、运营商劫持量等等，其中甚至不乏很多知名软件的广告流量，从我们的监测数据中发现包括酷狗音乐、搜狐影音、电信管家、暴风影音、百度影音、皮皮影音等多家知名软件厂商的广告流量被曾被劫持挂马。正是因为如此巨大的流量基数，所以一旦发生挂马事件，受到安全威胁的用户数量都是非常巨大的。</p>
<p><a class="highslide-image" href="http://image.3001.net/images/20160516/14633989145442.png" target="_blank"><img src="http://image.3001.net/images/20160516/14633989145442.png!small" alt="图片10.png" width="690" data-original="http://image.3001.net/images/20160516/14633989145442.png!small" /></a></p>
<p>[10] 对利用客户端弹窗挂马的某病毒服务器取证发现的flash漏洞exp</p>
<p>据了解很多软件厂商对自身广告流量的管理监控都存在漏洞，有些甚至经过了多层代理分包，又缺乏统一有力的安全审核机制，导致被插入网页木马的“染毒流量”被大批推送到客户端，最终导致用户系统感染病毒。在样本溯源过程中，我们甚至在某知名音乐软件中发现一个专门用于暗刷广告流量的子模块。用户越多责任越大，且行且珍惜。</p>
<p><a class="highslide-image" href="http://image.3001.net/images/20160516/1463398949982.png" target="_blank"><img src="http://image.3001.net/images/20160516/1463398949982.png!small" alt="图片11.png" width="690" data-original="http://image.3001.net/images/20160516/1463398949982.png!small" /></a></p>
<p>[11] 2015年某次挂马事件涉及的弹窗客户端进程列表</p>
<p><a class="highslide-image" href="http://image.3001.net/images/20160516/14633989729142.png" target="_blank"><img src="http://image.3001.net/images/20160516/14633989729142.png!small" alt="图片12.png" width="597" data-original="http://image.3001.net/images/20160516/14633989729142.png!small" /></a></p>
<p>[12] 对2015年度最活跃的某挂马服务器的数据库取证(高峰期每小时5k+的安装量)</p>
<h2>二、网络劫持</h2>
<p>流量劫持的故事继续发展，当一个网络数据包成功躲开了本地主机系统上的层层围剿，离开用户主机穿行于各个路由网关节点，又开启了一段新的冒险之旅。在用户主机和远程服务器之间的道路同样是埋伏重重，数据包可能被指引向错误的终点(DNS劫持)，也可能被半路冒名顶替(302重定向)，或者直接被篡改(http注入)。</p>
<p><b>1.运营商劫持</b></p>
<p>提起网络劫持往往第一个想起的就是运营商劫持，可能每一个上网的用户或多或少都曾经遇到过，电脑系统或手机用安全软件扫描没有任何异常，但是打开正常网页总是莫名其妙弹出广告或者跳转到其他网站。对普通用户来说这样的行为可以说深恶痛绝，企业和正规网站同样也深受其害，正常业务和企业形象都会受到影响，在15年年底，腾讯、小米、微博等6家互联网公司共同发表了一篇抵制运营商流量劫持的联合声明。</p>
<p>在我们日常的安全运营过程中也经常接到疑似运营商劫持的用户反馈，下面讲述一个非常典型的http劫持跳转案例，用户反馈打开猎豹浏览器首页点击下载就会弹出广告页面，经过我们的检测发现用户的网络被运营商劫持，打开网页的数据包中被注入了广告劫持代码。类似的案例还有很多，除了明面上的广告弹窗，还有后台静默的流量暗刷。对于普通用户来说，可能只有运营商客服投诉或工信部投诉才能让这些劫持行为稍有收敛。</p>
<p><a class="highslide-image" href="http://image.3001.net/images/20160516/14633990121721.png" target="_blank"><img src="http://image.3001.net/images/20160516/14633990121721.png!small" alt="图片13.png" width="690" data-original="http://image.3001.net/images/20160516/14633990121721.png!small" /></a></p>
<p>[13] 用户打开网页的数据包被注入广告代码</p>
<p><a class="highslide-image" href="http://image.3001.net/images/20160516/14633990352174.png" target="_blank"><img src="http://image.3001.net/images/20160516/14633990352174.png!small" alt="图片14.png" width="690" data-original="http://image.3001.net/images/20160516/14633990352174.png!small" /></a></p>
<p>[14] 用户任意点击网页触发广告弹窗跳转到“6间房”推广页面</p>
<p>这个案例劫持代码中的域名“abc.ss229.com”归属于推广广告联盟，在安全论坛和微博已有多次用户反馈，其官网号称日均PV达到2.5亿。其实运营商劫持流量的买卖其实已是圈内半公开的秘密，结合对用户上网习惯的分析，可以实现对不同地区、不同群体用户的精准定制化广告推送，感兴趣的读者可以自行搜索相关的QQ群。</p>
<p><a class="highslide-image" href="http://image.3001.net/images/20160516/1463399065934.png" target="_blank"><img src="http://image.3001.net/images/20160516/1463399065934.png!small" alt="图片15.png" width="690" data-original="http://image.3001.net/images/20160516/1463399065934.png!small" /></a></p>
<p>[15] 公开化的运营商劫持流量买卖</p>
<p>缺乏安全保护的dns协议和明文传输的http流量非常容易遭到劫持，而运营商占据网络流量的必经之路，在广告劫持技术上具有先天优势，比如常见的分光镜像技术，对于普通用户和厂商来说对抗成本相对较高，另一方面国内主流的搜索引擎、导航站点、电商网站都已经开始积极拥抱更加安全的https协议，这无疑是非常可喜的转变。</p>
<p><a class="highslide-image" href="http://image.3001.net/images/20160516/14633990946031.png" target="_blank"><img src="http://image.3001.net/images/20160516/14633990946031.png!small" alt="图片16.png" width="690" data-original="http://image.3001.net/images/20160516/14633990946031.png!small" /></a></p>
<p>[16] 常用于运营商流量劫持的分光镜像技术</p>
<p>wooyun平台上也曾多次曝光运营商流量劫持的案例，例如曾经被用户举报的案例“下载小米商城被劫持到UC浏览器APP”，感谢万能的白帽子深入某运营商劫持平台系统为我们揭秘内幕。</p>
<p><a class="highslide-image" href="http://image.3001.net/images/20160516/14633991207080.png" target="_blank"><img src="http://image.3001.net/images/20160516/14633991207080.png!small" alt="图片17.png" width="690" data-original="http://image.3001.net/images/20160516/14633991207080.png!small" /></a></p>
<p>[17] 被曝光的某运营商apk下载分发劫持的管理后台</p>
<p>以上种种，不得不让人想起“打劫圈”最富盛名的一句浑语，“此山是我开,此树是我栽,要想过此路,留下买路财”，“买网络送广告”已经成为网络运营商的标准套餐。这些劫持流量的买卖显然不仅仅是所谓的“个别内部员工违规操作”，还是那句话，用户越多责任越大，且行且珍惜。</p>
<p><b>2.CDN缓存污染</b></p>
<p>CDN加速技术本质上是一种良性的DNS劫持，通过DNS引导将用户对服务器上的js、图片等不经常变化的静态资源的请求引导到最近的服务器上，从而加速网络访问。加速访问的良好用户体验使CDN加速被各大网站广泛使用，其中蕴含的惊人流量自然也成为流量劫持者的目标。</p>
<p><a class="highslide-image" href="http://image.3001.net/images/20160516/14633991499321.png" target="_blank"><img src="http://image.3001.net/images/20160516/14633991499321.png!small" alt="图片18.png" width="423" data-original="http://image.3001.net/images/20160516/14633991499321.png!small" /></a></p>
<p>[18] 用户打开正常网页后跳转到“色播”诱导页面</p>
<p>去年我们曾多次接到用户反馈使用手机浏览器打开网页时经常被跳转到色情推广页面，经过抓包分析，发现是由于百度网盟CDN缓存服务器中的关键JS文件被污染注入广告代码，劫持代码根据user-agent头判断流量来源后针对PC、android、iso等平台进行分流弹窗，诱导用户安装“伪色播”病毒APP。</p>
<p><a class="highslide-image" href="http://image.3001.net/images/20160516/14633991751187.png" target="_blank"><img src="http://image.3001.net/images/20160516/14633991751187.png!small" alt="图片19.png" width="690" data-original="http://image.3001.net/images/20160516/14633991751187.png!small" /></a></p>
<p>[19] 抓包分析显示百度网盟的公共JS文件被注入广告代码</p>
<p><a class="highslide-image" href="http://image.3001.net/images/20160516/14633992044896.png" target="_blank"><img src="http://image.3001.net/images/20160516/14633992044896.png!small" alt="图片20.png" width="690" data-original="http://image.3001.net/images/20160516/14633992044896.png!small" /></a></p>
<p>[20] 劫持代码根据访问来源平台的不同进行分流，推广“伪色播”病毒app</p>
<p>百度网盟作为全国最大的广告联盟之一，每天的广告流量PV是都是以亿为单位的，其CDN缓存遭遇劫持产生的影响将非常广泛。通过分析我们确认全国只有个别地区的网络会遭遇此类劫持，我们也在第一时间将这个情况反馈给了友商方面，但造成缓存被劫持的原因没有得到最终反馈，是运营商中间劫持还是个别缓存服务器被入侵导致还不得而知，但是这个案例给我们的CDN服务的安全防护再一次给我们敲响警钟。</p>
<p><a class="highslide-image" href="http://image.3001.net/images/20160517/14634567538791.png" target="_blank"><img src="http://image.3001.net/images/20160517/14634567538791.png!small" alt="图片3.png" width="690" data-original="http://image.3001.net/images/20160517/14634567538791.png!small" /></a></p>
<p>[21] 通过流量劫持推广的“伪色播”病毒APP行为流程简图</p>
<p>从这个案例中我们也可以看出，移动端“劫持流量”很重要的一个出口就是“伪色情”诱导，这些病毒app基本上都是通过短信暗扣、诱导支付、广告弹窗、流量暗刷以及推广安装等手段实现非法牟利。这条移动端的灰色产业链在近两年已经发展成熟，“色播”类样本也成为移动端中感染量最大的恶意app家族分类之一。</p>
<p><a class="highslide-image" href="http://image.3001.net/images/20160516/14633992644346.png" target="_blank"><img src="http://image.3001.net/images/20160516/14633992644346.png!small" alt="图片22.png" width="690" data-original="http://image.3001.net/images/20160516/14633992644346.png!small" /></a></p>
<p>[22] “伪色播”病毒APP进行诱导推广</p>
<p>这些“伪色播”病毒app安装以后除了各种广告推广行为外，还会在后台偷偷发送短信去定制多种运营商付费业务，并且对业务确认短信进行自动回复和屏蔽，防止用户察觉；有些还集成了第三方支付的SDK，以VIP充值等方式诱导用户付费，用户到头来没看到想要的“福利”不说，吃了黄连也只能是有苦难言。</p>
<p><a class="highslide-image" href="http://image.3001.net/images/20160516/14633992896175.png" target="_blank"><img src="http://image.3001.net/images/20160516/14633992896175.png!small" alt="图片23.png" width="690" data-original="http://image.3001.net/images/20160516/14633992896175.png!small" /></a></p>
<p>[23] 某“伪色播”病毒app通过短信定制业务进行扣费的接口数据包</p>
<p><a class="highslide-image" href="http://image.3001.net/images/20160516/14633993167235.png" target="_blank"><img src="http://image.3001.net/images/20160516/14633993167235.png!small" alt="图片24.png" width="686" data-original="http://image.3001.net/images/20160516/14633993167235.png!small" /></a></p>
<p>[24]病毒app自动回复并屏蔽业务短信，防止用户察觉</p>
<p>以其中某个专门做“色播诱导”业务的广告联盟为例，其背后的推广渠道多达数百个，每年用于推广结算的财务流水超过5000w元。从其旗下的某款色播病毒app的管理后台来看，短短半年内扣费订单数据超过100w条，平均每个用户扣费金额从6~20元不等，抛开其他的流氓推广收益，仅扣费这一项的半年收益总额就过百万，而这只是海量“伪色播”病毒样本中的一个，那整个产业链的暴利收益可想而知。</p>
<p><a class="highslide-image" href="http://image.3001.net/images/20160516/146339947940.png" target="_blank"><img src="http://image.3001.net/images/20160516/146339947940.png!small" alt="图片25.png" width="690" data-original="http://image.3001.net/images/20160516/146339947940.png!small" /></a></p>
<p>[25] 某“伪色播”病毒app的扣费统计后台</p>
<p><a class="highslide-image" href="http://image.3001.net/images/20160516/14633995058108.png" target="_blank"><img src="http://image.3001.net/images/20160516/14633995058108.png!small" alt="图片26.png" width="690" data-original="http://image.3001.net/images/20160516/14633995058108.png!small" /></a></p>
<p>[26] 某“伪色播”病毒app扣费通道的数据存储服务器</p>
<p><b>3.DNS劫持</b></p>
<p>路由器作为亿万用户网络接入的基础设备，其安全的重要性不言而喻。最近两年曝光的路由器漏洞、后门等案例比比皆是，主流路由器品牌基本上无一漏网。虽然部分厂商发布了修复补丁固件，但是普通用户很少会主动去更新升级路由器系统，所以路由器漏洞危害的持续性要远高于普通PC平台；另一方面，针对路由器的安全防护也一直是传统安全软件的空白点，用户路由器一旦中招往往无法察觉。</p>
<p>国内外针对路由器的攻击事件最近两年也非常频繁，我们目前发现的攻击方式主要分为两大类，一类是利用漏洞或后门获取路由器系统权限后种植僵尸木马，一般以ddos木马居多，还兼容路由器常见的arm、mips等嵌入式平台；另一类是获取路由器管理权限后篡改默认的DNS服务器设置，通过DNS劫持用户流量，一般用于广告刷量、钓鱼攻击等。</p>
<p><a class="highslide-image" href="http://image.3001.net/images/20160516/14633995654443.png" target="_blank"><img src="http://image.3001.net/images/20160516/14633995654443.png!small" alt="图片27.png" width="690" data-original="http://image.3001.net/images/20160516/14633995654443.png!small" /></a></p>
<p>[27] 兼容多平台的路由器DDOS木马样本</p>
<p>下面这个案例是我们近期发现的一个非常典型的dns劫持案例，劫持者通过路由器漏洞劫持用户DNS，在用户网页中注入JS劫持代码，实现导航劫持、电商广告劫持、流量暗刷等。从劫持代码中还发现了针对d-link、tp-link、zte等品牌路由器的攻击代码，利用CSRF漏洞篡改路由器DNS设置。</p>
<p><a class="highslide-image" href="http://image.3001.net/images/20160516/14633996854882.png" target="_blank"><img src="http://image.3001.net/images/20160516/14633996854882.png!small" alt="图片28.png" width="690" data-original="http://image.3001.net/images/20160516/14633996854882.png!small" /></a></p>
<p>[28] 路由器DNS流量劫持案例简图</p>
<p><a class="highslide-image" href="http://image.3001.net/images/20160516/14633997528249.png" target="_blank"><img src="http://image.3001.net/images/20160516/14633997528249.png!small" alt="图片29.png" width="690" data-original="http://image.3001.net/images/20160516/14633997528249.png!small" /></a></p>
<p>[29] 针对d-link、tp-link、zte等品牌路由器的攻击代码</p>
<p>被篡改的恶意DNS会劫持常见导航站的静态资源域名，例如s0.hao123img.com、s0.qhimg.com等，劫持者会在网页引用的jquery库中注入JS代码，以实现后续的劫持行为。由于页面缓存的原因，通过JS缓存投毒还可以实现长期隐蔽劫持。</p>
<p><a class="highslide-image" href="http://image.3001.net/images/20160516/14633997887558.png" target="_blank"><img src="http://image.3001.net/images/20160516/14633997887558.png!small" alt="图片30.png" width="690" data-original="http://image.3001.net/images/20160516/14633997887558.png!small" /></a></p>
<p>[30] 常见的导航站点域名被劫持</p>
<p><a class="highslide-image" href="http://image.3001.net/images/20160516/14633998163196.png" target="_blank"><img src="http://image.3001.net/images/20160516/14633998163196.png!small" alt="图片31.png" width="690" data-original="http://image.3001.net/images/20160516/14633998163196.png!small" /></a></p>
<p>[31] 网站引用的jquery库中被注入恶意代码</p>
<p>被注入页面的劫持代码多用来进行广告暗刷和电商流量劫持，从发现的数十个劫持JS文件代码的历史变化中，可以看出作者一直在不断尝试测试改进不同的劫持方式。</p>
<p><a class="highslide-image" href="http://image.3001.net/images/20160516/14633998453990.png" target="_blank"><img src="http://image.3001.net/images/20160516/14633998453990.png!small" alt="图片32.png" width="690" data-original="http://image.3001.net/images/20160516/14633998453990.png!small" /></a></p>
<p>[32] 劫持代码进行各大电商广告的暗刷</p>
<p><a class="highslide-image" href="http://image.3001.net/images/20160516/14633998669077.png" target="_blank"><img src="http://image.3001.net/images/20160516/14633998669077.png!small" alt="图片33.png" width="690" data-original="http://image.3001.net/images/20160516/14633998669077.png!small" /></a></p>
<p>[33] 在网页中注入CPS广告，跳转到自己的电商导流平台</p>
<p>我们对劫持者的流量统计后台进行了简单的跟踪，从51la的数据统计来看，劫持流量还是非常惊人的，日均PV在200w左右，在2015年末的高峰期甚至达到800w左右，劫持者的暴利收益不难想象。</p>
<p><a class="highslide-image" href="http://image.3001.net/images/20160517/14634567818855.png" target="_blank"><img src="http://image.3001.net/images/20160517/14634567818855.png!small" alt="图片4.png" width="690" data-original="http://image.3001.net/images/20160517/14634567818855.png!small" /></a></p>
<p>[34] DNS流量劫持者使用的51啦统计后台</p>
<p>最近两年DNS劫持活动非常频繁，恶意DNS数量增长也非常迅速，我们监测到的每年新增恶意DNS服务器就多达上百个。针对路由器的劫持攻击案例也不仅仅发生在国内，从蜜罐系统和小范围漏洞探测结果中，我们也捕获到了多起全球范围内的路由器DNS攻击案例。</p>
<p><a class="highslide-image" href="http://image.3001.net/images/20160517/14634567957032.png" target="_blank"><img src="http://image.3001.net/images/20160517/14634567957032.png!small" alt="图片5.png" width="653" data-original="http://image.3001.net/images/20160517/14634567957032.png!small" /></a></p>
<p>[35] DNS流量劫持者使用的51啦统计后台</p>
<p><a class="highslide-image" href="http://image.3001.net/images/20160516/14633999357861.png" target="_blank"><img src="http://image.3001.net/images/20160516/14633999357861.png!small" alt="图片36.png" width="690" data-original="http://image.3001.net/images/20160516/14633999357861.png!small" /></a></p>
<p>[36] 在国外地区发现的一例路由器CSRF漏洞“全家桶”，被利用的攻击playload多达20多种</p>
<p>下面的案例是2016年初我们的蜜罐系统捕获到一类针对路由器漏洞的扫描攻击，随后我们尝试进行溯源和影响评估，在对某邻国的部分活跃IP段进行小范围的扫描探测后，发现大批量的路由器被暴露在外网，其中存在漏洞的路由器有30%左右被篡改了DNS设置。</p>
<p>抛开劫持广告流量牟利不谈，如果要对一个国家或地区的网络进行大批量的渗透或破坏，以目前路由器的千疮百孔安全现状，无疑可以作为很适合的一个突破口，这并不是危言耸听。</p>
<p>如下图中漏洞路由器首选DNS被设置为劫持服务器IP，备选DNS服务器设为谷歌公共DNS(8.8.8.8)。</p>
<p><a class="highslide-image" href="http://image.3001.net/images/20160516/14633999617111.png" target="_blank"><img src="http://image.3001.net/images/20160516/14633999617111.png!small" alt="图片37.png" width="690" data-original="http://image.3001.net/images/20160516/14633999617111.png!small" /></a></p>
<p>[37] 邻国某网段中大量存在漏洞的路由器被劫持DNS设置</p>
<p><a class="highslide-image" href="http://image.3001.net/images/20160516/14633999878404.png" target="_blank"><img src="http://image.3001.net/images/20160516/14633999878404.png!small" alt="图片38.png" width="690" data-original="http://image.3001.net/images/20160516/14633999878404.png!small" /></a></p>
<p>[38] 各种存在漏洞的路由器被劫持DNS设置</p>
<p><b>4.神秘劫持</b></p>
<p>以一个神秘的劫持案例作为故事的结尾，在工作中曾经陆续遇到过多次神秘样本，仿佛是隐藏在层层网络中的黑暗幽灵，不知道它从哪里来，也不知道它截获的信息最终流向哪里，留给我们的只有迷一般的背影。</p>
<p>这批迷一样的样本已经默默存活了很久，我们捕获到早期变种可以追溯到12年左右。下面我们先把这个迷的开头补充下，这些样本绝大多数来自于某些可能被劫持的网络节点，请静静看图。</p>
<p><a class="highslide-image" href="http://image.3001.net/images/20160516/14634000127134.png" target="_blank"><img src="http://image.3001.net/images/20160516/14634000127134.png!small" alt="图片39.png" width="690" data-original="http://image.3001.net/images/20160516/14634000127134.png!small" /></a></p>
<p>[39] 某软件升级数据包正常状态与异常状态对比</p>
<p><a class="highslide-image" href="http://image.3001.net/images/20160516/14634000324462.png" target="_blank"><img src="http://image.3001.net/images/20160516/14634000324462.png!small" alt="图片40.png" width="690" data-original="http://image.3001.net/images/20160516/14634000324462.png!small" /></a></p>
<p>[40] 某软件升级过程中的抓包数据</p>
<p>我们在15年初的时候捕获到了其中一类样本的新变种，除了迷一样的传播方式，样本本身还有很多非常有意思的技术细节，限于篇幅这里只能放1张内部分享的分析截图，虽然高清但是有码，同样老规矩静静看图。</p>
<p><a class="highslide-image" href="http://image.3001.net/images/20160516/14634000552301.png" target="_blank"><img src="http://image.3001.net/images/20160516/14634000552301.png!small" alt="图片41.png" width="690" data-original="http://image.3001.net/images/20160516/14634000552301.png!small" /></a></p>
<p>[41] 神秘样本技术分析简图</p>
<h2>尾记</h2>
<p>流量圈的故事还有很多，劫持与反劫持的故事在很长时间内还将继续演绎下去。流量是很多互联网企业赖以生存的基础，通过优秀的产品去获得用户和流量是唯一的正途，用户的信任来之不易，且行且珍惜。文章到此暂告一段落，有感兴趣的地方欢迎留言讨论。</p>
<h2>引用</h2>
<p><a href="http://wooyun.org/bugs/wooyun-2010-0168329" target="_blank">http://wooyun.org/bugs/wooyun-2010-0168329</a></p>
<p><b>* 作者：渔村安全（企业账号），转载请注明来自FreeBuf黑客与极客（FreeBuf.COM）</b></p>
	</div><!-- .entry-content -->
	
	</article><!-- #post-## -->

<article id="post-47" class="post-47 post type-post status-publish format-standard hentry category-tech tag-9">
	
	<header class="entry-header">
				<div class="entry-meta">
			<span class="cat-links"><a href="http://www.baojun-liu.com/?cat=3" rel="category">Tech</a></span>
		</div>
		<h1 class="entry-title"><a href="http://www.baojun-liu.com/?p=47" rel="bookmark">漫谈流量劫持</a></h1>
		<div class="entry-meta">
			<span class="entry-date"><a href="http://www.baojun-liu.com/?p=47" rel="bookmark"><time class="entry-date" datetime="2016-06-10T04:35:52+00:00">2016年6月10日</time></a></span> <span class="byline"><span class="author vcard"><a class="url fn n" href="http://www.baojun-liu.com/?author=1" rel="author">linchen</a></span></span>			<span class="comments-link"><a href="http://www.baojun-liu.com/?p=47#respond">发表回复</a></span>
					</div><!-- .entry-meta -->
	</header><!-- .entry-header -->

		<div class="entry-content">
		<p>流量劫持不仅仅会严重影响用户体验，而且会给用户终端系统带来严重的安全隐患，破坏互联网的公平竞争。在六家互联网公司联名发表声明之后，我们对这一现象进行了持续的跟踪。<br />
目前国内进行流量劫持的现象非常普遍。很多人从运营商体制内跳槽出去，然后用极低的价格竞标项目，之后将广告注入的设备串联到通信链路。他们和广告联盟形成了一条完整的利益链条。</p>
<p><strong>流量劫持可分为两种： DNS劫持与链路劫持（HTTP劫持）。</strong></p>
<p>第一类  <span style="color: #ff0000;"><strong>DNS劫持</strong></span>：<br />
攻击者控制DNS服务器，控制域名的解析结果。<br />
<strong>DNS劫持可以做的事情非常多，包括重定向网站，向页面插入广告，将不存在的域名重定向至运营商的广告页。</strong><br />
DNS劫持现象更偏向与持续性出现，但是最近在公网上这种现象有减少的趋势，这可能和在公网上直接进行DNS劫持的风险非常大。</p>
<p><strong><span style="color: #ff0000;">Case分析：江苏移动自建代理服务器</span></strong><br />
我们发现江苏移动若干个Open DNS（122.94.117.*）会将m.hao123.com的解析结果指向一片同一网段的地址（183.207.229.201&amp;203&amp;204&amp;205）<br />
目前这个现象已经消失。<br />
网络边缘测量时，这些IP对于我们的HTTP请求会返回 403 Forbidden。</p>
<p><img class="wp-image-53 aligncenter" src="http://www.baojun-liu.com/wp-content/uploads/2016/06/896B.tm_-300x141.png" alt="896B.tm" width="403" height="189" srcset="http://www.baojun-liu.com/wp-content/uploads/2016/06/896B.tm_-300x141.png 300w, http://www.baojun-liu.com/wp-content/uploads/2016/06/896B.tm_.png 478w" sizes="(max-width: 403px) 100vw, 403px" /></p>
<p>不过 南京当地的用户可以正常的访问该网页。</p>
<p><img class=" wp-image-55 aligncenter" src="http://www.baojun-liu.com/wp-content/uploads/2016/06/Picture2-300x114.png" alt="Picture2" width="350" height="133" srcset="http://www.baojun-liu.com/wp-content/uploads/2016/06/Picture2-300x114.png 300w, http://www.baojun-liu.com/wp-content/uploads/2016/06/Picture2.png 556w" sizes="(max-width: 350px) 100vw, 350px" /></p>
<p><img class=" wp-image-54 aligncenter" src="http://www.baojun-liu.com/wp-content/uploads/2016/06/Picture1-300x256.png" alt="Picture1" width="329" height="281" srcset="http://www.baojun-liu.com/wp-content/uploads/2016/06/Picture1-300x256.png 300w, http://www.baojun-liu.com/wp-content/uploads/2016/06/Picture1.png 377w" sizes="(max-width: 329px) 100vw, 329px" /></p>
<p>这一点说明，这些Cache/Proxy服务器很可能设置了ACL，这一点和CDN节点是非常不同的。CDN不会因为请求是外地发来的而不予响应。</p>
<p>最后，这些Proxy Server的引入伴随了非常繁杂的安全性问题，包括开启大量敏感端口等。</p>
<p>经过了解，最终我们得知，移动这么做也是迫于无奈，具体原因此处不能细表。</p>
<p>第二类 <span style="color: #ff0000;"><strong> 链路劫持</strong></span>：<br />
HTTP劫持也叫链路劫持，最常见的就是针对各大流量网的加小尾巴行为。具体技术分析请参见相关资料。</p>
<p>活捉一枚劫持现象，请留意地址栏。下图为恶意劫持。</p>
<p><img class="alignnone  wp-image-60" src="http://www.baojun-liu.com/wp-content/uploads/2016/06/81EF.tm_-300x90.png" alt="81EF.tm" width="470" height="141" srcset="http://www.baojun-liu.com/wp-content/uploads/2016/06/81EF.tm_-300x90.png 300w, http://www.baojun-liu.com/wp-content/uploads/2016/06/81EF.tm_-768x231.png 768w, http://www.baojun-liu.com/wp-content/uploads/2016/06/81EF.tm_.png 983w" sizes="(max-width: 470px) 100vw, 470px" /></p>
<p>下图为正常的页面，为https页面。</p>
<p><img class="alignnone size-full wp-image-61" src="http://www.baojun-liu.com/wp-content/uploads/2016/06/4793.tm_.png" alt="4793.tm" width="977" height="272" /></p>
<p>不过要证明HTTP劫持是运营商所为，就要排除host 恶意软件 浏览器插件等因素，非常麻烦。此类劫持都牵扯到一些串联设备，只不过在具体实现上稍有不同而已。<br />
HTTP劫持中很多攻击者会将平台搭建在云服务器上。</p>
<p><span style="color: #ff0000;"><strong>设备劫持：</strong></span><br />
很多时候，我们更多的把经历放在运营商上面，但是殊不知很多厂商的设备也会做劫持。小米路由器劫持404页面早就不是什么新闻了，最近他们在劫持银行的网页并注入广告。  此外，小米打造的生态也为它们进行劫持提供了得天独厚的优势。下图为红米手机使用自带浏览器下载APP时，页面底部出现广告（当前为HTTPS页面）。</p>
<p><img class=" wp-image-56 aligncenter" src="http://www.baojun-liu.com/wp-content/uploads/2016/06/495262914529240470-169x300.jpg" alt="495262914529240470" width="255" height="452" srcset="http://www.baojun-liu.com/wp-content/uploads/2016/06/495262914529240470-169x300.jpg 169w, http://www.baojun-liu.com/wp-content/uploads/2016/06/495262914529240470-576x1024.jpg 576w, http://www.baojun-liu.com/wp-content/uploads/2016/06/495262914529240470.jpg 720w" sizes="(max-width: 255px) 100vw, 255px" /></p>
<p>相关资料：<br />
<a href="http://weibo.com/ttarticle/p/show?id=2309403947881995354308&amp;sudaref=www.baidu.com">http://weibo.com/ttarticle/p/show?id=2309403947881995354308&amp;sudaref=www.baidu.com</a><br />
今天你被运营商上了吗？ 用户下载链接被替换。<br />
最终查明，该广告分发平台并不是电信直属部门。<br />
<a href="http://bbs.kafan.cn/thread-1825061-1-1.html">http://bbs.kafan.cn/thread-1825061-1-1.html</a><br />
关于DNS HTTP劫持的一些事<br />
<a href="http://www.jianshu.com/p/eff9553c8b64">http://www.jianshu.com/p/eff9553c8b64</a><br />
关于互联网流量劫持分析<br />
<a href="https://security.tencent.com/index.php/blog/msg/10">https://security.tencent.com/index.php/blog/msg/10</a><br />
链路劫持<br />
<a href="http://bobao.360.cn/news/detail/1793.html">http://bobao.360.cn/news/detail/1793.html</a><br />
关于114DNS内幕<br />
<a href="https://www.zhihu.com/question/44264622?f3fb8ead20=906aa1655f493ba09f51e8852c5d0d41">https://www.zhihu.com/question/44264622?f3fb8ead20=906aa1655f493ba09f51e8852c5d0d41</a><br />
小米路由器又开始劫持</p>
	</div><!-- .entry-content -->
	
	<footer class="entry-meta"><span class="tag-links"><a href="http://www.baojun-liu.com/?tag=%e6%b5%81%e9%87%8f%e5%8a%ab%e6%8c%81" rel="tag">流量劫持</a></span></footer></article><!-- #post-## -->

<article id="post-35" class="post-35 post type-post status-publish format-image hentry category-live-love tag-8 post_format-post-format-image">
	
	<header class="entry-header">
				<div class="entry-meta">
			<span class="cat-links"><a href="http://www.baojun-liu.com/?cat=2" rel="category">Live &amp; Love</a></span>
		</div><!-- .entry-meta -->
		<h1 class="entry-title"><a href="http://www.baojun-liu.com/?p=35" rel="bookmark">园子里</a></h1>
		<div class="entry-meta">
			<span class="post-format">
				<a class="entry-format" href="http://www.baojun-liu.com/?post_format=image">图像</a>
			</span>

			<span class="entry-date"><a href="http://www.baojun-liu.com/?p=35" rel="bookmark"><time class="entry-date" datetime="2016-06-10T03:13:15+00:00">2016年6月10日</time></a></span> <span class="byline"><span class="author vcard"><a class="url fn n" href="http://www.baojun-liu.com/?author=1" rel="author">linchen</a></span></span>
						<span class="comments-link"><a href="http://www.baojun-liu.com/?p=35#respond">发表回复</a></span>
			
					</div><!-- .entry-meta -->
	</header><!-- .entry-header -->

	<div class="entry-content">
		<p>园子里的生活，很安静，让人的心很快的静下来，这种北方的美，是我在古都未曾领略到的。</p>
<p>帝都难得有好天气，但是一旦有，总让人心旷神怡。大师兄说，刚出国那会，每天早上第一句话就是，今天天气那么好啊。过了两个月，再也不说了，哈哈哈。被帝都训练出来的孩子，就是那么容易被满足。</p>
<p><img class="wp-image-39 aligncenter" src="http://www.baojun-liu.com/wp-content/uploads/2016/06/456994479113497704-300x225.jpg" alt="456994479113497704" width="505" height="378" srcset="http://www.baojun-liu.com/wp-content/uploads/2016/06/456994479113497704-300x225.jpg 300w, http://www.baojun-liu.com/wp-content/uploads/2016/06/456994479113497704-768x576.jpg 768w, http://www.baojun-liu.com/wp-content/uploads/2016/06/456994479113497704-1024x768.jpg 1024w, http://www.baojun-liu.com/wp-content/uploads/2016/06/456994479113497704.jpg 1280w" sizes="(max-width: 505px) 100vw, 505px" /></p>
<p>北方的秋也不是浪的虚名，那么美，美的不可描述。</p>
<p><img class="wp-image-41 aligncenter" src="http://www.baojun-liu.com/wp-content/uploads/2016/06/617548351438576245-300x225.jpg" alt="617548351438576245" width="479" height="359" srcset="http://www.baojun-liu.com/wp-content/uploads/2016/06/617548351438576245-300x225.jpg 300w, http://www.baojun-liu.com/wp-content/uploads/2016/06/617548351438576245-768x576.jpg 768w, http://www.baojun-liu.com/wp-content/uploads/2016/06/617548351438576245-1024x768.jpg 1024w, http://www.baojun-liu.com/wp-content/uploads/2016/06/617548351438576245.jpg 1280w" sizes="(max-width: 479px) 100vw, 479px" /></p>
<p>对，还有冬天。（照片源自朋友圈）</p>
<p><img class="wp-image-37 aligncenter" src="http://www.baojun-liu.com/wp-content/uploads/2016/06/261037369174603079-300x199.jpg" alt="261037369174603079" width="477" height="317" srcset="http://www.baojun-liu.com/wp-content/uploads/2016/06/261037369174603079-300x199.jpg 300w, http://www.baojun-liu.com/wp-content/uploads/2016/06/261037369174603079-768x510.jpg 768w, http://www.baojun-liu.com/wp-content/uploads/2016/06/261037369174603079-1024x680.jpg 1024w, http://www.baojun-liu.com/wp-content/uploads/2016/06/261037369174603079.jpg 1280w" sizes="(max-width: 477px) 100vw, 477px" /></p>
<p>16年春天，喜欢在网球场打球，旁边不知道是什么树，但那种香味确实沁人心脾。</p>
<p><img class="alignnone wp-image-36" src="http://www.baojun-liu.com/wp-content/uploads/2016/06/72184479800115797-222x300.jpg" alt="72184479800115797" width="233" height="315" srcset="http://www.baojun-liu.com/wp-content/uploads/2016/06/72184479800115797-222x300.jpg 222w, http://www.baojun-liu.com/wp-content/uploads/2016/06/72184479800115797-768x1036.jpg 768w, http://www.baojun-liu.com/wp-content/uploads/2016/06/72184479800115797-759x1024.jpg 759w, http://www.baojun-liu.com/wp-content/uploads/2016/06/72184479800115797.jpg 949w" sizes="(max-width: 233px) 100vw, 233px" /> <img class="alignnone wp-image-40" src="http://www.baojun-liu.com/wp-content/uploads/2016/06/569583742841798714-222x300.jpg" alt="569583742841798714" width="232" height="314" srcset="http://www.baojun-liu.com/wp-content/uploads/2016/06/569583742841798714-222x300.jpg 222w, http://www.baojun-liu.com/wp-content/uploads/2016/06/569583742841798714-768x1036.jpg 768w, http://www.baojun-liu.com/wp-content/uploads/2016/06/569583742841798714-759x1024.jpg 759w, http://www.baojun-liu.com/wp-content/uploads/2016/06/569583742841798714.jpg 949w" sizes="(max-width: 232px) 100vw, 232px" /></p>
<p>当然，还有勤奋的少年们，凌晨两点的学堂路。</p>
<p><img class="wp-image-38 aligncenter" src="http://www.baojun-liu.com/wp-content/uploads/2016/06/441729707782831757-300x225.jpg" alt="441729707782831757" width="485" height="364" srcset="http://www.baojun-liu.com/wp-content/uploads/2016/06/441729707782831757-300x225.jpg 300w, http://www.baojun-liu.com/wp-content/uploads/2016/06/441729707782831757-768x576.jpg 768w, http://www.baojun-liu.com/wp-content/uploads/2016/06/441729707782831757-1024x768.jpg 1024w, http://www.baojun-liu.com/wp-content/uploads/2016/06/441729707782831757.jpg 1280w" sizes="(max-width: 485px) 100vw, 485px" /></p>
	</div><!-- .entry-content -->

	<footer class="entry-meta"><span class="tag-links"><a href="http://www.baojun-liu.com/?tag=%e5%9b%ad%e5%ad%90" rel="tag">园子</a></span></footer></article><!-- #post-## -->

<article id="post-21" class="post-21 post type-post status-publish format-image hentry category-live-love tag-7 post_format-post-format-image">
	
	<header class="entry-header">
				<div class="entry-meta">
			<span class="cat-links"><a href="http://www.baojun-liu.com/?cat=2" rel="category">Live &amp; Love</a></span>
		</div><!-- .entry-meta -->
		<h1 class="entry-title"><a href="http://www.baojun-liu.com/?p=21" rel="bookmark">吃货的我</a></h1>
		<div class="entry-meta">
			<span class="post-format">
				<a class="entry-format" href="http://www.baojun-liu.com/?post_format=image">图像</a>
			</span>

			<span class="entry-date"><a href="http://www.baojun-liu.com/?p=21" rel="bookmark"><time class="entry-date" datetime="2016-06-10T02:53:28+00:00">2016年6月10日</time></a></span> <span class="byline"><span class="author vcard"><a class="url fn n" href="http://www.baojun-liu.com/?author=1" rel="author">linchen</a></span></span>
						<span class="comments-link"><a href="http://www.baojun-liu.com/?p=21#respond">发表回复</a></span>
			
					</div><!-- .entry-meta -->
	</header><!-- .entry-header -->

	<div class="entry-content">
		<p>吃货一枚，不喜摆拍。<br />
存有少量照片，一部分为纪念，一部分纯属Mark一下。<br />
其实我对吃没什么讲究，只是觉得很有意思，很有意思，如是而已。</p>
<p>周末，四人小聚，均为高中好友。</p>
<p><img class="wp-image-24 aligncenter" src="http://www.baojun-liu.com/wp-content/uploads/2016/06/862176782761698116-300x225.jpg" alt="862176782761698116" width="445" height="334" srcset="http://www.baojun-liu.com/wp-content/uploads/2016/06/862176782761698116-300x225.jpg 300w, http://www.baojun-liu.com/wp-content/uploads/2016/06/862176782761698116-768x576.jpg 768w, http://www.baojun-liu.com/wp-content/uploads/2016/06/862176782761698116-1024x768.jpg 1024w, http://www.baojun-liu.com/wp-content/uploads/2016/06/862176782761698116.jpg 1280w" sizes="(max-width: 445px) 100vw, 445px" /> <img class="wp-image-27 aligncenter" src="http://www.baojun-liu.com/wp-content/uploads/2016/06/291124374446975735-300x225.jpg" alt="291124374446975735" width="442" height="331" srcset="http://www.baojun-liu.com/wp-content/uploads/2016/06/291124374446975735-300x225.jpg 300w, http://www.baojun-liu.com/wp-content/uploads/2016/06/291124374446975735-768x576.jpg 768w, http://www.baojun-liu.com/wp-content/uploads/2016/06/291124374446975735-1024x768.jpg 1024w, http://www.baojun-liu.com/wp-content/uploads/2016/06/291124374446975735.jpg 1280w" sizes="(max-width: 442px) 100vw, 442px" /></p>
<p>难免也有点小情怀。</p>
<p><img class="alignnone size-medium wp-image-25" src="http://www.baojun-liu.com/wp-content/uploads/2016/06/272161041983194488-222x300.jpg" alt="272161041983194488" width="222" height="300" srcset="http://www.baojun-liu.com/wp-content/uploads/2016/06/272161041983194488-222x300.jpg 222w, http://www.baojun-liu.com/wp-content/uploads/2016/06/272161041983194488.jpg 759w" sizes="(max-width: 222px) 100vw, 222px" /> <img class="alignnone size-medium wp-image-32" src="http://www.baojun-liu.com/wp-content/uploads/2016/06/574946249779787240-222x300.jpg" alt="574946249779787240" width="222" height="300" srcset="http://www.baojun-liu.com/wp-content/uploads/2016/06/574946249779787240-222x300.jpg 222w, http://www.baojun-liu.com/wp-content/uploads/2016/06/574946249779787240-768x1036.jpg 768w, http://www.baojun-liu.com/wp-content/uploads/2016/06/574946249779787240-759x1024.jpg 759w, http://www.baojun-liu.com/wp-content/uploads/2016/06/574946249779787240.jpg 949w" sizes="(max-width: 222px) 100vw, 222px" /></p>
<p>16年春特别喜欢的果木烤鸭，虽然看不出它曾经是烤鸭。</p>
<p><img class="wp-image-28 aligncenter" src="http://www.baojun-liu.com/wp-content/uploads/2016/06/342207469810157008-300x225.jpg" alt="342207469810157008" width="455" height="341" srcset="http://www.baojun-liu.com/wp-content/uploads/2016/06/342207469810157008-300x225.jpg 300w, http://www.baojun-liu.com/wp-content/uploads/2016/06/342207469810157008-768x576.jpg 768w, http://www.baojun-liu.com/wp-content/uploads/2016/06/342207469810157008-1024x768.jpg 1024w, http://www.baojun-liu.com/wp-content/uploads/2016/06/342207469810157008.jpg 1280w" sizes="(max-width: 455px) 100vw, 455px" /></p>
<p>好吧，为了让你看出来它曾经是，我又去了几次。</p>
<p><img class="wp-image-26 aligncenter" src="http://www.baojun-liu.com/wp-content/uploads/2016/06/275625574125566615-300x225.jpg" alt="275625574125566615" width="461" height="346" srcset="http://www.baojun-liu.com/wp-content/uploads/2016/06/275625574125566615-300x225.jpg 300w, http://www.baojun-liu.com/wp-content/uploads/2016/06/275625574125566615-768x576.jpg 768w, http://www.baojun-liu.com/wp-content/uploads/2016/06/275625574125566615-1024x768.jpg 1024w, http://www.baojun-liu.com/wp-content/uploads/2016/06/275625574125566615.jpg 1280w" sizes="(max-width: 461px) 100vw, 461px" /></p>
<p>最后，说真的，我特别想念家乡的味道，真是难舍难分。</p>
<p><img class="wp-image-33 aligncenter" src="http://www.baojun-liu.com/wp-content/uploads/2016/06/834559147718469594-300x225.jpg" alt="834559147718469594" width="470" height="352" srcset="http://www.baojun-liu.com/wp-content/uploads/2016/06/834559147718469594-300x225.jpg 300w, http://www.baojun-liu.com/wp-content/uploads/2016/06/834559147718469594-768x576.jpg 768w, http://www.baojun-liu.com/wp-content/uploads/2016/06/834559147718469594-1024x768.jpg 1024w, http://www.baojun-liu.com/wp-content/uploads/2016/06/834559147718469594.jpg 1280w" sizes="(max-width: 470px) 100vw, 470px" /></p>
<p>&nbsp;</p>
<p>吃货快乐！  Forever ！</p>
<p>&nbsp;</p>
	</div><!-- .entry-content -->

	<footer class="entry-meta"><span class="tag-links"><a href="http://www.baojun-liu.com/?tag=%e5%90%83" rel="tag">吃</a></span></footer></article><!-- #post-## -->

<article id="post-16" class="post-16 post type-post status-publish format-standard hentry category-uncategorized">
	
	<header class="entry-header">
				<div class="entry-meta">
			<span class="cat-links"><a href="http://www.baojun-liu.com/?cat=1" rel="category">Misc</a></span>
		</div>
		<h1 class="entry-title"><a href="http://www.baojun-liu.com/?p=16" rel="bookmark">签到哈哈</a></h1>
		<div class="entry-meta">
			<span class="entry-date"><a href="http://www.baojun-liu.com/?p=16" rel="bookmark"><time class="entry-date" datetime="2016-06-09T19:16:26+00:00">2016年6月9日</time></a></span> <span class="byline"><span class="author vcard"><a class="url fn n" href="http://www.baojun-liu.com/?author=2" rel="author">xiaohuizi6666</a></span></span>			<span class="comments-link"><a href="http://www.baojun-liu.com/?p=16#respond">发表回复</a></span>
					</div><!-- .entry-meta -->
	</header><!-- .entry-header -->

		<div class="entry-content">
		<p>你是不是傻签到也点进来看切╮（╯＿╰）╭</p>
	</div><!-- .entry-content -->
	
	</article><!-- #post-## -->

<article id="post-1" class="post-1 post type-post status-publish format-standard hentry category-uncategorized">
	
	<header class="entry-header">
				<div class="entry-meta">
			<span class="cat-links"><a href="http://www.baojun-liu.com/?cat=1" rel="category">Misc</a></span>
		</div>
		<h1 class="entry-title"><a href="http://www.baojun-liu.com/?p=1" rel="bookmark">搬家喽</a></h1>
		<div class="entry-meta">
			<span class="entry-date"><a href="http://www.baojun-liu.com/?p=1" rel="bookmark"><time class="entry-date" datetime="2016-06-09T05:46:42+00:00">2016年6月9日</time></a></span> <span class="byline"><span class="author vcard"><a class="url fn n" href="http://www.baojun-liu.com/?author=1" rel="author">linchen</a></span></span>			<span class="comments-link"><a href="http://www.baojun-liu.com/?p=1#respond">发表回复</a></span>
					</div><!-- .entry-meta -->
	</header><!-- .entry-header -->

		<div class="entry-content">
		<p>记于16年6月8日，搬家喽！</p>
<p>Waiting for you ！</p>
<p>&nbsp;</p>
	</div><!-- .entry-content -->
	
	</article><!-- #post-## -->

		</div><!-- #content -->
	</div><!-- #primary -->
	</div><!-- #main-content -->

<div id="secondary">
		<h2 class="site-description">一只工科Ph.D的狗窝</h2>
	
	
		<div id="primary-sidebar" class="primary-sidebar widget-area" role="complementary">
		<aside id="search-2" class="widget widget_search"><form role="search" method="get" class="search-form" action="http://www.baojun-liu.com/">
				<label>
					<span class="screen-reader-text">搜索：</span>
					<input type="search" class="search-field" placeholder="搜索&hellip;" value="" name="s" />
				</label>
				<input type="submit" class="search-submit" value="搜索" />
			</form></aside>		<aside id="recent-posts-2" class="widget widget_recent_entries">		<h1 class="widget-title">近期文章</h1>		<ul>
					<li>
				<a href="http://www.baojun-liu.com/?p=78">书单</a>
						</li>
					<li>
				<a href="http://www.baojun-liu.com/?p=70">如何从CDN/Cache/Proxy Server上稳定的获取页面</a>
						</li>
					<li>
				<a href="http://www.baojun-liu.com/?p=68">忆高考</a>
						</li>
					<li>
				<a href="http://www.baojun-liu.com/?p=65">流量劫持 &#8211; 转载自渔村安全</a>
						</li>
					<li>
				<a href="http://www.baojun-liu.com/?p=47">漫谈流量劫持</a>
						</li>
				</ul>
		</aside>		<aside id="archives-2" class="widget widget_archive"><h1 class="widget-title">文章归档</h1>		<label class="screen-reader-text" for="archives-dropdown-2">文章归档</label>
		<select id="archives-dropdown-2" name="archive-dropdown" onchange='document.location.href=this.options[this.selectedIndex].value;'>
			
			<option value="">选择月份</option>
				<option value='http://www.baojun-liu.com/?m=201606'> 2016年六月 </option>

		</select>
		</aside><aside id="categories-2" class="widget widget_categories"><h1 class="widget-title">分类目录</h1>		<ul>
	<li class="cat-item cat-item-2"><a href="http://www.baojun-liu.com/?cat=2" >Live &amp; Love</a>
</li>
	<li class="cat-item cat-item-1"><a href="http://www.baojun-liu.com/?cat=1" >Misc</a>
</li>
	<li class="cat-item cat-item-3"><a href="http://www.baojun-liu.com/?cat=3" >Tech</a>
</li>
		</ul>
</aside><aside id="meta-2" class="widget widget_meta"><h1 class="widget-title">功能</h1>			<ul>
						<li><a href="http://www.baojun-liu.com/wp-login.php">登录</a></li>
			<li><a href="http://www.baojun-liu.com/?feed=rss2">文章<abbr title="Really Simple Syndication">RSS</abbr></a></li>
			<li><a href="http://www.baojun-liu.com/?feed=comments-rss2">评论<abbr title="Really Simple Syndication">RSS</abbr></a></li>
			<li><a href="https://cn.wordpress.org/" title="基于WordPress，一个优美、先进的个人信息发布平台。">WordPress.org</a></li>			</ul>
			</aside><aside id="tag_cloud-3" class="widget widget_tag_cloud"><h1 class="widget-title">标签</h1><div class="tagcloud"><a href='http://www.baojun-liu.com/?tag=%e5%90%83' class='tag-link-7 tag-link-position-1' title='1个话题' style='font-size: 8pt;'>吃</a>
<a href='http://www.baojun-liu.com/?tag=%e5%9b%ad%e5%ad%90' class='tag-link-8 tag-link-position-2' title='1个话题' style='font-size: 8pt;'>园子</a>
<a href='http://www.baojun-liu.com/?tag=%e6%b5%81%e9%87%8f%e5%8a%ab%e6%8c%81' class='tag-link-9 tag-link-position-3' title='1个话题' style='font-size: 8pt;'>流量劫持</a></div>
</aside>	</div><!-- #primary-sidebar -->
	</div><!-- #secondary -->

		</div><!-- #main -->

		<footer id="colophon" class="site-footer" role="contentinfo">

			
			<div class="site-info">
								<a href="https://cn.wordpress.org/">自豪地采用WordPress</a>
			</div><!-- .site-info -->
		</footer><!-- #colophon -->
	</div><!-- #page -->

	<script type='text/javascript'>
/* <![CDATA[ */
var featuredSliderDefaults = {"prevText":"\u4e0a\u4e00","nextText":"\u4e0b\u4e00"};
/* ]]> */
</script>
<script type='text/javascript' src='http://www.baojun-liu.com/wp-content/themes/twentyfourteen/js/slider.js?ver=20131205'></script>
<script type='text/javascript' src='http://www.baojun-liu.com/wp-content/themes/twentyfourteen/js/functions.js?ver=20150315'></script>
<script type='text/javascript' src='http://www.baojun-liu.com/wp-includes/js/wp-embed.min.js?ver=4.5.2'></script>
</body>
</html>