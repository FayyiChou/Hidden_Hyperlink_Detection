<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head>
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>登录 - 完美游戏平台</title>
<!-- meta -->

<meta http-equiv="Content-Type" content="text/html;charset=utf-8;">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="apple-mobile-web-app-capable" content="yes">
<!-- css links -->

<link rel="shortcut icon" type="image/x-icon" href="https://csafestatic.wanmei.com/passport/images/favicon.ico">
<link rel="Bookmark" href="https://csafestatic.wanmei.com/passport/images/favicon.ico">

<link rel="stylesheet" type="text/css" href="https://csafestatic.wanmei.com/passport/css/login.css">
<script type="text/javascript" src="https://csafestatic.wanmei.com/public/js/arc_client.js" async=""></script><script type="text/javascript" src="https://csafestatic.wanmei.com/public/js/arc_stat.js" async=""></script><script type="text/javascript" src="https://csafestatic.wanmei.com/public/js/myaddjs.js" async=""></script><script type="text/javascript" src="http://www.wanmei.com/wa.js" async=""></script></head>
<body style="">
	<script src="https://csafestatic.wanmei.com/public/js/mytopjs.js" type="text/javascript"></script><style>body,div,p{margin:0;padding:0;}.arcpublic{font-family:"微软雅黑";}.arcpublic div:after,.arcpublic p:after,div.arcpublic:after{ content:""; display:block;  height:0; overflow:hidden; clear:both;  }.arcpublic div,.arcpublic p,.arcpublic{ zoom:1;}#arcpublic-top{background:#242424; border-bottom:2px solid #ff9700;}#arcpublic-tophead{width:1100px; margin:0 auto; height:90px;}.arcpublic-logo{float:left; width:215px; padding:17px 0 0 0;}.arcpublic-nav{float:left; width:555px; height:88px; overflow:hidden;}.arcpublic-nav a{float:left; width:80px; height:80px; line-height:80px; background:url(https://csafestatic.wanmei.com/public/images/nav_line.jpg) no-repeat right center; font-size:18px; color:#787878; text-align:center;font-family:"Microsoft YaHei";}.arcpublic-nav a:hover{color:#FFF; text-decoration:none;}.arcpublic-nav a.arcpublic-bgnone{background:none;}.arcpublic-nav_line{height:36px; position:relative; width:555px; clear:both;}.arcpublic-nav_bux{width:80px; height:6px; background:#ff9700; position:absolute; left:0; top:0; overflow:hidden; line-height:0; font-size:0;}.arcpublic-toplr{float:right; width:327px; height:88px;}.arcpublic-top_down{padding:0 0 0 0px; height:60px; position:relative; overflow:hidden;margin-left:90px;}.arcpublic-down_btn{background:url(https://csafestatic.wanmei.com/public/images/down_bg.jpg) no-repeat 0 0; width:237px; height:32px; line-height:32px; color:#FFF; font-size:16px; display:block; text-align:center;}.arcpublic-down_btn:hover{text-decoration:none;}.arcpublic-down_bg{ position:absolute;top:0px;left:0px; z-index:99;cursor:pointer;}.arcpublic-guang{ position:absolute;top:0px;left:-33px;}.arcpublic-logo a{ background:url(https://csafestatic.wanmei.com/public/images/toplogo_01.png) no-repeat; width:221px; height:70px; display:block;}.arcpublic-top_down a{ background:url(https://csafestatic.wanmei.com/public/images/toplogo1.png) no-repeat; width:219px; height:32px; }.arcpublic-login_iframe{width:380px;height:361px; position:absolute;top:32px;left:-53px;z-index:999;border:1px solid #dbd8d8;display:none;}.arcpublic-reg_iframe{width:380px;height:609px; position:absolute;top:32px;left:-53px;z-index:999;border:1px solid #dbd8d8;display:none;}.arcpublic-ral{ position:absolute;top:22px;left:210px;display:none; z-index:999;}.arcpublic-zq{width:868px;float:right;line-height:20px;}.arcpublic_down_btn{line-height: 32px;color: #FFF;font-size: 16px;display: block;text-align: center;}</style><div id="arcpublic-top" class="arcpublic"><div id="arcpublic-tophead"><div class="arcpublic-logo"><a href="http://www.arcgames.cn" target="_blank"></a></div> <div class="arcpublic-nav"> </div><div class="arcpublic-toplr"><div class="arcpublic-top_down" id="arcpublic-downloadA"> </div></div> </div></div>

	
	<input type="hidden" name="location" value="http://cpass.wanmei.com">
	<div class="midbody">
		<div class="newpmainbody newplop">
    		<form class="form1" id="loginForm">
				<div class="newplogin">
					<div class="newploginc ">
						<h4 class="clearfix">完美通行证<a class="right" href="https://cpass.wanmei.com/regPage?location=http://cpass.wanmei.com" target="_blank">立即注册 &gt;</a></h4>
						<p id="loginSysMsg" style="display: none;" class="newperrormes allmsg"></p>
						<p class="newpinputs">
							<em></em><input name="username" placeholder="邮箱/用户名/手机"><span class="clearb"></span>
						</p>
						<p class="newpinputs pwdinput">
							<em></em><input type="password" name="password" placeholder="密码"><span class="clearb"></span>
						</p>
						<p class="newpcheckbox clearfix">
							<input class="left" type="checkbox" name="autoLogin" value="1"><span class="left" style="margin-right: 15px;">自动登录</span>
							<input class="left" type="checkbox" name="usbKey" value="1"><span class="left">神盾登录</span>
							<a class="right" href="https://cpass.wanmei.com/forgetPwd" target="_blank">忘记密码？</a>
						</p>
						<p class="newpimgchangebtn clearfix" style="display: none; ">
	    					<input type="hidden" name="captchaKey">
							<input class="left" name="captcha" placeholder="验证码" style="margin-right: 15px;">
							<img class="left" style="cursor: pointer;" id="captchaImg" alt="验证码">
							<span id="captchaChange" class="left">看不清？<em style="color: #ff9700; cursor: pointer;">换一张</em></span>
						</p>
						<p class="newsubbtn">
							<input id="loginSub" value="登  录" type="submit" class="right">
						</p>
					</div>
				</div>
			</form>
	       	<form class="form2" id="phoneForm" style="display: none;">
	            <div class="loginbox2 ">
	              	  <h4>请输入您手机令牌上的动态密码：</h4>
	                  <div class="dynaticnum">
	                  	  <span class="left">动态数字：</span>
	                      <input class="left longinput" name="phoneToken">
	                  </div>
	                  <p id="ptMsg" class="errorline allmsg" style="display: none;"></p>
	                  <p class="newsubbtn">
             		  	  <input id="phoneSub" value="验证手机令牌" type="submit" class="right">
	                  </p>
	            </div>
	        </form>
       		<form class="form3" id="matrixForm" style="display: none;">
				<div class="loginbox2">
	              	<h4>请输入密保卡上对应坐标的数字：</h4>
	                  <div class="dynaticnum">
	                  	  <span class="left">动态位置：</span>
                          <em class="left coors">??</em>
                          <span class="line">-</span>
                          <em class="left coors">??</em>
                          <span class="line">-</span>
                          <em class="left coors">??</em>
	                  </div>
	                  <div class="dynaticnum">
	                  	  <span class="left">动态位置：</span>
	                      <input class="left" name="code1">
	                      <span class="line">-</span>
	                      <input class="left" name="code2">
	                      <span class="line">-</span>
	                      <input class="left" name="code3">
	                  </div>
	                  <p id="mtMsg" class="errorline allmsg" style="display: none;"></p>
	                  <p class="newsubbtn">
             			  <input id="matrixSub" value="验证密保卡" type="submit" class="right">	
             		  </p>
	              </div>
	         </form>
		</div>
	</div>
	
	<script src="https://csafestatic.wanmei.com/public/js/mybottomjs.js" type="text/javascript"></script><style>#arcpublic-footer{margin:0;padding:0;font-family:"微软雅黑";} #arcpublic-footer a {text-decoration:none;cursor:pointer;color:#b2b2b2;}#arcpublic-footer a:hover {text-decoration:underline;outline:none;}.arcpublic-left{float:left;}#arcpublic-footer{background:#242424;width:100%;position: relative;}.arcpublic-footbox{width:1100px; margin:0 auto; padding:35px 0 53px 0; line-height:18px;z-index: 100;}.arcpublic-footbox,.arcpublic-footbox a{color:#c5c3c3;}.arcpublic-footbox a:hover{color:#FFF;}.arcpublic-footbox p{ font-size:12px; padding-left:35px; color:#999999;}.arcpublic-footbox p.arcpublic-topp{ color:#e9e9e9; margin-bottom:20px;}.arcpublic-footbox em{padding:0 10px;}.arcpublic-btnlogo span{ background:url(https://csafestatic.wanmei.com/public/images/toplogo_01.png) no-repeat; width:221px; height:70px; display:block; margin-top:35px;}.arcpublic-myleft{ width:875px; }</style><div id="arcpublic-footer" class="arcpublic" "=""><div class="arcpublic-footbox"><div class="arcpublic-left arcpublic-btnlogo"><span></span></div><div class="arcpublic-left arcpublic-myleft"><p class="arcpublic-topp"><a href="http://www.wanmei.com/enterprise/company.htm" target="_blank">公司介绍</a><em>|</em><a href="http://www.wanmei.com/enterprise/developmentteam.htm" target="_blank">开发团队</a><em>|</em><a href="http://hr.wanmei.com/" target="_blank">招聘信息</a><em>|</em><a href="http://www.wanmei.com/enterprise/aboutme.htm" target="_blank">联系我们</a><em>|</em><a href="http://www.wanmei.com/enterprise/legal.htm" target="_blank">法律声明</a><em>|</em><a href="http://cs.wanmei.com/" target="_blank">客服中心</a></p> <p>京ICP证：050016号《网络文化经营许可证》编号：京网文[2011]0782-287号 <a href="http://www.wanmei.com/permit/audio.htm" target="_blank">《网络视听许可证》编号：0110587</a> 京公网安备110105019888号</p><p>完美世界（北京）网络技术有限公司 版权所有</p><p>Copyright © 2004-2015 Perfect World Co.,Ltd.All rights reserved.</p></div></div></div>

	
   
	
	
		<embed height="0" width="0" id="pluginobj2" type="application/pwrd-usbkey">
	
	
	<!-- js scripts -->
	
<script type="text/javascript" src="https://csafestatic.wanmei.com/passport/js/jquery-1.10.2.min.js"></script>
<script type="text/javascript" src="https://csafestatic.wanmei.com/passport/js/common.js"></script>
<script type="text/javascript" src="https://csafestatic.wanmei.com/passport/js/regex.js"></script>
<script type="text/javascript" src="https://csafestatic.wanmei.com/public/js/jsencrypt.min.js"></script>
<script type="text/javascript" src="https://csafestatic.wanmei.com/vanguard/client/js/vanguard-common.js"></script>

	<script type="text/vbscript" src="https://csafestatic.wanmei.com/passport/vb/loginkey.vbs"></script>
		
	<script type="text/javascript">
		function showMsg(objId,msg){
			$(objId).text(msg).show();
		}
		function hideMsgAll(){
			$(".allmsg").each(function(){
				$(this).text("").hide();
			});
		}
		function hideMsg(objId){
			$(objId).text("").hide();
		}
		function showCaptcha(username){
			// is need
			var rand = Math.random(); // prevent IE browser cache the same url
			$.getJSON("/needCaptchaLogin",{username:username,rand:rand},function(r){
				if(r.code=="1"){
					$('.newpimgchangebtn').hide();
				}else{
					// get captcha key
					$.getJSON("/captcha/key?r="+rand,{rand:rand},function(r){
						if(r.code=="0"){
							$('input[name=captchaKey]').val(r.result);
							$('input[name=captcha]').val("");
							// get captcha
							$("#captchaImg").attr("src", "/captcha/img?captchaKey=" + r.result + "&r=" + rand);
							$('.newpimgchangebtn').show();
						}else{
							showMsg("#loginSysMsg",r.message);
						}
					}); 
				}
			});
		}
		function handleLoginRet(ret){
			if(ret.code==0){
				window.location.href='http://cpass.wanmei.com';
			}else if(ret.code==1){
				showMsg("#loginSysMsg",'请验证密保卡信息');
				var coors = ret.result;
				if(coors && coors.length==3){
					$('#matrixForm .coors').each(function(i,e){
						$(e).text(coors[i].y + "" + coors[i].x);
					});
				}
				$('#loginForm').hide();
				$('#matrixForm').show();
			}else if(ret.code==2){
				showMsg("#loginSysMsg",'请验证手机令牌');
				$('#loginForm').hide();
				$('#phoneForm').show();
			}else if(ret.code==10002){
				showMsg("#loginSysMsg",ret.message);
			}else if(ret.code==20002){
				showMsg("#loginSysMsg",ret.message);
			}else{
				showMsg("#loginSysMsg",ret.message);
			}
			showCaptcha($('input[name=username]').val());
		}
		function loginFF(passwd, account, rand) {
			var ret = 0;
			var obj = navigator.plugins["pwusbkey"];
			if (obj != undefined) {
				try{ 
					ret = pluginobj2.HMAC_MD5(passwd, rand);
				}catch (e){ 
				}
			}
			return ret; 
		}
		var u = navigator.userAgent, app = navigator.appVersion;
		function hasUsbKey(){
			//not IE, not FF, not Chrome
			if(u.indexOf('Trident') == -1 && u.indexOf('Gecko') == -1 && u.indexOf('WebKit') == -1){
				return false;
			}
			var ret = 0;
			if (u.indexOf('Trident') != -1) {
				try{ 
					ret = loginkey("test", "test", "test");
				}catch (e){ 
				}
			} else if (u.indexOf('Gecko') != -1 || u.indexOf('WebKit') != -1) {
				try{ 
					ret = loginFF("test", "test", "test");
				}catch (e){ 
				}
			} 
			if (ret !=0 && ret!==-1 && ret!=-2 && ret!=-3 && ret!=-4) {
				return true;
			} 
			return false;
		}
		function makeUsbPassword(username,password,macKey) {
			//not IE, not FF, not Chrome
			if(u.indexOf('Trident') == -1 && u.indexOf('Gecko') == -1 && u.indexOf('WebKit') == -1){
				showMsg("#loginSysMsg",'您的浏览器不支持完美神盾登录，请使用IE,Firefox,chrome浏览器');
				return '';
			}
	
			var ret = 0;
			if (u.indexOf('Trident') != -1) {
				try{ 
					ret = loginkey(password, username, macKey);
				}catch (e){ 
				}
			} else if (u.indexOf('Gecko') != -1 || u.indexOf('WebKit') != -1) {
				try{ 
					ret = loginFF(password, username, macKey);
				}catch (e){ 
				}
			} 
			if (ret.length > 10) {
				return ret;
			} else if (ret == 0) {
				if (u.indexOf('Trident') != -1) {
					$("#activeid").html("<OBJECT id='usbpw' progid='Pwusbkey.UsbKey.1' classid='clsid:7EA71132-FFE9-4BEC-8824-B94F83E1F353' codebase='https://csafestatic.wanmei.com/passport/download/usbkey/pwusbkey.cab' width='0px' height='0px'></OBJECT>");
				}
				alert("你没有安装usbkey控件,如果你的浏览器没能自动下载，请手动下载控件安装程序,地址:http://static.wanmei.com/passport/usbkey/pwusbkey.zip");
				window.location = "http://static.wanmei.com/passport/usbkey/pwusbkey.zip";
			} else if (ret == -1) {
				showMsg("#loginSysMsg","必要的DLL不存在，系统问题");
			} else if (ret == -2) {
				showMsg("#loginSysMsg","没有Key存在,请插入一个usbkey");
			} else if (ret == -3) {
				showMsg("#loginSysMsg","您插入了多个usbkey，请确认只有一个usbkey");
			} else if (ret == -4) {
				showMsg("#loginSysMsg","打开key失败，key损坏");
			} else if (ret == -5) {
				showMsg("#loginSysMsg","验证key密码错误");
			} else if (ret == -6) {
				showMsg("#loginSysMsg","进行计算错误");
			}
			return '';
		}
		$(document).ready(function() {
			var crypt = new JSEncrypt();
			crypt.setKey('MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCjfeE0MIYsZes/HwV06/kvRw34Hmhn9WPt0feLPp1PVqdqZz1/xFvPPEAJ/lAvfqt5kyn+A06bvYXIhizTjlOzPgLE4897ihuSYXgfwcUshPZvydRLbftU6Exj5SLbv5tw4GInbgQv7RWLWOKyQA81q6lWae2Kcgd1XpDRsQNXVwIDAQAB');
			
			$(".newploginc .newpinputs input").focus(function() {
				if (!$(this).closest(".newpinputs").hasClass("newperror")) {
					$(this).closest(".newpinputs").addClass("newperror");
				}
			});
			$(".newploginc .newpinputs input").blur(function() {
				if ($(this).closest(".newpinputs").hasClass("newperror")) {
					$(this).closest(".newpinputs").removeClass("newperror");
				}
			});
			showCaptcha($('input[name=username]').val());
    	/* 	$('#loginForm input').change(function(){
    			hideMsgAll();
    		}); */
    		$('#captchaChange').click(function(){
    			showCaptcha($('input[name=username]').val());
    		});
    		$('#captchaImg').click(function(){
    			showCaptcha($('input[name=username]').val());
    		});
    		$('input[name=username]').blur(function(){
    			if($.trim($(this).val())){
    				showCaptcha($(this).val());
    			}
    		});
    		$(".checks span em").click(function(){
    			var mytarget=$(this).parent().find("input")
    			if(mytarget.prop("checked")){
    				mytarget.prop("checked",false);
    				}
    			else{
    				mytarget.prop("checked",true);
    				}
    			})
    		$(".form3 .pb  input").focus(function(){
    			$(this).select();
    			})
    		$(".form3 .pb  input").keyup(function(){
    			var mys=$(this).val();
    			if(mys.length>1){
    				if($(this).next().is("input")){
    					$(this).next().focus();
    					}
    				else{
    					$(this).blur();
    					}
    				}
    			})
            $(".hdown input").keyup(function(e){
    				var mys=$(this).val();
    				var mylast=mys.charAt(mys.length-1)
    				if(mylast==""){
    					return
    					}
    				if (/^[^A-Z]+$/.test(mylast)){
    					$(".keydown").hide();
    					}
    				else{
    					$(".keydown").show();
    				}
    			})
    		// check key
    		setInterval(function(){
    			var em = $(".newpinputs.pwdinput em");
				if(hasUsbKey()){
					em.addClass("usbkey");
    			}else{
					em.removeClass("usbkey");
    			}
    		},3000);
    		$('#loginSub').click(function(){
    			hideMsgAll();
    			if(!$.trim($('input[name=username]').val())){
    				showMsg("#loginSysMsg","请输入用户名");
    				return false;
    			}
    			if(!$.trim($('input[name=password]').val())){
    				showMsg("#loginSysMsg","请输入密码");
    				return false;
    			}
    			var autoLoginInput = $("input[name=autoLogin]");
    			var autoLogin='0';
    			if(autoLoginInput.prop("checked")){
    				autoLogin=autoLoginInput.val();
    			}
    			var usbKeyInput = $("input[name=usbKey]");
    			var usbKey='0';
    			if(usbKeyInput.prop("checked")){
    				usbKey=usbKeyInput.val();
    			}
    			var encPasswd='';
    			// has key
    	 		if(usbKey && usbKey =='1'){ 
        			var macKey = randomString(4);
        			var hexMacVal = makeUsbPassword($('input[name=username]').val(),$('input[name=password]').val(),macKey);
    				encPasswd = crypt.encrypt(macKey+"|"+hexMacVal);
    			}else{// no key
    				encPasswd = crypt.encrypt($('input[name=password]').val());
    			} 
    	 		if(encPasswd){
    	 			invokeAjaxJson("/webPasswdLogin",
    	 					{autoLogin:autoLogin,
						 	 username:$('input[name=username]').val(),
							 password:encPasswd,
							 captchaKey:$('input[name=captchaKey]').val(),
							 captcha:$('input[name=captcha]').val(),
							 source:0
							},
							function(ret){
								handleLoginRet(ret);
				              },{isPost:true}
				    );
				}
				return false;
    		});
    		$('#matrixSub').click(function(){
    			hideMsgAll();
    			if(!$.trim($('input[name=username]').val())){
    				showMsg("#loginSysMsg","请输入用户名");
    				return false;
    			}
    			if(!$.trim($('input[name=code1]').val()) || !$.trim($('input[name=code2]').val()) 
    					||!$.trim($('input[name=code3]').val())){
    				showMsg("#mtMsg","请输入完整的动态数字");
    				return false;
    			}
    			var autoLoginInput = $("input[name=autoLogin]");
    			var autoLogin='0';
    			if(autoLoginInput.prop("checked")){
    				autoLogin=autoLoginInput.val();
    			}
				$.post("/webMatrixLogin",{autoLogin:autoLogin,
						 username:$('input[name=username]').val(),
						 code1:$('input[name=code1]').val(),
						 code2:$('input[name=code2]').val(),
						 code3:$('input[name=code3]').val(),
						 source:0
						},function(ret){
					if(ret.code==0){
						handleLoginRet(ret);
					}else{
						$('input[name=code1]').val("");
						$('input[name=code2]').val("");
						$('input[name=code3]').val("");
						
						$('#matrixForm').hide();
						$('#loginForm').show();
						showMsg("#loginSysMsg",ret.message);
					}
	    			showCaptcha($('input[name=username]').val());
				});
				return false;
    		});
    		$('#phoneSub').click(function(){
    			hideMsgAll();
    			if(!$.trim($('input[name=username]').val())){
    				showMsg("#loginSysMsg",'请输入用户名');
    				return false;
    			}
    			if(!$.trim($('input[name=phoneToken]').val())){
    				showMsg("#ptMsg",'请输入手机令牌');
    				return false;
    			}
    			var autoLoginInput = $("input[name=autoLogin]");
    			var autoLogin='0';
    			if(autoLoginInput.prop("checked")){
    				autoLogin=autoLoginInput.val();
    			}
				$.post("/webPhoneLogin",{autoLogin:autoLogin,
						 username:$('input[name=username]').val(),
						 phoneToken:$('input[name=phoneToken]').val(),
						 source:0
						},function(ret){
					if(ret.code==0){
						handleLoginRet(ret);
					}else{
	    				showMsg("#ptMsg",ret.message);
					}
	    			showCaptcha($('input[name=username]').val());
				});
				return false;
    		});
        });
	</script>



</body></html>