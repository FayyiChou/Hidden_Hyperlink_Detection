<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd"><html><head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8;">
    <meta name="viewport" content="initial-scale=1.0, width=device-width">
    <meta name="keywords" content="">
    <meta name="description" content="Usana">
    <meta name="title" content="Usana">
    <link rel="image_src" href="/media/File/dotComN/marketing/marketing_drwentz_big.jpg"><link rel="image_src" href="/media/Shop/products/US/big/lg-903-150EnrollmentPack.jpg">

    
    <link rel="stylesheet" href="/shop/styles/jquery-ui.css">

    
        <link rel="stylesheet" type="text/css" href="/shop/jsp/onlineServices/shop/inc/usana.css">
    
    <link rel="stylesheet" type="text/css" href="/shop/jsp/onlineServices/shop/inc/usana_shop.css">
        <link rel="stylesheet" type="text/css" href="/shop/jsp/onlineServices/shop/inc/usana_baby_care.css">

    
    
    

    <link rel="stylesheet" type="text/css" href="/shop/styles/jquery.countdown.css">

    <link href="/shop/styles/toastr.css" rel="stylesheet" type="text/css">

    <title>我的购物记录</title>
    
<script src="https://hm.baidu.com/hm.js?05362067a94feb96dcaf79154d65a193"></script><script type="text/javascript">
    function openWin(toPage) {
        window.open(toPage);
    }

</script></head>


<body><iframe id="_yuiResizeMonitor" title="Text Resize Monitor" style="position: absolute; visibility: visible; background-color: transparent; border-width: 0px; width: 2em; height: 2em; left: 0px; top: -27px; "></iframe>
    
    <div class="hideSection" id="pageLoadingMask">
        <div class="pageLoadingMask1">
        </div>
        <div class="pageLoadingMask2">
        </div>
    </div>









            <!-- Shopper Country: US<br>
            Shopper Language:  ENU.US<br>
            LangXlat Lang: ZHS.CN<br>
            first_name: null first_name<br>
            last_name: null last_name<br>
            state: null state<br>
            phone: null phone<br>
            email: null email<br>
            associate_id: null associate id<br>
            price_type: R<br>-->            
            
<div id="doc4">
    <div id="jqueryDialog" title="Dialog title"></div>

    <div id="updateBrwsMsg" class="ie6_msg"><div style="border: 1px solid #f7941d; background: #feefda none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous; text-align: center; clear: both; height: 75px; position: relative;"> <div style="position: absolute; right: 3px; top: 3px; font-family: courier new; font-weight: bold;"></div> <div style="margin: 0pt auto; padding: 0pt; overflow: hidden; width: 640px; text-align: left; color: black;"> <div style="width: 75px; float: left;"><img src="/media/Shop/changeBrowser/ie6nomore-warning.jpg" alt="Warning!"></div> <div style="width: 500px; float: left; font-family: Arial,sans-serif;"> <div style="font-size: 14px; font-weight: bold; margin-top: 12px;">BabyCare 支持 Internet Explorer 的最新版本和先前版本以及 Chrome, Firefox, Safari 浏览器的最新版本</div> <div style="font-size: 12px; margin-top: 6px; line-height: 12px;"> 若您见到此讯息，则应考虑更新。</div> </div> </div> </div></div>
<noscript>
    &lt;div class="javascriptTurnedOff"&gt;
        shop.javascript.is.turned.off
    &lt;/div&gt;
</noscript>


    <div id="hd">
        
		






















    <a id="headerLogo" href="https://today.baoying.com"></a>





















  
    
    
      
    
  
  



	        
































    

    


    
    
    
        
            
            
                <div id="headerTopRight" class="">
                    <div class="followMeTitle">
                        
                        
                    </div>

                    
                        <a class="accessBtn" href="https://today.baoying.com/dotCom/login">登入</a>
                    
                    
                    
                </div>
            
        
    


        	<!-- START SUMMARY BAR -->
	        <div id="headerBottomRight">
        	    






















    
    
    


    
            <div id="orderSummary">
                <ul><li id="summaryBar" class="clickable " onclick="renderToNav=3"><div>购物车</div>
                    <div id="orderSummaryTotals">
                        
                        <span>数量:&nbsp;0
                    </span></div>
                </li>
                
                    <!--/* Preloading hover images to prevent flicker*/ -->
                     <li class="checkoutBtnHoverFlickerFix" onclick="javascript:progressBarButtonOrOrderSummarySendToCheckout('regular');" style="display:none;"><div><strong>结账</strong></div></li>
                     <li class="checkoutBtn" onmouseover="this.className='checkoutBtnHover'" onmouseout="this.className='checkoutBtn'" onclick="javascript:progressBarButtonOrOrderSummarySendToCheckout('regular');"><div><strong>结账</strong></div></li>

                
                </ul>
            </div>
        
    

	        </div>
        	<!-- END SUMMARY BAR -->
	        
        
    </div><!-- END of Head Section-->

<div id="bd">
    



















  
    
      
    
    
  
  


    



















  
    
      
    
    
  
  


    



















  
    
      
    
    
  
  


    



















  
    
      
    
    
  
  


    



















  
    
      
    
    
  
  


    



















  
    
      
    
    
  
  


    



















  
    
      
    
    
  
  


    



















  
    
      
    
    
  
  


    



















  
    
      
    
    
  
  


    



















  
    
      
    
    
  
  


    



















  
    
      
    
    
  
  


    



















  
    
      
    
    
  
  


    



















  
    
      
    
    
  
  



<!-- End Header azureH.jsp / Begin Body Content -->

    <div id="main">
        























    <div id="progressBarContainer" class="hideSection">
    </div>
    



















  
    
    
      
    
  
  




        












<div id="uimessages">
    





</div>



        



























<div class="quarter_col float_left">
    <div id="lef_col_content">
        



















<li>
    <div id="checkoutButton" class="hiddenCheckout">
        <input type="hidden" id="canUseFastCheckout" value="false">
        <input type="hidden" id="isRetail" value="true">
        <input type="hidden" id="shopperLanguage" value="ENU">
        <button class="actionButton" id="hCartLink2" onclick="renderToNav=1;">
                <span style="width:14%;vertical-align:top">
                    <img src="/media/Shop/images/cart_btn_00.png" alt="" width="16px" height="16px">
                </span>
                <span style="width:84%; text-align:left; display:inline-block;">
                    <span id="checkoutButtonContent"></span>
                </span>
        </button>
    </div>
</li>





    
        <li>
            <div class="outieGray inlineBlock "><div class="innieGray inlineBlock"><div class="btn_large_gray inlineBlock">
                <a id="mhpButton" class="blueBold" href="/shop/mhp/InitMhp"><img src="/shop/jsp/onlineServices/shop/images/btn_large_MHP.png" height="42px" width="200px" style="position: relative; left: 0; top: 2px; border: none;"></a>
            </div></div></div>
        </li>
      







<div id="treeDiv1"></div>

<br>


    <a style="text-decoration:none" href="/shop/cart/BodySystem">促销套装</a><br>


    <a style="text-decoration:none" href="/shop/cart/Specials">商品</a><br>


    <br>


    <a style="text-decoration:none" href="/shop/cart/Bucket?groupType=product">产品名称列表</a><br>


    <a style="text-decoration:none" href="/shop/cart/Bucket?groupType=ingredient">产品成份列表</a><br>





    <a style="text-decoration:none" href="/shop/cart/ExpressList">快速购物</a><br>






<a style="text-decoration:none" href="https://www.truehealthassessment.com/demo">True Health Assessment</a><br>



<br>




    </div>
    <div class="clear"></div>
</div>



















































<form name="Step1Form" method="POST" action="/shop/mhp/PrepStep2FromStep3" onsubmit="return disableForm(this);">
    <input type="hidden" name="mhpIdToLoad">
</form>






















  
    
      
    
    
  
  






















  
    
      
    
    
  
  






















  
    
      
    
    
  
  






















  
    
      
    
    
  
  






















  
    
      
    
    
  
  






















  
    
      
    
    
  
  


<!-- Combo-handled YUI JS files: -->























  
    
    
      
    
  
  























  
    
      
    
    
      
    
  
  







<script type="text/javascript">
    function setupCategoryTree(){
        try{
            var tree = new YAHOO.widget.TreeView("treeDiv1", [
                
                {type:"text", label:"\u8425\u517B\u8865\u5145\u5242", expanded:false,
                    href:"/shop/cart/Categories?parentCat=3",
                    children: [
                        
                        {type:"text", label:"\u57FA\u7840\u8425\u517B", expanded:false,
                            href:"/shop/cart/Categories?parentCat=3&subCat=43",
                            children: [
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=100.010104&parentCat=3&subCat=43",
                                    label:"HealthPak\u2122"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=101.010104&parentCat=3&subCat=43",
                                    label:"CellSentials\u2122 Pack"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=102.010104&parentCat=3&subCat=43",
                                    label:"Core Minerals"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=103.010104&parentCat=3&subCat=43",
                                    label:"Vita-Antioxidant"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=106.010101&parentCat=3&subCat=43",
                                    label:"Mega AO w\/out Vitamin K"}
                                
                                
                            ]},
                        
                        {type:"text", label:"\u4F18\u5316\u8425\u517B", expanded:false,
                            href:"/shop/cart/Categories?parentCat=3&subCat=45",
                            children: [
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=109.010101&parentCat=3&subCat=45",
                                    label:"Vitamin D"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=110.010101&parentCat=3&subCat=45",
                                    label:"Proflavanol\u00AE C100"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=120.010102&parentCat=3&subCat=45",
                                    label:"MagneCal D\u2122"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=120.080102&parentCat=3&subCat=45",
                                    label:"Active Calcium without Vitamin K"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=121.010101&parentCat=3&subCat=45",
                                    label:"Active Calcium Chewable"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=122.010103&parentCat=3&subCat=45",
                                    label:"BiOmega\u2122"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=123.010101&parentCat=3&subCat=45",
                                    label:"CoQuinone\u00AE 30"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=126.010101&parentCat=3&subCat=45",
                                    label:"Ginkgo-PS\u2122"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=128.010101&parentCat=3&subCat=45",
                                    label:"Palmetto Plus\u2122"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=129.010101&parentCat=3&subCat=45",
                                    label:"PhytoEstrin\u2122"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=131.010103&parentCat=3&subCat=45",
                                    label:"Procosa\u00AE"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=134.010101&parentCat=3&subCat=45",
                                    label:"Visionex\u00AE"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=141.010102&parentCat=3&subCat=45",
                                    label:"Pure Rest"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=143.010101&parentCat=3&subCat=45",
                                    label:"Booster C 600\u2122"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=146.010100&parentCat=3&subCat=45",
                                    label:"Proglucamune"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=171.010100&parentCat=3&subCat=45",
                                    label:"Wellness Pro Pack"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=171.010110&parentCat=3&subCat=45",
                                    label:"Wellness Pro Plus"}
                                
                                
                            ]},
                        
                        {type:"text", label:"\u6D88\u5316\/\u6392\u6BD2", expanded:false,
                            href:"/shop/cart/Categories?parentCat=3&subCat=2",
                            children: [
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=108.010102&parentCat=3&subCat=2",
                                    label:"USANA\u00AE Probiotic"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=111.010102&parentCat=3&subCat=2",
                                    label:"Digestive Enzyme"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=135.010103&parentCat=3&subCat=2",
                                    label:"Hepasil DTX\u2122"}
                                
                                
                            ]},
                        
                        {type:"text", label:"Children\'\'s Health", expanded:false,
                            href:"/shop/cart/Categories?parentCat=3&subCat=127",
                            children: [
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=104.010102&parentCat=3&subCat=127",
                                    label:"Body Rox\u2122"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=105.010103&parentCat=3&subCat=127",
                                    label:"Usanimals\u2122"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=144.010100&parentCat=3&subCat=127",
                                    label:"BiOmega\u2122 Jr."},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=151.010189&parentCat=3&subCat=127",
                                    label:"Prenatal CellSentials\u2122"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=165.010100&parentCat=3&subCat=127",
                                    label:"Children\u2019s Complete Duo"}
                                
                                
                            ]}
                        
                    ]},
                
                
                {type:"text", label:"\u98DF\u54C1\u4E0E\u80FD\u91CF", expanded:false,
                    href:"/shop/cart/Categories?parentCat=1",
                    children: [
                        
                        {type:"text", label:"\u57FA\u7840\u8425\u517B", expanded:false,
                            href:"/shop/cart/Categories?parentCat=1&subCat=99",
                            children: [
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=205.010100&parentCat=1&subCat=99",
                                    label:"USANA MySmart\u2122 Shake Soy Shake Base"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=206.010100&parentCat=1&subCat=99",
                                    label:"USANA MySmart\u2122 Shake Plant Shake Base"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=207.010100&parentCat=1&subCat=99",
                                    label:"USANA MySmart\u2122 Shake Whey Shake Base"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=208.010100&parentCat=1&subCat=99",
                                    label:"USANA MySmart\u2122 Shake Protein Booster"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=226.010103&parentCat=1&subCat=99",
                                    label:"USANA MySmart\u2122 Shake Fibergy Plus"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=236.010102&parentCat=1&subCat=99",
                                    label:"USANA MySmart\u2122 Bar Peanut Butter"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=237.010102&parentCat=1&subCat=99",
                                    label:"USANA MySmart\u2122 Bar Dark Chocolate"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=238.010102&parentCat=1&subCat=99",
                                    label:"USANA MySmart\u2122 Berry Nutty Bar"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=251.010070&parentCat=1&subCat=99",
                                    label:"MySmartStart Kit"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=251.010109&parentCat=1&subCat=99",
                                    label:"USANA MySmart\u2122 Start Kit 4 Pack"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=252.010001&parentCat=1&subCat=99",
                                    label:"Custom USANA MySmart\u2122 Start Kit"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=255.010100&parentCat=1&subCat=99",
                                    label:"Single Serve Packets (Soy)"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=256.010100&parentCat=1&subCat=99",
                                    label:"Single Serve Packets (Plant)"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=257.010100&parentCat=1&subCat=99",
                                    label:"Single Serve Packets (Whey)"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=280.010100&parentCat=1&subCat=99",
                                    label:"USANA MySmart\u2122 Chocolate Flavor Opt"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=281.010100&parentCat=1&subCat=99",
                                    label:"USANA MySmart\u2122 Shake Peach Mango Flavor"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=282.010100&parentCat=1&subCat=99",
                                    label:"USANA MySmart\u2122 Shake Banana Flavor Opt"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=283.010100&parentCat=1&subCat=99",
                                    label:"USANA MySmart\u2122 Strawberry Flavor Opt"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=284.010100&parentCat=1&subCat=99",
                                    label:"USANA MySmart\u2122 Milk Chocolate Optimizer"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=285.010100&parentCat=1&subCat=99",
                                    label:"USANA MySmart\u2122 Green Tea Optimizer"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=288.010100&parentCat=1&subCat=99",
                                    label:"USANA MySmart\u2122 Cappuccino Flavor Opt"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=289.010100&parentCat=1&subCat=99",
                                    label:"USANA MySmart\u2122 Shake Orange Cream Flavor"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=426.010100&parentCat=1&subCat=99",
                                    label:"Deluxe Digestion & Detox Pack"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=428.010100&parentCat=1&subCat=99",
                                    label:"Digestion & Detox Pack"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=463.010101&parentCat=1&subCat=99",
                                    label:"Transform Kit"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=463.010128&parentCat=1&subCat=99",
                                    label:"Custom Transform Kit"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=465.010100&parentCat=1&subCat=99",
                                    label:"USANA MySmart\u2122 Start + Transform Kits"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=467.010100&parentCat=1&subCat=99",
                                    label:"MySmart Pack"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=752.010032&parentCat=1&subCat=99",
                                    label:"MySmart\u2122Shake BlenderBottle\u00AE"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=752.010034&parentCat=1&subCat=99",
                                    label:"MySmart\u2122Shake BlenderBottle\u00AE"}
                                
                                
                            ]},
                        
                        {type:"text", label:"\u8FDB\u9636\u62A4\u7406", expanded:false,
                            href:"/shop/cart/Categories?parentCat=1&subCat=97",
                            children: [
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=138.010100&parentCat=1&subCat=97",
                                    label:"Rev3 Energy\u00AE"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=139.010101&parentCat=1&subCat=97",
                                    label:"Rev3 Energy\u00AE Surge Pack"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=139.010119&parentCat=1&subCat=97",
                                    label:"Rev3 Energy\u00AE Surge Refill 28pk, US"}
                                
                                
                            ]},
                        
                        {type:"text", label:"shop.categories.di&en.classic", expanded:false,
                            href:"/shop/cart/Categories?parentCat=1&subCat=162",
                            children: [
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=209.010100&parentCat=1&subCat=162",
                                    label:"Nutrimeal\u2122 Free"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=210.010103&parentCat=1&subCat=162",
                                    label:"Chocolate Nutrimeal\u2122"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=211.010103&parentCat=1&subCat=162",
                                    label:"Vanilla Nutrimeal\u2122"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=752.010007&parentCat=1&subCat=162",
                                    label:"BlenderBottle\u00AE"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=914.010100&parentCat=1&subCat=162",
                                    label:"French Vanilla Nutrimeal\u2122 Pouches\u201428 Pk"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=914.010101&parentCat=1&subCat=162",
                                    label:"Dutch Chocolate Nutrimeal\u2122 Pouch\u201428 Pk"}
                                
                                
                            ]}
                        
                    ]},
                
                
                {type:"text", label:"Sens\u00E9\u62A4\u80A4\u54C1", expanded:false,
                    href:"/shop/cart/Categories?parentCat=5",
                    children: [
                        
                        {type:"text", label:"\u57FA\u672C\u62A4\u7406", expanded:false,
                            href:"/shop/cart/Categories?parentCat=5&subCat=41",
                            children: [
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=300.010101&parentCat=5&subCat=41",
                                    label:"Gentle Daily Cleanser"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=301.010101&parentCat=5&subCat=41",
                                    label:"Hydrating Toner"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=302.010106&parentCat=5&subCat=41",
                                    label:"Daytime Protective Emulsion, w\/ SPF 15"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=303.010102&parentCat=5&subCat=41",
                                    label:"Night Renewal Cr\u00E8me"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=350.010111&parentCat=5&subCat=41",
                                    label:"Deluxe Pack with Perfecting Essence"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=350.010121&parentCat=5&subCat=41",
                                    label:"Deluxe Pack with Serum Intensive"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=350.010124&parentCat=5&subCat=41",
                                    label:"Deluxe 4-Pack with Serum Intensive"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=350.010125&parentCat=5&subCat=41",
                                    label:"Deluxe 4-Pack with Perfecting Essence"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=351.010101&parentCat=5&subCat=41",
                                    label:"Sens\u00E9\u2122 Basic Pack"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=351.010104&parentCat=5&subCat=41",
                                    label:"Sense Basic Pack, (4 Pack)"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=352.010110&parentCat=5&subCat=41",
                                    label:"Perfectly Beautiful Sens\u00E9\u2122 Pack"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=761.010100&parentCat=5&subCat=41",
                                    label:"Sens\u00E9 Vanity Organizer"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=762.010005&parentCat=5&subCat=41",
                                    label:"2015 Sens\u00E9 Canvas Bag"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=762.010007&parentCat=5&subCat=41",
                                    label:"Sens\u00E9 Silver Tote Bag"}
                                
                                
                            ]},
                        
                        {type:"text", label:"\u8FDB\u9636\u62A4\u7406", expanded:false,
                            href:"/shop/cart/Categories?parentCat=5&subCat=101",
                            children: [
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=304.010102&parentCat=5&subCat=101",
                                    label:"Serum Intensive"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=305.010102&parentCat=5&subCat=101",
                                    label:"Perfecting Essence"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=306.010101&parentCat=5&subCat=101",
                                    label:"Eye Nourisher"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=307.010101&parentCat=5&subCat=101",
                                    label:"Rice Bran Polisher"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=308.010101&parentCat=5&subCat=101",
                                    label:"Nutritious Cr\u00E8me Masque"}
                                
                                
                            ]},
                        
                        {type:"text", label:"\u5934\u53D1\u4E0E\u8EAB\u4F53\u62A4\u7406", expanded:false,
                            href:"/shop/cart/Categories?parentCat=5&subCat=39",
                            children: [
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=311.010103&parentCat=5&subCat=39",
                                    label:"Energizing Shower Gel"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=312.010102&parentCat=5&subCat=39",
                                    label:"Revitalizing Shampoo"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=313.010102&parentCat=5&subCat=39",
                                    label:"Nourishing Conditioner"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=314.010102&parentCat=5&subCat=39",
                                    label:"Firming Body Nourisher"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=315.010102&parentCat=5&subCat=39",
                                    label:"Intensive Hand Therapy"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=354.010101&parentCat=5&subCat=39",
                                    label:"Sens\u00E9  Hair And Body Pack"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=360.010101&parentCat=5&subCat=39",
                                    label:"Sens\u00E9  Shower Pack"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=391.000000&parentCat=5&subCat=39",
                                    label:"Body Polishing Gloves"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=399.010101&parentCat=5&subCat=39",
                                    label:"Natural Whitening Toothpaste"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=719.010118&parentCat=5&subCat=39",
                                    label:"Sens\u00E9\u2122 Bag & Organizer"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=753.000000&parentCat=5&subCat=39",
                                    label:"Shower Gel Pump"}
                                
                                
                            ]}
                        
                    ]},
                
                
                {type:"text", label:"\u8F85\u9500\u5DE5\u5177", expanded:false,
                    href:"/shop/cart/Categories?parentCat=7",
                    children: [
                        
                        {type:"text", label:"\u6807\u5FD7\u5546\u54C1", expanded:false,
                            href:"/shop/cart/Categories?parentCat=7&subCat=35",
                            children: [
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=504.010110&parentCat=7&subCat=35",
                                    label:"10pk InCelligence Mini Brochure (US\/ENG)"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=504.010310&parentCat=7&subCat=35",
                                    label:"US CH InCelligence Mini 10pk Brochure"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=504.010610&parentCat=7&subCat=35",
                                    label:"US SP InCelligence Mini 10pk Brochure"}
                                
                                
                            ]},
                        
                        {type:"text", label:"\u996E\u98DF\u4E0E\u80FD\u91CF\u63A2\u67E5", expanded:false,
                            href:"/shop/cart/Categories?parentCat=7&subCat=109",
                            children: [
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=291.010102&parentCat=7&subCat=109",
                                    label:"Pedometer\/BlenderBottle\u00AE Duo"}
                                
                                
                            ]}
                        
                    ]},
                
                
                {type:"text", label:"\u4FC3\u9500\u5546\u54C1", expanded:false,
                    href:"/shop/cart/Categories?parentCat=9",
                    children: [
                        
                        {type:"text", label:"\u6807\u5FD7\u5546\u54C1", expanded:false,
                            href:"/shop/cart/Categories?parentCat=9&subCat=115",
                            children: [
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=703.010043&parentCat=9&subCat=115",
                                    label:"Unisex USANA Zip Hoodie, XS"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=703.010044&parentCat=9&subCat=115",
                                    label:"Unisex USANA Zip Hoodie, SM"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=703.010045&parentCat=9&subCat=115",
                                    label:"Unisex USANA Zip Hoodie, MD"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=703.010046&parentCat=9&subCat=115",
                                    label:"Unisex USANA Zip Hoodie, LG"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=703.010047&parentCat=9&subCat=115",
                                    label:"Unisex USANA Zip Hoodie, XL"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=703.010048&parentCat=9&subCat=115",
                                    label:"Unisex USANA Zip Hoodie, XXL"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=703.010050&parentCat=9&subCat=115",
                                    label:"Women\u2019s USANA Workout Tank, XS"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=703.010051&parentCat=9&subCat=115",
                                    label:"Women\u2019s USANA Workout Tank, SM"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=703.010052&parentCat=9&subCat=115",
                                    label:"Women\u2019s USANA Workout Tank, MD"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=703.010053&parentCat=9&subCat=115",
                                    label:"Women\u2019s USANA Workout Tank, LG"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=703.010054&parentCat=9&subCat=115",
                                    label:"Women\u2019s USANA Workout Tank, XL"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=703.010055&parentCat=9&subCat=115",
                                    label:"Women\u2019s USANA Workout Tank, XXL"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=708.010037&parentCat=9&subCat=115",
                                    label:"Women\u2019s USANA Yoga Capris, XS"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=708.010038&parentCat=9&subCat=115",
                                    label:"Women\u2019s USANA Yoga Capris, SM"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=708.010039&parentCat=9&subCat=115",
                                    label:"Women\u2019s USANA Yoga Capris, MD"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=708.010040&parentCat=9&subCat=115",
                                    label:"Women\u2019s USANA Yoga Capris, LG"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=708.010041&parentCat=9&subCat=115",
                                    label:"Women\u2019s USANA Yoga Capris, XL"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=708.010042&parentCat=9&subCat=115",
                                    label:"Women\u2019s USANA Yoga Capris, XXL"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=722.010000&parentCat=9&subCat=115",
                                    label:"Men\u2019s USANA Track Jacket, SM"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=722.010010&parentCat=9&subCat=115",
                                    label:"Men\u2019s USANA Track Jacket, MD"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=722.010011&parentCat=9&subCat=115",
                                    label:"Men\u2019s USANA Track Jacket, LG"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=722.010012&parentCat=9&subCat=115",
                                    label:"Men\u2019s USANA Track Jacket, XL"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=722.010013&parentCat=9&subCat=115",
                                    label:"Men\u2019s USANA Track Jacket, XXL"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=722.010015&parentCat=9&subCat=115",
                                    label:"Women\u2019s USANA Workout Jacket, XS"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=722.010016&parentCat=9&subCat=115",
                                    label:"Women\u2019s USANA Workout Jacket, SM"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=722.010017&parentCat=9&subCat=115",
                                    label:"Women\u2019s USANA Workout Jacket, MD"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=722.010018&parentCat=9&subCat=115",
                                    label:"Women\u2019s USANA Workout Jacket, LG"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=722.010019&parentCat=9&subCat=115",
                                    label:"Women\u2019s USANA Workout Jacket, XL"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=722.010020&parentCat=9&subCat=115",
                                    label:"Women\u2019s USANA Workout Jacket, XXL"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=752.010039&parentCat=9&subCat=115",
                                    label:"USANA MySmart\u2122 Grab & Go BlenderBottle\u00AE"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=795.010003&parentCat=9&subCat=115",
                                    label:"Silver USANA Drop Earrings"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=795.010004&parentCat=9&subCat=115",
                                    label:"Silver USANA Pendant Necklace"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=795.010005&parentCat=9&subCat=115",
                                    label:"Silver USANA Cuff Bracelet"}
                                
                                
                            ]}
                        
                    ]},
                
                
                {type:"text", label:"\u4E3A\u4EBA\u9053\u63F4\u52A9\u6350\u6B3E", expanded:false,
                    href:"/shop/cart/Categories?parentCat=11",
                    children: [
                        
                        {type:"text", label:"\u901A\u7528\u57FA\u91D1", expanded:false,
                            href:"/shop/cart/Categories?parentCat=11&subCat=48",
                            children: [
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=899.010102&parentCat=11&subCat=48",
                                    label:"\u2605\u2605 Area of Greatest Need"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=899.010103&parentCat=11&subCat=48",
                                    label:"\u2605\u2605\u2605 Area of Greatest Need"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=899.010110&parentCat=11&subCat=48",
                                    label:"\u2605 Area of Greatest Need"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=899.010118&parentCat=11&subCat=48",
                                    label:"THF $365 One-Time Donation"}
                                
                                
                            ]},
                        
                        {type:"text", label:"\u513F\u7AE5\u9965\u9991\u57FA\u91D1\u4F1A", expanded:false,
                            href:"/shop/cart/Categories?parentCat=11&subCat=117",
                            children: [
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=899.010105&parentCat=11&subCat=117",
                                    label:"\u2605\u2605\u2605 CHF Donation"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=899.010116&parentCat=11&subCat=117",
                                    label:"\u2605\u2605 CHF Donation"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=899.010117&parentCat=11&subCat=117",
                                    label:"\u2605 CHF Donation"}
                                
                                
                            ]},
                        
                        {type:"text", label:"In Honor Of donation", expanded:false,
                            href:"/shop/cart/Categories?parentCat=11&subCat=122",
                            children: [
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=899.010113&parentCat=11&subCat=122",
                                    label:"A Children\'s Hunger Fund Gift"},
                                
                                
                                {type:"text",
                                    href:"/shop/spring/shopping/productDetail?ProductID=899.010112&parentCat=11&subCat=122",
                                    label:"An Area of Greatest Need Gift"}
                                
                                
                            ]}
                        
                    ]}
                
                
            ]);
            tree.render();
        }catch(e){alert(e);}
        YAHOO.util.Event.onDOMReady(function(){
            try{
                var selectedPage = "";
                var nodes = YAHOO.util.Dom.getElementsByClassName('ygtvlabel');
                for(i=0;i<nodes.length;i++){
                    if(selectedPage.substr(0,2) == 'pa'){
                        if(nodes[i].href.indexOf('parentCat='+selectedPage.substr(2,selectedPage.length)) > -1){
                            YAHOO.util.Dom.addClass(nodes[i],"selected");
                            break;
                        }
                    }else if(selectedPage.substr(0,2) == 'sb'){
                        if(nodes[i].href.indexOf('subCat='+selectedPage.substr(2,selectedPage.length)) > -1){
                            YAHOO.util.Dom.addClass(nodes[i],"selected");
                            break;
                        }
                    }else if(selectedPage.substr(0,2) == 'pr'){
                        if(nodes[i].href.indexOf('ProductID='+selectedPage.substr(2,selectedPage.length)) > -1){
                            YAHOO.util.Dom.addClass(nodes[i],"selected");
                            break;
                        }
                    }
                }
            }catch(e){alert(e);}
        });
    }
</script>




















  
    
      
    
    
      
    
  
  



    </div>

</div><!-- CLOSE THE bd div-->
        
<div class="yui-panel-container yui-dialog yui-overlay-hidden yui-simple-dialog shadow" id="cartWidget_c" style="visibility: hidden; z-index: 2; "><div id="cartWidget" class="yui-module yui-overlay yui-panel" style="visibility: inherit; width: 530px; "><div class="hd" style="cursor: auto; ">购物车</div><div class="bd"><form name="frm_cartWidget"><input type="hidden" name="cartWidget" value=""><input type="hidden" name="cartWidget" value=""></form></div><div class="ft"><span class="button-group"><span id="yui-gen0" class="yui-button yui-push-button"><span class="first-child"><button type="button" id="yui-gen0-button">Checkout</button></span></span><span id="yui-gen1" class="yui-button yui-push-button default"><span class="first-child"><button type="button" id="yui-gen1-button">Clear Cart</button></span></span></span></div><a class="container-close" href="#">Close</a></div></div></div><!-- CLOSE THE doc4 div-->

<!--  End Body Content / Begin Footer azureF.jsp  -->

 

    <div id="ft_wrap">
        <div id="ft">
            <div id="ft_content">
                <div id="ft_bottom">
                    <span class="float_left ft_copyright">©BabyCare All Rights Reserved　京ICP备05032781号，统一社会信用代码：91110302710920362G,食品经营许可证号：JY11131010391571<br>
                        <a href="https://today.baoying.com/dotCom/about/terms" target="_blank">&nbsp;</a>
                    </span>
                </div>
            </div>
        </div>
        <div class="clear"></div>
    </div>

<div class="yui-skin-sam">
    <div id="firstTimeContainer">
        <div id="dialogMessagePanel">
            <div class="hd" id="flyoutHd"></div>
            <div class="bd alignLeft" id="flyoutBd"></div>
        </div>
    <div id="freightMessagePanel">
        <div class="hd" id="freightHd"></div>
        <div class="bd alignLeft" id="freightBd"></div>
    </div>
    <div id="bdsRemovalMessagePanel">
        <div class="hd" id="bdsRemovalMessagePanelHd"></div>
        <div class="bd alignLeft" id="bdsRemovalMessagePanelBd"></div>
    </div>
<div class="yui-panel-container yui-dialog yui-overlay-hidden yui-simple-dialog shadow" id="simpledialog1_c" style="visibility: hidden; left: 10px; top: 10px; z-index: 2; "><div id="simpledialog1" class="yui-module yui-overlay yui-panel" style="visibility: inherit; width: 400px; height: 200px; "><div class="hd" style="cursor: auto; ">ha.us.only</div><div class="bd" style="height: 118px; "><span class="yui-icon hlpicon">&nbsp;</span><form name="frm_simpledialog1"><input type="hidden" name="simpledialog1" value=""><input type="hidden" name="simpledialog1" value=""></form></div><a class="container-close" href="#">Close</a><div class="ft"><span class="button-group"><span id="yui-gen2" class="yui-button yui-push-button default"><span class="first-child"><button type="button" id="yui-gen2-button">确定</button></span></span><span id="yui-gen3" class="yui-button yui-push-button"><span class="first-child"><button type="button" id="yui-gen3-button">shop.enroll</button></span></span></span></div></div></div></div>
<div id="askQuiteOEApplicationEarlyPanel">
    <div class="hd" id="askQuiteOEApplicationEarlyPanelHd"></div>
    <div class="bd alignLeft" id="askQuiteOEApplicationEarlyPanelBd"></div>
</div>
<div id="askCreateAutoshipPanel">
    <div class="hd" id="askCreateAutoshipHd"></div>
    <div class="bd alignLeft" id="askCreateAutoshipBd"></div>
</div>
<div id="genericPanel">
    <div class="hd" id="genericPanelHd"></div>
    <div class="bd alignLeft" id="genericPanelBd"></div>
</div>
 </div>

<form name="addressLookupPanelForm" id="addressLookupPanelForm" action="">
    <div class="yui-skin-sam">
        <div id="addressLookupPanel">
            <div class="hd" id="addressLookupPanelHd"></div>
            <div class="bd alignLeft" id="addressLookupPanelBd" style="overflow: auto;"></div>
        </div>
    </div>
</form>
<script type="text/javascript" src="/shop/jsp/onlineServices/shop/inc/jquery-1.8.1.min.js"></script>
<script type="text/javascript" src="/shop/javascript/jquery-ui-1.9.2.js?v=2015-07-14"></script>

    <script type="text/javascript">
    $(function(){
        $(document).on('click','#mhpPak', function(){
            $("#cartForm").find(".pakDisplay .displayBody tr:odd").addClass("oddRow");
        });
    });
</script>
<script src="/shop/javascript/toastr.js"></script>

<form name="ipadPromoDigitalSignatureForm" id="ipadPromoDigitalSignatureForm" action="">
    <div class="yui-skin-sam">
        <div id="ipadPromoDigitalSignaturePanel">
            <div class="hd" id="ipadPromoDigitalSignaturePanelHd"></div>
            <div class="bd alignLeft" id="ipadPromoDigitalSignatureBd" style="overflow: auto;"></div>
        </div>
    </div>
</form>
<div class="yui-skin-sam">
    <div id="apoFromH2WAddOrReplace">
        <div class="hd" id="apoFromH2WAddOrReplaceHd"></div>
        <div class="bd alignLeft" id="apoFromH2WAddOrReplaceBd" style="overflow: auto;"></div>
    </div>
</div>




























































  
    
    
      
    
  
  














<script type="text/javascript" src="/shop/combo.js?yui/build/yahoo-dom-event/yahoo-dom-event.js&amp;yui/build/animation/animation-min.js&amp;yui/build/container/container-min.js&amp;yui/build/menu/menu-min.js&amp;yui/build/element/element-min.js&amp;yui/build/button/button-min.js&amp;yui/build/connection/connection-min.js&amp;yui/build/json/json-min.js&amp;jsp/onlineServices/shop/inc/sg_largeHelp.js&amp;jsp/onlineServices/shop/inc/AjaxLoadingMask.js&amp;javascript/jquery.plugin-min.js&amp;javascript/jquery.countdown.min.js&amp;js/jquery.sessionTimeout.js&amp;yui/build/dragdrop/dragdrop-min.js&amp;yui/build/datasource/datasource-min.js&amp;yui/build/datatable/datatable-min.js&amp;yui/build/datasource/paginator-min.js&amp;javascript/shop.js&amp;javascript/fixYui.js&amp;js/thaSurveys/tha-survey-table.js&amp;yui/build/treeview/treeview-min.js&amp;v=2015-07-14"></script>



<script type="text/javascript">
    function alternativeYahooNumberFormat(n,cfg){
        if (!isFinite(+n)) {
            return '';
        }

        n   = !isFinite(+n) ? 0 : +n;
        /* Removed this line from the orginal function because we didn't want to include datasource on every page load
         If you want to add this line back in also include datasource in the bulk include or individual page include
         */
//        cfg = YAHOO.lang.merge(YAHOO.util.Number.format.defaults, (cfg || {}));

        var neg    = n < 0,        absN   = Math.abs(n),
                places = cfg.decimalPlaces,
                sep    = cfg.thousandsSeparator,
                s, bits, i;

        if (places < 0) {
            // Get rid of the decimal info
            s = absN - (absN % 1) + '';
            i = s.length + places;

            // avoid 123 vs decimalPlaces -4 (should return "0")
            if (i > 0) {
                // leverage toFixed by making 123 => 0.123 for the rounding
                // operation, then add the appropriate number of zeros back on
                s = Number('.' + s).toFixed(i).slice(2) +
                        new Array(s.length - i + 1).join('0');
            } else {
                s = "0";
            }
        } else {        // There is a bug in IE's toFixed implementation:
            // for n in {(-0.94, -0.5], [0.5, 0.94)} n.toFixed() returns 0
            // instead of -1 and 1. Manually handle that case.
            s = absN < 1 && absN >= 0.5 && !places ? '1' : absN.toFixed(places);
        }

        if (absN >= 1000) {
            bits  = s.split(/\D/);
            i  = bits[0].length % 3 || 3;

            bits[0] = bits[0].slice(0,i) +
                    bits[0].slice(i).replace(/(\d{3})/g, sep + '$1');

            s = bits.join(cfg.decimalSeparator);
        }else{
            bits  = s.split(/\D/);
            s = bits.join(cfg.decimalSeparator);
        }

        s = cfg.prefix + s + cfg.suffix;

        return neg ? cfg.negativeFormat.replace(/#/,s) : s;
    }
</script>



<script type="text/javascript">

    YAHOO.namespace("USANA.container");
    YAHOO.namespace("USANA.translations.cartWidget");
    //THIS SCRIPT IS FOR CREATING CONSTANTS TO BE USED IN js FILES
    var CHECKOUT_LINK = "/shop/checkout/SendToCorrectCheckout.action?noSave";
    var CHECKOUT_TXT ="结算";
    var FREIGHT_CALC_LINK = "javascript:showFreightCalc()";
    var FREIGHT_CALC_TXT ="Shipping";
    
    var FAST_CHECKOUT_LINK = "javascript:showDialogWindow('shop.checkout.cannot.use.fast.checkout',null,'true')";

    

    var FAST_CHECKOUT_TXT ="快速结账";

    var CONTEXT_PATH = "/shop";
    var CLOSE_TXT = "关闭";
    var IS_APO_MODE = "false";
    var shopMode = '';
    var skipAutoship = '0';
    YAHOO.USANA.translations.cartWidget.TITLE="\u8D2D\u7269\u8F66";
    YAHOO.USANA.translations.cartWidget.TABLE_ID="\u4EA7\u54C1\u7F16\u7801:";
    YAHOO.USANA.translations.cartWidget.TABLE_NAME="\u4EA7\u54C1\u540D\u79F0";
    YAHOO.USANA.translations.cartWidget.TABLE_PRICE="\u4EF7\u683C";
    YAHOO.USANA.translations.cartWidget.TABLE_VOL="\u5206\u6570";
    YAHOO.USANA.translations.cartWidget.TABLE_QTY="\u6570\u91CF";
    YAHOO.USANA.translations.cartWidget.EMPTY="\u8D2D\u7269\u8F66\u662F\u7A7A\u7684";
    YAHOO.USANA.translations.cartWidget.SUBTOTAL="\u5C0F\u8BA1";
    YAHOO.USANA.translations.cartWidget.VOLUME="\u5206\u6570";
    YAHOO.USANA.translations.cartWidget.CHECKOUT="shop.cartwidget.checkout";
    YAHOO.USANA.translations.cartWidget.UPDATE="\u66F4\u65B0\u6570\u91CF";
    YAHOO.USANA.translations.cartWidget.REMOVE_PRODUCT="移除此项产品";
    YAHOO.USANA.translations.cartWidget.REMOVE_PRODUCT_IN_SUMMARY="\u5220\u9664";
    YAHOO.USANA.translations.cartWidget.APO_REMOVING_PRODUCT="\u8BF7\u7559\u610F: \u4ECE2009\u5E747\u67084\u65E5\u8D77, \u82E5\u60A8\u53D6\u6D88\u6216\u66F4\u6539\u81EA\u52A8\u8BA2\u8D27\u5957\u88C5, \u60A8\u5C06\u4E0D\u5141\u8BB8\u91CD\u65B0\u8BA2\u8D2D\u8FD9\u4E2A\u81EA\u52A8\u8BA2\u8D27\u5957\u88C5\u3002\u8BF7\u6309\u201C\u66F4\u65B0\u201D\u952E\u786E\u8BA4\u3002";
    YAHOO.USANA.translations.cartWidget.FAST_CHECKOUT_ENABLED="false";
    YAHOO.USANA.translations.cartWidget.FAST_CHECKOUT_MENU=undefined;
    YAHOO.USANA.translations.cartWidget.ISRETAIL="true";
    YAHOO.USANA.translations.cartWidget.SHOWFREIGHTCALC="true";
    YAHOO.USANA.translations.cartWidget.SHOWCARTQUANTITY="true";
    YAHOO.USANA.translations.cartWidget.WARNING="Error                ";
    YAHOO.USANA.translations.cartWidget.QTYINFRACTION="TBD";
    YAHOO.USANA.translations.cartWidget.CANTREMOVEPRODUCT="apo.cant.remove.product";
    YAHOO.USANA.translations.cartWidget.QUANTITYLIMITSEXCEEDED="\u60A8\u5DF2\u8D85\u8FC7\u4E86\u8BE5\u4EA7\u54C1\u7684\u6700\u9AD8\u6570\u91CF\uFF1A{0}";
    YAHOO.USANA.translations.cartWidget.QUANTITYLIMITSEXCEEDEDTITLE="\u4EA7\u54C1\u6570\u91CF\u4E0A\u9650";
    YAHOO.USANA.translations.cartWidget.TRIED_TO_REMOVE_BDS_TITLE="\u521B\u4E1A\u8D77\u6B65\u5957\u88C5";
    YAHOO.USANA.translations.cartWidget.TRIED_TO_REMOVE_BDS_MESSAGE="\u8981\u7EE7\u7EED\u8FDB\u884C\u5165\u4F1A\u767B\u8BB0\u624B\u7EED\u5FC5\u987B\u5148\u8BA2\u8D2D\u4E00\u7EC4\u521B\u4E1A\u8D77\u6B65\u5957\u88C5(BDS)\u4EA7\u54C1\u3002<br><br>\u8981\u7EE7\u7EED\u60A8\u521A\u521A\u6240\u9009\u7684BDS\u4EA7\u54C1\uFF0C\u8BF7\u70B9\u51FB<strong>\u7EE7\u7EED<\/strong>\u94AE\u3002<br><br>\u8981\u66F4\u6362\u521A\u521A\u6240\u9009\u7684BDS\u4EA7\u54C1\uFF0C\u8BF7\u70B9\u51FB<strong>\u66F4\u6362<\/strong>\u94AE\u3002";
    YAHOO.USANA.translations.cartWidget.ISAPO = "false";
    YAHOO.USANA.translations.cartWidget.SUMMARY_BAR_QUANTITY="\u6570\u91CF";
    YAHOO.USANA.translations.cartWidget.SUMMARY_BAR_VOLUME="\u5206\u6570";
    YAHOO.USANA.translations.cartWidget.REMOVED_FROM_CART="Product removed from cart";
    YAHOO.USANA.translations.cartWidget.ADDED_TO_CART="shop.added.to.cart";
    YAHOO.USANA.translations.cartWidget.UPDATE_COMPLETE="Product quantity updated";

    // I'm adding one variable that is the name of the id where we render the cart widget
    var renderToNav = 2;
    var Dom = YAHOO.util.Dom;
</script>













<style type="text/css">
    .errorColorRed {
        color: red !important;
        border-color: red !important;
    }
    .errorColorRed input{
        border-color: red;
    }
    .errorColorRed select{
        border-color: red;
    }
    .alignLeft{
        text-align: left;
    }
    .errorContainer{
        background: white;
        box-shadow: 5px 5px 5px #444;
        border-radius: 5px;
        border: 1px solid #aaa;
        visibility: inherit;
    }
</style>

<div id="container">
    <div id="errorMessagePanel" class="errorContainer">
        <div class="hd" id="flyoutHd"></div>
        <div class="bd alignLeft" id="flyoutBd"></div>
    </div>
</div>




















  
    
    
      
    
  
  


<script type="text/javascript">

function setupAddressErrors(responseText){
    var jsonText = responseText;
    var jsonObject = eval('(' + jsonText + ')');

    var counter = 0;
    var retVal = jsonObject.AllArrays;
    var errorTextTotal = "";
    for(var i = 0; i < retVal.length; i++){
        var error = retVal[i].errorMessages;
        if(error[2] != undefined && "errorOnly" == error[2].errorOnly){
            errorTextTotal += error[1].errorValue + '<br>';
        }
        var x = document.getElementById(error[0].errorKey);
        if(x != null){
            addClass(x, 'errorColorRed');
            new YAHOO.widget.Tooltip("tt" + counter++, {
                context:error[0].errorKey,
                text: error[1].errorValue,
                showDelay:500
            } );
        }
    }
    showErrorWindow(errorTextTotal);
}
var howManyTries = 0;
function turnRed(){
    var goingToTryAgain = 0;
    
}

function closeErrorHandlerWindow(){
    YAHOO.example.container.errorWindow.hide();
}
function showErrorWindow(arg, title, width) {
    var errorWindowTitle = "提示";
    if(title != null && title != undefined){
        if(title.indexOf("qtyInf") > -1){
            errorWindowTitle = 'qtyInf';
            var str = 'apo.qty.infraction';
            str += ' ' + arg;
            arg = str;
        }else{
            errorWindowTitle = title;
        }
    }
    var w = "350px";
    if(width != null){
        w = width + "px";
    }
    // Instantiate a Panel from markup
    if(YAHOO.example.container.errorWindow == null || YAHOO.example.container.errorWindow == undefined){
        YAHOO.example.container.errorWindow = new YAHOO.widget.Panel("errorMessagePanel", {
                width: w,
                fixedcenter: true,
                close: true,
                draggable: false,
                zindex:4,
                modal: true,
                visible: false
            }
        );
    }
    YAHOO.example.container.errorWindow.render();
    YAHOO.example.container.errorWindow.setHeader(errorWindowTitle);
    YAHOO.example.container.errorWindow.setBody(arg);
    YAHOO.example.container.errorWindow.render();
    YAHOO.example.container.errorWindow.show();
}
function setupErrorMessages(){
    
}
/**
*   Checks if an element has a specific class
*/
function hasClass(ele,cls) {
    return ele.className.match(new RegExp('(\\s|^)'+cls+'(\\s|$)'));
}
/**
*   adds the specified class to an element
*/
function addClass(ele,cls) {
    if (!this.hasClass(ele,cls)) ele.className += " "+cls;
}
/**
*   removes the specified class from an element
*/
function removeClass(ele,cls) {
    if (hasClass(ele,cls)) {
        var reg = new RegExp('(\\s|^)'+cls+'(\\s|$)');
        ele.className=ele.className.replace(reg,' ');
    }
}
/**
*   removes a specific class from all td elements
*/
function removeClassFromAllElements(arg){
    var doc = document.getElementsByTagName('td');
    for (var i = 0; i < doc.length; i++){
       //Do Work on doc[i], this sets the border of the Div black
       removeClass(doc[i], arg);
    }
    var selects = document.getElementsByTagName('select');
    for (var i = 0; i < selects.length; i++){
       //Do Work on selects[i], this sets the border of the Div black
       removeClass(selects[i], arg);
    }
}

</script>



<script src="/shop/jsp/onlineServices/shop/inc/cartwidget.js?v=2015-07-14"></script>






<script type="text/javascript">

YAHOO.util.Event.onContentReady("usanaNavBar", function () {

    var oMenuBar = new YAHOO.widget.MenuBar("usanaNavBar", {
        autosubmenudisplay: true,
        constraintoviewport: false,
        maxheight: 1500,
        minscrollheight: 1000,
        iframe:false,
        hidedelay: 250,
        shadow:false,
        lazyload: true });


    oMenuBar.render();
});


var var1 = null;
var var2 = null;
var var3 = null;
var firstTime = "false";
var firstTimeDialog = null;

function checkFirstTimeRetail(param1, param2, param3){

    if (firstTime=='true'){
        var1 = param1;
        var2 = param2;
        var3 = param3;
        firstTimeDialog.show()
    } else {
        updateProductTotal(param1,param2,param3);
    }
}


function setFirstTime() {
    var handleSuccess2 = function(o) {
        firstTime = "false";
        updateProductTotal(var1,var2,var3);
    }
    var handleFailure2 = function(o) {

    }
    var callback2 =
    {
        success:handleSuccess2,
        failure: handleFailure2,
        argument: { foo:"foo", bar:"bar" }
    };
    var url = CONTEXT_PATH+"/jsp/onlineServices/shop/setFirstTime.jsp";
    var request = YAHOO.util.Connect.asyncRequest('post', url, callback2);

}

function updateProductTotal(itemId, postfix, isProductInfo) {
    if(typeof(window['pageDefinedUpdateTotal']) != "undefined"){
        pageDefinedUpdateTotal(itemId, postfix, isProductInfo);
    }else{
        if (''.indexOf(itemId) > -1 || ''.indexOf(itemId + '.') > -1){
            if (false){
                checkSocialFive(itemId,0, postfix, isProductInfo)
            } else if(false){
                showNotEligible();
            }else{
                showAddNew(itemId,0, postfix, isProductInfo);
            }

        } else {
            updateProductsDefault(itemId, postfix, isProductInfo);
        }
    }
}

function showNotEligible(){
    var msg = 'We are happy that you want to renew your subscription to USANA&#39;s Social Pro. Program rules dictate that you will not be able to renew for another year until the final 6 weeks of your current subscription.<br>';

    $("#jqueryDialog").html(msg);
    $("#jqueryDialog").dialog({autoOpen: false});
    $("#jqueryDialog").dialog('option', 'title','You are already subscribed to Social Pro.                ' );
    $("#jqueryDialog").dialog('option', 'minWidth',500);
    $("#jqueryDialog").dialog("open");


}
function checkSocialFive(itemId, pageId, postfix, isProductInfo){
    var link = getSocialFiveAddLink(itemId, pageId, postfix, isProductInfo);

    var msg = 'The USANA Social Pro subscription is for one year. Do you wish to extend your subscription today?<br>';

    msg += '<br><input class="button2" type="button" onclick="' + link + '$(\'#jqueryDialog\').dialog(\'close\');" value="Yes! Add to Cart.">';
    msg += '<br><input class="button2" type="button" onclick="$(\'#jqueryDialog\').dialog(\'close\');" value="Cancel">'

    $("#jqueryDialog").dialog({autoOpen: false});
    $("#jqueryDialog").dialog('option', 'title','Extend your Social Pro service?' );
    $("#jqueryDialog").dialog('option', 'minWidth',500);
    $("#jqueryDialog").dialog("open");
    $("#jqueryDialog").html(msg);
    return false;

}

function showAddNew(itemId, pageId, postfix, isProductInfo){
    var msg = 'One year of Social Pro Service<br>';
    var link = getSocialFiveAddLink(itemId, pageId, postfix, isProductInfo);

    msg += '<br><input class="button2" type="button" onclick="' + link + '$(\'#jqueryDialog\').dialog(\'close\');" value="Add to Cart">';
    msg += '<br><input class="button2" type="button" onclick="$(\'#jqueryDialog\').dialog(\'close\');" value="Cancel">'

    $("#jqueryDialog").dialog({autoOpen: false});
    $("#jqueryDialog").dialog('option', 'title','USANA Social Pro' );
    $("#jqueryDialog").dialog('option', 'minWidth',500);
    $("#jqueryDialog").dialog("open");
    $("#jqueryDialog").html(msg);
    return false;
}

function getSocialFiveAddLink(itemId, pageId,postfix, isProductInfo){
    var link = 'javascript:';
    switch(pageId){
        case 0:
            link += 'updateProductsDefault(\'' + itemId + '\',\'' + postfix + '\',\'' + isProductInfo + '\');';
            break;
        case 1:
            link += 'pageDefinedUpdate(\'' + itemId + '\',\''  + 1 +'\',\'' + postfix + '\');';
        case 1:
            break;
        case 2:
             link += 'addItem(\'' + itemId + '\');';
             break;
        case 3:
             link += 'quickAdd();';
            break;
        default:
            link += 'updateProductsDefault(\'' + itemId + '\',\'' + postfix + '\',\'' + isProductInfo + '\');';
    }

    return link;
}

function updateApoOrderSummary(){
    var handleSuccess = function(o){
        var resp = o.responseText;
        var split = resp.split("~");

        var totCount = split[0];
        var totVol = split[1];

        document.getElementById("apoTotCountApoShop").innerHTML = totCount;
        if (document.getElementById("totVolApoShop") != null){
            document.getElementById("totVolApoShop").innerHTML = totVol;
        }

    };
    var handleFailure = function(o){


    };
    var callback = {
        success:handleSuccess,
        failure:handleFailure
    };

    var url = "/shop/cart/GetQantityVolumeFromCart";
    var request = YAHOO.util.Connect.asyncRequest('POST', url, callback);
}

function updateProductsDefault(itemId, postfix, isProductInfo){

    var quantity = -1;
    var quantityTextBox = document.getElementById("quantity" + itemId + postfix);
    if (quantityTextBox != null) {
        quantity = quantityTextBox.value;
    }

    var handleSuccess = function(o) {

        if (o.responseText !== undefined) {
            var x = document.getElementById("productAdding" + itemId + postfix);
            if(o.responseText.indexOf('##error') > -1){
                sessionTimeout();
            }else if(o.responseText.indexOf("quantityInfraction") > -1){
                displaySuccess("saved" + itemId + postfix);
                checkCheckoutButton();
                var cart = document.getElementById("cartWidget_c");
                if(cart != undefined && cart.style.visibility == "visible"){
                    YAHOO.USANA.cartWidget.showCart();
                }
            }else if(o.responseText.indexOf('{"errors":') > -1){
                var oData = "";
                try {
                    oData = YAHOO.lang.JSON.parse(o.responseText.replace(/^\s+|\s+$/g,""));
                } catch(e) {
                    oData = undefined;
                }
                if(oData != undefined){
                    if (oData.errors.length > 1){
                        var msg = "<ul>";
                        for(i=0;i<oData.errors.length;i++){
                            msg +="<li>"+oData.errors[i]+"</li>";
                        }
                        msg+= "</ul>";
                    }  else {
                        msg = oData.errors[0];
                    }

                    $("#jqueryDialog").html(msg);
                    $("#jqueryDialog").dialog({autoOpen: false});
                    $("#jqueryDialog").dialog('option', 'title','订购数量超过最高限额' );
                    $("#jqueryDialog").dialog("open");

                }
            }else if(o.responseText.indexOf('quantityInfraction') > -1){
                showErrorWindow('TBD', '未加入产品');
                x.innerHTML = o.responseText;
                displaySuccess("saved" + itemId + postfix);
                checkCheckoutButton();

                var cart = document.getElementById("cartWidget_c");
                if(cart != undefined && cart.style.visibility == "visible"){
                    YAHOO.USANA.cartWidget.showCart();
                }
            }else if(o.responseText.indexOf('volumeLimitExceeded') > -1){
                showErrorWindow('shop.volume.limit.exceeded', 'shop.volume.limit.exceeded.title');
                x.innerHTML = o.responseText;
                checkCheckoutButton();

                var cart = document.getElementById("cartWidget_c");
                if(cart != undefined && cart.style.visibility == "visible"){
                    YAHOO.USANA.cartWidget.showCart();
                }
            }else{
                x.innerHTML = o.responseText;

                checkCheckoutButton();
                var checkingQuantityExceeded = document.getElementById('quantityExceeded'+itemId+postfix);
                var volumeLimitExceeded = document.getElementById('volumeLimitExceeded');

                if(checkingQuantityExceeded != null && checkingQuantityExceeded != undefined){
                    showErrorWindow('您已超过了该产品的最高数量：{0}:<br>' + '单一订单中本产品的最高数量限制为 : ' + checkingQuantityExceeded.value, '产品数量上限');
                }else{
                    showToast( itemId + ' added to cart')
                }

                var cart = document.getElementById("cartWidget_c");
                if(cart != undefined && cart.style.visibility == "visible"){
                    YAHOO.USANA.cartWidget.showCart();
                }
                if(document.getElementById("checkoutButtonContentApo") != null){
                    if(typeof(window['updateApoOrderSummary']) != "undefined"){
                        updateApoOrderSummary();
                    }
                }
            }
        }
    };

    var handleFailure = function(o) {
        if (o.responseText !== undefined) {
            //                    div.innerHTML = "<li>Transaction id: " + o.tId + "</li>";
            //                    div.innerHTML += "<li>HTTP status: " + o.status + "</li>";
            //                    div.innerHTML += "<li>Status code message: " + o.statusText + "</li>";
        }
    }

    var callback =
    {
        success:handleSuccess,
        failure: handleFailure,
        argument: { foo:"foo", bar:"bar" }
    };

    var url = CONTEXT_PATH+"/cart/ProductCubeAjax?itemId=" + itemId + "&quantity=" + quantity + "&addingProduct=1&postfix="+postfix;

    var request = YAHOO.util.Connect.asyncRequest('post', url, callback);
}
function updateProductTotalRec(itemId, postfix, isProductInfo) {

    var quantity = 1;

    var handleSuccess = function(o) {

        if (o.responseText !== undefined) {

            var x = document.getElementById("productAddingRec" + itemId + postfix);
            if(o.responseText.indexOf('##error') > -1){
                sessionTimeout();

            }else if(o.responseText.indexOf('volumeLimitExceeded') > -1){
                showErrorWindow('shop.volume.limit.exceeded', 'shop.volume.limit.exceeded.title');
                x.innerHTML = o.responseText;
                checkCheckoutButton();
                var cart = document.getElementById("cartWidget_c");
                if(cart != undefined && cart.style.visibility == "visible"){
                    YAHOO.USANA.cartWidget.showCart();
                }

            }else if(o.responseText.indexOf('quantityInfraction') > -1){
                showErrorWindow('TBD', '未加入产品');
                x.innerHTML = o.responseText;
                displaySuccess("saved" + itemId + postfix);
                checkCheckoutButton();

                var cart = document.getElementById("cartWidget_c");
                if(cart != undefined && cart.style.visibility == "visible"){
                    YAHOO.USANA.cartWidget.showCart();
                }
            }else if(o.responseText.indexOf('{"errors":') > -1){
                var oData = "";
                try {
                    oData = YAHOO.lang.JSON.parse(o.responseText.replace(/^\s+|\s+$/g,""));
                } catch(e) {
                    oData = undefined;
                }
                if(oData != undefined){
                    var msg = "";
                    for(i=0;i<oData.errors.length;i++){
                        msg += oData.errors[i]+"<br>";
                    }
                    showErrorWindow(msg);
                }
            }else{
                x.innerHTML = '<img src="/shop/jsp/onlineServices/shop/images/checkmark.png">';
                var hide =    "productAddingRec" + itemId + postfix
                displaySuccess(hide);
                checkCheckoutButton();
                var cart = document.getElementById("cartWidget_c");
                if(cart != undefined && cart.style.visibility == "visible"){
                    YAHOO.USANA.cartWidget.showCart();
                }
                if(document.getElementById("checkoutButtonContentApo") != null){
                    if(typeof(window['updateApoOrderSummary']) != "undefined"){
                        updateApoOrderSummary();
                    }
                }
            }
        }
    };
    var handleFailure = function(o) {
        if (o.responseText !== undefined) {
        }
    };

    var callback =
    {
        success:handleSuccess,
        failure: handleFailure,
        argument: { foo:"foo", bar:"bar" }
    };
    var url = CONTEXT_PATH+"/cart/ProductCubeAjax?itemId=" + itemId + "&quantity=" + quantity + "&addingProduct=1&postfix="+postfix;
    var request = YAHOO.util.Connect.asyncRequest('post', url, callback);

}
function trim(stringToTrim) {
    return stringToTrim.replace(/^\s+|\s+$/g,'');
}

function checkCheckoutButton() {
    if (document.getElementById("checkoutButton") != undefined || document.getElementById("orderSummaryTotals") != undefined) {
        var handleSuccess2 = function(o) {
            var m;
            if (o.responseText !== undefined) {
                var shoppingCartButton = document.getElementById("checkoutButtonContent");
                var smallShoppingWidget = document.getElementById("smallShoppingWidget");
                if ('true' == YAHOO.USANA.translations.cartWidget.SHOWCARTQUANTITY) {
                    var messages = [];
                    var val1 = o.responseText.replace(/\r|\n/g, '');
                    val1 = trim(val1);

                    try {
                        messages = YAHOO.lang.JSON.parse(val1);
                        m = messages[0];
                    } catch (x) {
                        alert(" ProductAjaxCube JSON Parse failed!");
                        return;
                    }
                    if(shoppingCartButton != null && shoppingCartButton != undefined){
                        shoppingCartButton.innerHTML = '';
                        if(smallShoppingWidget != null && smallShoppingWidget != undefined){
                            smallShoppingWidget.innerHTML = '';
                        }
                        var text = document.createElement('label');
                        text.innerHTML = '数量'+ "&nbsp;" + m.itemCount  + " "
                                + '<br>金额'+ "&nbsp;" + m.cartTotal;
                        if('R' != 'R' && 'R' != 'RC' && 'R' != 'EM' && 'R' != 'UB'){
                            text.innerHTML += '<br>分数'+ " " + m.volumeTotal;
                        }
                        var text2 = document.createElement('div');
                        text2.setAttribute('class','cart_height');
                        var smallText =   "(" + m.itemCount  + ") " + m.cartTotal  + "&nbsp; ";
                        if('R' != 'R' && 'R' != 'RC' && 'R' != 'EM' && 'R' != 'UB'){
                            smallText += '分数'+ "&nbsp;" + m.volumeTotal;
                        }
                        text2.innerHTML = '<img class="small_cart_icon" src="/media/Shop/images/cart_btn_00.png" alt="">' + smallText+ "";
                        shoppingCartButton.innerHTML = '';
                        shoppingCartButton.appendChild(text);
                        if(smallShoppingWidget != null && smallShoppingWidget != undefined){
                            smallShoppingWidget.innerHTML = '';
                            smallShoppingWidget.appendChild(text2)
                        }
                    }

                    var orderSummaryTotals = document.getElementById("orderSummaryTotals");
                    if(orderSummaryTotals != null && orderSummaryTotals != undefined){
                        var orderSummaryTotalsInnerHtml = '<span>数量:&nbsp;' + m.itemCount;
                        if('0' == '1'){
                            orderSummaryTotalsInnerHtml += ', 分数:&nbsp;' + m.volumeTotal;
                        }
                        orderSummaryTotalsInnerHtml += ' </span>';
                        orderSummaryTotals.innerHTML = orderSummaryTotalsInnerHtml;
                    }
                }else{
                    if(shoppingCartButton != null && shoppingCartButton != undefined){
                        shoppingCartButton.innerHTML = '';
                        shoppingCartButton.innerHTML = YAHOO.USANA.translations.cartWidget.TITLE;
                        if(shoppingCartButton.className.indexOf('oldCartButton') < 0){
                            shoppingCartButton.className += "oldCartButton";
                        }
                        if(smallShoppingWidget != null && smallShoppingWidget != undefined){
                            smallShoppingWidget.innerHTML = '';
                            smallShoppingWidget.innerHTML = '<img class="small_cart_icon" src="/media/Shop/images/cart_btn_00.png" alt="">' + YAHOO.USANA.translations.cartWidget.TITLE;
                        }
                    }
                }

                var checkoutButton = document.getElementById("checkoutButton");
                YAHOO.util.Dom.removeClass(checkoutButton, "hiddenCheckout");
                if (''=='true') {
                    renderToNav = 1;
                    YAHOO.USANA.cartWidget.showCart();
                }

            }
        };

        var handleSuccess = function(o) {
            if (o.responseText !== undefined) {
                var x = document.getElementById("checkoutButton");
                if(o.responseText.indexOf('##error') > -1){
                    sessionTimeout();
                }else{
                    if(o.responseText.indexOf('showCart') > -1){
                        var currentTime = new Date();
                        var time = currentTime.getTime();

                        var url = CONTEXT_PATH+"/cart/ProductCubeAjax?cartTotals=1&t=" + time;
                        var request = YAHOO.util.Connect.asyncRequest('post', url, callback2);

                    }else{
                        var checkoutButton = document.getElementById("checkoutButton");
                        YAHOO.util.Dom.addClass(checkoutButton, "hiddenCheckout");
                    }
                }
            }
        }

        var handleFailure = function(o) {
            if (o.responseText !== undefined) {
                //                    div.innerHTML = "<li>Transaction id: " + o.tId + "</li>";
                //                    div.innerHTML += "<li>HTTP status: " + o.status + "</li>";
                //                    div.innerHTML += "<li>Status code message: " + o.statusText + "</li>";
            }
        }

        var callback =
        {
            success:handleSuccess,
            failure: handleFailure,
            argument: { foo:"foo", bar:"bar" }
        };
        var callback2 =
        {
            success:handleSuccess2,
            failure: handleFailure,
            argument: { foo:"foo", bar:"bar" }
        };
        var currentTime = new Date();
        var time = currentTime.getTime();

        var url = CONTEXT_PATH+"/cart/ProductCubeAjax?checkCheckoutButton=1&ts=" + time;
        var request = YAHOO.util.Connect.asyncRequest('post', url, callback);
    }
}
function displaySuccess(arg) {
    var lab = document.getElementById(arg);
    lab.style.display = '';
    setTimeout("hide_label('" + arg + "')", 2000);
}
function hide_label(arg) {
    var lab = document.getElementById(arg);
    if(lab != null){
        lab.style.display = 'none';
    }
}
function isNum(str,event,itemId, postfix){
    var keycode;
    if(window.event){
        keycode=event.keyCode;
    }else if(event.which){
        keycode=event.which;
    }
    var keyChar = String.fromCharCode(keycode);
    var regex = /\b\d/;

    if(13 == keycode){
        updateProductTotal(itemId, postfix);
    }
    if(regex.test(keyChar) ||8==keycode || undefined == keycode){
        return true;
    }else{
        return false;
    }
}

function disableForm(theform, enable) {
    if(theform == null || theform == undefined){
        theform = document.forms[0];
    }
    // to use this function, add  onSubmit="return disableForm(this)" to the opening FORM tag
    // or in case of a button/onclick, use onClick=disableForm(this.form); window.url....

    if (document.all || document.getElementById) {
        for (i = 0; i < theform.length; i++) {
            var tempobj = theform.elements[i];
            var tempobjtype = tempobj.type.toLowerCase();
            if (tempobjtype == "submit" || tempobjtype == "reset" || tempobjtype == "button")
                if(enable == null || enable == undefined || !enable){
                    tempobj.disabled = true;
                }else if(enable){
                    tempobj.disabled = false;
                }
        }
        return true;
    } else {
        return true;
    }
}

function sessionTimeout(){
    window.location = '/shop/cart/U2DRedirectAction?hour=true&currentUri=' + document.URL;

}
YAHOO.util.Event.onDOMReady(function(){
    var timeout = setTimeout("sessionTimeout()",61*60*1000);   // one hour
    if(!(YAHOO.env.ua.ie >= 7 || YAHOO.env.ua.gecko >= 1.9 || YAHOO.env.ua.webkit >= 530 || navigator.userAgent.match(/Trident\/7\./))){
        YAHOO.util.Dom.removeClass('updateBrwsMsg','ie6_msg');
    }

});



YAHOO.util.Event.addListener(window, "load", init);

function init() {
    var handleYesFirst = function() {
        setFirstTime();

        this.hide()
    };
    var handleEnrollFirst = function() {
        window.location = '/shop/enroll/os2Launch?sponsorId=&tagCountry=US&tagLang=ENU&UNI_TODAY=on';

        this.hide();
    };

    var msg = "";

    firstTimeDialog = new YAHOO.widget.SimpleDialog("simpledialog1",
            { width: "400px",
                height: "200px",
                fixedcenter: true,
                visible: false,
                draggable: false,
                modal: true,
                close: true,
                text: msg,
                icon: YAHOO.widget.SimpleDialog.ICON_HELP,
                constraintoviewport: true,
                buttons: [ { text:"确定", handler:handleYesFirst, isDefault:true },
                    { text:"shop.enroll",  handler:handleEnrollFirst } ]
            } );
    firstTimeDialog.setHeader('ha.us.only');

    firstTimeDialog.render("firstTimeContainer");


}

YAHOO.namespace("example.container");
YAHOO.example.container.dialogWindow;
YAHOO.example.container.freightWindow;

function showDialogWindow(arg, title, showCheckoutButtons) {
    // Instantiate a Panel from markup
    if(YAHOO.example.container.dialogWindow == null || YAHOO.example.container.dialogWindow == undefined){
        YAHOO.example.container.dialogWindow = new YAHOO.widget.SimpleDialog("dialogMessagePanel", {
                    width: "350px",
                    fixedcenter: true,
                    close: true,
                    draggable: false,
                    zindex:4,
                    modal: true,
                    visible: false
                }
        );
    }
    YAHOO.example.container.dialogWindow.render();
    if (title){
        YAHOO.example.container.dialogWindow.setHeader(title);
    } else {
        YAHOO.example.container.dialogWindow.setHeader("提示");
    }

    YAHOO.example.container.dialogWindow.setBody(arg);

    if ('true'==showCheckoutButtons)  {
        var myButtons = [
            { text:"结账",
                handler:handleContinue,
                isDefault:true },
            { text:"继续购物", handler:handleCancel,
                isDefault:true }
        ];
        YAHOO.example.container.dialogWindow.cfg.queueProperty("buttons", myButtons);
    } else {
        YAHOO.example.container.dialogWindow.cfg.queueProperty("buttons", null);
    }
    YAHOO.example.container.dialogWindow.render();
    YAHOO.example.container.dialogWindow.show();
}


function handleContinue() {

    window.location = '/shop/checkout/SendToCorrectCheckout.action?noSave';
}

function handleCancel() {
    YAHOO.example.container.dialogWindow.hide();
}

function showFreightCalc(arg) {
    if (YAHOO.example.container.freightWindow == null || YAHOO.example.container.freightWindow == undefined) {
        YAHOO.example.container.freightWindow = new YAHOO.widget.SimpleDialog("freightMessagePanel", {
                    width: "600px",
                    fixedcenter: true,
                    close: true,
                    draggable: false,
                    zindex:4,
                    modal: false,
                    visible: false
                }
        );
    }

    YAHOO.example.container.freightWindow.setHeader("运费估价");
    var successFreight = function(o) {

        if (o.responseText !== undefined) {
            YAHOO.example.container.freightWindow.setBody(o.responseText);

        }
    }

    var failureFreight = function(o) {
        if (o.responseText !== undefined) {
            alert('error')
        }
    }

    var callbackFreight =
    {
        success:successFreight,
        failure: failureFreight,
        argument: { foo:"foo", bar:"bar" }
    };
    var url = CONTEXT_PATH+"/cart/FreightCalc.action";
    if(typeof(arg) !== 'undefined')   url += "?postalCode=" + arg ;
    YAHOO.example.container.freightWindow.setBody('<div style="height:300px;"><center><img src="/shop/jsp/shop/images/loading.gif"></center></div>');
    YAHOO.example.container.freightWindow.cfg.queueProperty("buttons", null);
    YAHOO.example.container.freightWindow.render();
    YAHOO.example.container.freightWindow.show();

    var freight = YAHOO.util.Connect.asyncRequest('post', url, callbackFreight);

}

function reloadFreightCalc() {
    YAHOO.example.container.freightWindow.hide();
    var postalCode = document.freight.postalCode.value;
    showFreightCalc(postalCode)
}
function closeFreight() {
    YAHOO.example.container.freightWindow.hide();
    return false;
}
function checkEnter(event) {
    if (event.keyCode == 13) {
        reloadFreightCalc()
    }
}

function triedToRemoveBds(){
    // Instantiate a Panel from markup
    if(YAHOO.example.container.bdsRemovalMessagePanel == null || YAHOO.example.container.bdsRemovalMessagePanel == undefined){
        YAHOO.example.container.bdsRemovalMessagePanel = new YAHOO.widget.Panel("errorMessagePanel", {
                    width: "350px",
                    fixedcenter: true,
                    close: true,
                    draggable: false,
                    zindex:4,
                    modal: true,
                    visible: false
                }
        );
    }

    var bodyText = YAHOO.USANA.translations.cartWidget.TRIED_TO_REMOVE_BDS_MESSAGE;
    bodyText += '<br><br>';
    bodyText += '<center>';
    bodyText += '<button onclick=\"javascript:goBackToEnrollProducts()\" id=\"goBackToEnrollProducts\" class=\"nonActionButton\" type=\"button\">取代</button>';
    bodyText += '&nbsp;&nbsp;';
    bodyText += '<button onclick=\"javascript:YAHOO.example.container.bdsRemovalMessagePanel.hide()\" id=\"closeBdsRemovalMessagePanel\" class=\"nonActionButton\" type=\"button\">继续</button>';
    bodyText += '</center>';
    YAHOO.example.container.bdsRemovalMessagePanel.render();
    YAHOO.example.container.bdsRemovalMessagePanel.setHeader(YAHOO.USANA.translations.cartWidget.TRIED_TO_REMOVE_BDS_TITLE);
    YAHOO.example.container.bdsRemovalMessagePanel.setBody(bodyText);
    YAHOO.example.container.bdsRemovalMessagePanel.render();
    YAHOO.example.container.bdsRemovalMessagePanel.show();
}

function goBackToEnrollProducts(){
    YAHOO.example.container.bdsRemovalMessagePanel.hide();
    window.location = CONTEXT_PATH + "/enroll/showOELookEnrollProducts";
}

function closeBdsRemovalMessagePanel(){
    YAHOO.example.container.bdsRemovalMessagePanel.close();
}

YAHOO.example.container.askQuiteOEApplicationEarlyPanel;
function askQuitOEApplicationProcess(resume){
    var panelHtml = '\u60A8\u5373\u5C06\u9000\u51FA\u5165\u4F1A\u767B\u8BB0\u7A0B\u5E8F\uFF1B\u4E00\u65E6\u9000\u51FA\uFF0C\u5219\u5C1A\u672A\u5B8C\u6210\u5165\u4F1A\u767B\u8BB0\u7684\u6240\u6709\u4FE1\u606F\u90FD\u4F1A\u88AB\u6D88\u9664\u3002<br><br>\u70B9\u51FB<strong>\u9000\u51FA<\/strong>\u4EE5\u9000\u51FA\u5165\u4F1A\u767B\u8BB0\u7A0B\u5E8F\u3002<br><br>\u70B9\u51FB<strong>\u7EE7\u7EED<\/strong>\u4EE5\u7EE7\u7EED\u767B\u8BB0\u5165\u4F1A\u3002';
    if(resume != null && resume != undefined){
        panelHtml +='<br><br>';
        panelHtml += '\u5728\u7EBF\u7533\u8BF7\u7A0B\u5E8F\u7684\u4E2A\u4EBA\u4FE1\u606F\u5DF2\u4FDD\u5B58\u3002<br><br>\u73B0\u5728\u9000\u51FA\uFF0C\u60A8\u5C1A\u672A\u5B8C\u6210\u7684\u7B2C\u4E00\u5F20\u8BA2\u5355\u548C\u81EA\u52A8\u8BA2\u8D27\u5C31\u4F1A\u88AB\u6D88\u9664\u3002<br><br>\u5982\u679C\u60A8\u9009\u62E9\u9000\u51FA\uFF0C\u53EF\u4F7F\u7528\u53D1\u9001\u5230\u60A8\u90AE\u7BB1\u4E2D\u7684\u4E2A\u4EBA\u7F16\u53F7\u548C\u5BC6\u7801\u767B\u5F55today.baoying.com\u3002<br><br>\u767B\u5F55\u540E\uFF0C\u5373\u53EF\u91CD\u65B0\u8FDB\u884C\u5728\u7EBF\u7533\u8BF7\u53CA\u8BA2\u8D2D\u4EA7\u54C1\u3002';
    }
    panelHtml += '<br><br>';
    panelHtml += "<center>";
    panelHtml += "<button type=\"button\" onclick=\"javascript:confirmQuitOEApplicationProcess()\">\u9000\u51FA</button>";
    panelHtml += " ";
    panelHtml += "<button type=\"button\" onclick=\"javascript:cancelQuitOEApplicationProcess()\">\u7EE7\u7EED</button>";
    panelHtml += "</center>";

    if(YAHOO.example.container.askQuiteOEApplicationEarlyPanel == null || YAHOO.example.container.askQuiteOEApplicationEarlyPanel == undefined){
        YAHOO.example.container.askQuiteOEApplicationEarlyPanel = new YAHOO.widget.Panel("askQuiteOEApplicationEarlyPanel", {
                    width: "500px",
                    fixedcenter: true,
                    close: true,
                    draggable: false,
                    zindex:4,
                    modal: true,
                    visible: false
                }
        );
    }
    YAHOO.example.container.askQuiteOEApplicationEarlyPanel.render();
    YAHOO.example.container.askQuiteOEApplicationEarlyPanel.setHeader('\u8981\u9000\u51FA\u5165\u4F1A\u7533\u8BF7\u5417\uFF1F');
    YAHOO.example.container.askQuiteOEApplicationEarlyPanel.setBody(panelHtml);
    YAHOO.example.container.askQuiteOEApplicationEarlyPanel.render();
    YAHOO.example.container.askQuiteOEApplicationEarlyPanel.show();
}

function confirmQuitOEApplicationProcess(){
    YAHOO.example.container.askQuiteOEApplicationEarlyPanel.hide();
    var country='';
    if (country==null||country=='')country='US';
    window.location = "quitOnlineEnrollment?tagCountry="+country;
}

function cancelQuitOEApplicationProcess(){
    YAHOO.example.container.askQuiteOEApplicationEarlyPanel.hide();
}

</script>




















  
    
    
      
    
  
  














<script type="text/javascript">
function showChangesWillBeLostPanel() {
        // Instantiate a Panel from markup
        if(YAHOO.example.container.dialogWindow == null || YAHOO.example.container.dialogWindow == undefined){
            YAHOO.example.container.dialogWindow = new YAHOO.widget.Panel("dialogMessagePanel", {
                    width: "350px",
                    fixedcenter: true,
                    close: true,
                    draggable: false,
                    zindex:4,
                    modal: true,
                    visible: false
                }
            );
        }

        var panelHtml = "<div style=\"text-align:left;\">";
        if ("false"=="true"){
            panelHtml += "Are you sure you want to exit? <br><br>Recent changes will be lost.<br><br>Click on OK to exit, click on Cancel to continue with your order.";

        } else {
            panelHtml += "\u60A8\u786E\u5B9A\u8981\u9000\u51FA\u81EA\u52A8\u8BA2\u8D27\u7A0B\u5E8F\u5417\uFF1F <br><br>\u5982\u679C\u60A8\u672A\u50A8\u5B58\uFF0C\u5219\u521A\u521A\u6240\u505A\u7684\u53D8\u66F4\u5C06\u4F1A\u9057\u5931\u3002<br><br>\u70B9\u51FB\u786E\u5B9A\u9000\u51FA\uFF0C\u6216\u70B9\u51FB\u53D6\u6D88\u7EE7\u7EED\u60A8\u7684\u81EA\u52A8\u8BA2\u8D27\u3002";
        }
        panelHtml += "</div>";
        panelHtml += "<div style=\"text-align:center; padding-top:10px;\">";
        panelHtml += "<input type=\"button\" value=\"确定\" onclick=\"javascript:handleSuccessFromJellyBean()\" class=\"clickable\">&nbsp;<input type=\"button\" value=\"取消\" onclick=\"javascript:handleCancelFromJellyBean()\" class=\"clickable\">";        
        panelHtml += "</div>";

        
        YAHOO.example.container.dialogWindow.render();
        if ("false"=="true"){
            YAHOO.example.container.dialogWindow.setHeader('Exiting order');
        } else {
            YAHOO.example.container.dialogWindow.setHeader('退出自动订货处理');
        }
        YAHOO.example.container.dialogWindow.setBody(panelHtml);
        YAHOO.example.container.dialogWindow.render();
        YAHOO.example.container.dialogWindow.show();
    }
    
    function handleCancelFromJellyBean(){
        YAHOO.example.container.dialogWindow.hide();
    }
    function handleSuccessFromJellyBean(){
        YAHOO.example.container.dialogWindow.hide();
        for(var i = 0; i < document.forms.length; i++){
            disableForm(document.forms[i]);
        }
        window.location = "";
    }
YAHOO.util.Event.onDOMReady(function(){
            if('category' != ''){
                //updateProgressBarForOE();
            }
        });

        function updateProgressBarForOE(){
            var handleSuccess = function(o){
                if(o.responseText != undefined){
                    if(o.responseText.indexOf('##error') > -1){
                        sessionTimeout();
                    }else if(o.responseText.indexOf('##NO_PAGE_ID') < 0){
                        var returnedJson = o.responseText;
                        var jsonObject = eval('(' + returnedJson + ')');
                        var progressBarNodes = jsonObject.progressBarNodes;
                        var additionalData = jsonObject.additionalData;

                        var primaryHighlightedIndex = -1;
                        var primaryFirstIndex = -1;
                        var primaryLastIndex = -1;
                        var countOnPrimaryLevel = -1;
                        var showingAnyPrimary = 0;
                        for(var k = 0; k < progressBarNodes.length; k++){
                            if(progressBarNodes[k].showPrimaryLevel == '1'){
                                showingAnyPrimary = 1;
                                if(primaryFirstIndex == -1){
                                    primaryFirstIndex = k;
                                }
                                countOnPrimaryLevel++;
                                if(primaryHighlightedIndex == -1 && progressBarNodes[k].highlighted == '1'){
                                    primaryHighlightedIndex = k;
                                }
                                primaryLastIndex = k;
                            }
                        }
                        var secondaryHighlightedIndex = -1;
                        var secondaryFirstIndex = -1;
                        var secondaryLastIndex = -1;
                        var countOnSecondaryLevel = -1;
                        var hasSecondary = -1;
                        var showingAnySecondary = 0;
                        for(var l = 0; l < progressBarNodes.length; l++){
                            if(progressBarNodes[l].showSecondaryLevel == '1'){
                                showingAnyPrimary = 1;
                                hasSecondary = 1;
                                if(secondaryFirstIndex == -1){
                                    secondaryFirstIndex = l;
                                }
                                countOnSecondaryLevel++;
                                if(secondaryHighlightedIndex == -1 && progressBarNodes[l].highlighted == '1'){
                                    secondaryHighlightedIndex = l;
                                }
                                secondaryLastIndex = l;
                            }
                        }
                        var innerHtml = '';
                        if(showingAnyPrimary != 0 || showingAnySecondary != 0){
                            if(additionalData.progressBarHeaderText != null && additionalData.progressBarHeaderText != undefined && additionalData.progressBarHeaderText != ''){
                                innerHtml += '<div class=\"progressBarHeader\"><span class=\"progressBarHeaderText\">'+additionalData.progressBarHeaderText+'</span></div>';
                            }
                            innerHtml += '<div id=\"progressBar\" class=\"showInlineBlock fl\">';
                            innerHtml += '<ul>';
                            var primaryCount = 0;
                            for(var i = 0; i < progressBarNodes.length; i++){
                                if(progressBarNodes[i].showPrimaryLevel == '1'){
                                    var classesToAdd = '';
                                    if(i == primaryFirstIndex){
                                        classesToAdd += ' first ';
                                    }
                                    if(i == primaryLastIndex){
                                        classesToAdd += ' last ';
                                    }
                                    if(i < primaryHighlightedIndex){
                                        classesToAdd += ' past ';
                                    }else if(i == primaryHighlightedIndex){
                                        classesToAdd += ' active ';
                                    }
                                    innerHtml += '<li class=\"'+classesToAdd+'\"><div>'+progressBarNodes[i].translated+'</div></li>';
                                    primaryCount++;
                                }
                            }
                            innerHtml += '</ul>';
                            innerHtml += '</div>';
                            if(additionalData.showCheckoutButton == '1'){
                                innerHtml += '<button name=\"sendToCheckout\" id=\"sendToCheckout\" class=\"actionButton showInlineBlock floatRight\" onclick=\"'+additionalData.checkoutButtonAction+'\">'+additionalData.checkoutButtonTranslation+'</button>';
                            }
                            if(hasSecondary == 1){
                                innerHtml += '<div id=\"subProgressBar\" style=\"\">';
                                innerHtml += '<h2>'+additionalData.secondaryTranslation+'</h2>';
                                innerHtml += '<ul>';

                                for(var j = 0; j < progressBarNodes.length; j++){
                                    if(progressBarNodes[j].showSecondaryLevel == '1'){
                                        var classesToAddToSecondary = '';
                                        if(j == secondaryHighlightedIndex){
                                            classesToAddToSecondary += ' active ';
                                        }
                                        innerHtml += '<li class=\"'+classesToAddToSecondary+'\"><div>'+progressBarNodes[j].translated+'</div></li>';
                                    }
                                }
                                innerHtml += '</ul>';
                                innerHtml += '</div>';
                            }else{
                                innerHtml += '<br class=\"clearAll\">';
                            }

                            if(additionalData.showInstructionLabel == '1' || additionalData.showLinkOnRightSide == '1'){
                                innerHtml += '<div id=\"progressBarBottomLine\" >';
                            }

                            if(additionalData.showInstructionLabel == '1'){
                                innerHtml += '<div class=\"showInlineBlock fl\" id=\"progressBarInstructionLine\">'+additionalData.instructionLabelTranslation+'</div>';
                            }

                            if(additionalData.showLinkOnRightSide == '1'){
                                innerHtml += '<div class=\"showInlineBlock fr oeApoNoThanks\"><a href=\"'+additionalData.linkOnRightSideAction+'\" id=\"progressBarQuitApoLink\">'+additionalData.linkOnRightSideTranslation+'</a></div>';
                            }

                            if(additionalData.showInstructionLabel == '1' || additionalData.showLinkOnRightSide == '1'){
                                innerHtml += '</div>';
                                innerHtml += '<br class=\"clearAll\"/>';
                                //innerHtml += '<hr />';
                                innerHtml += '<div style=\"margin-top:5px;\"><img src=\"/shop/images/progressBar/shadowhr.gif\" /></div>';
                            }else{
                                innerHtml += '<br class=\"clearAll\"/>';
                            }

                            var progressBar = YAHOO.util.Dom.get('progressBarContainer');
                            if(progressBar != null && progressBar != undefined){
                                progressBar.innerHTML = innerHtml;
                                YAHOO.util.Dom.removeClass(progressBar,'hideSection');
                                YAHOO.util.Dom.addClass(progressBar,'showBlock');
                            }
                        }
                    }
                }
            };
            var handleFailure = function(o){
                if(o.responseText !== undefined){
                    alert('failure');
                }
            };
            var callback =
            {
              success:handleSuccess,
              failure:handleFailure,
              argument:["foo", "bar"]
            };

            var customerTypeFromForm = '';
            var customerTypeRadio = document.getElementsByName('enrollType_en');
            if(customerTypeRadio != null && customerTypeRadio != undefined){
                var radioLength = customerTypeRadio.length;
                for(var i = 0; i < radioLength; i++) {
                    if(customerTypeRadio[i].checked) {
                        customerTypeFromForm = customerTypeRadio[i].value;
                        break;
                    }
                }
            }
            var sUrl = "/shop/cart/UpdateProgressBar?customerTypeFromForm=" + customerTypeFromForm + "&pageId=category";
            var request = YAHOO.util.Connect.asyncRequest('POST', sUrl, callback, null);
        }
var sortIntl = function(a, b, desc){
    if (!YAHOO.lang.isValue(a)) {
       return (!YAHOO.lang.isValue(b)) ? 0 : 1;
    }
    else if (!YAHOO.lang.isValue(b)) {
       return -1;
    }
    var compState = a.getData("name").localeCompare(b.getData("name"));
    if (desc) {
       return (compState*-1)
    } else {
       return compState;
    }
};


function displayCheckMark(arg) {
    var lab = document.getElementById(arg);
    lab.style.display = '';
    setTimeout("hide_label('" + arg + "')", 2000);
}

var deleteRecommend = -1;
var deleteMhp = -1;
var deleteMySmart = -1;
var myDataTable = null;
var myColumnDefs = null;
var myDataTable2 = null;
var myColumnDefs2 = null;
var myDataTable3 = null;
var myColumnDefs3 = null;
var myDataSource3 = null;
var myDataTable4 = null;
var myColumnDefs4 = null;
var myDataSource4 = null;
var simpledialog3 = null;
var simpledialog2 = null;
var mySmartDeleteDialog = null;
var ordersButtonArray2 = [];
var ordersButtonArray3 = [];
var apoButtonArray3 = [];
var recommendButtonArray2 = [];
var recommendButtonArray3 = [];
var recommendButtonArray4 = [];
var mhpButtonArray2 = [];
var mhpButtonArray3 = [];
var mhpButtonArray4 = [];
var kitButtonArray = [];
var kitButtonArray2 = [];
var myDataTable5 = null;
var myDataTable6 = null;
var myColumnDefs5 = null;
var myColumnDefs6 = null;
var myDataSource5 = null;
var myDataSource6 = null;

function submitRecommend(id){
    document.productRecommend.surveyId.value = id;
    document.productRecommend.submit();
}

function deleteRecommendDialog(deleteId) {
    deleteRecommend = deleteId;
    simpledialog3.show()
}

function refreshMhps() {
    
}

function loadUserCustomKits(){

}

function loadUserMySmartKits() {

}


function deleteMhpDialog(deleteId) {
    deleteMhp = deleteId;
    simpledialog2.show()
}

function deleteMySmartDialog(customKitId) {
    deleteMySmart = customKitId;
    mySmartDeleteDialog.show();
}

function updateCustomKits(orderId){
    var url = "/cart/loadCustomKitsForOrder?orderId=" + orderId;

    YAHOO.util.Connect.asyncRequest("POST", url,
    {
        success: function (o) { },
        failure: function (o) { }
    });

}

function addSavedCustomKitToCart(customKitId){
    var url = "/cart/loadSavedCustomKit?customKitId=" + customKitId;

    YAHOO.util.Connect.asyncRequest("POST", url,
    {
        success: function (o) {
            displayCheckMark("addMySmartToCart_" + customKitId);
            checkCheckoutButton();
            checkCartOpen();
        },
        failure: function (o) { }
    });
}

function hideCustomKit(customKitId){
    var url = "/spring/mySmart/hideCustomKit?customKitId=" + customKitId;

    YAHOO.util.Connect.asyncRequest("POST", url,
    {
        success: function (o) {
            loadUserMySmartKits();
        },
        failure: function (o) { }
    });
}



function init5(){
    myColumnDefs5 = [
            {key:"kitName",label:"<div class='left4'>Custom Kit Name</div>",sortable:true},
            {key:"customKitDate",label:"<div class='left4'>日期</div>",formatter:YAHOO.widget.DataTable.formatDate,sortable:true},
            {key:"kitOptions",label:"<div class='right1'>选项</div>",sortable:false}
        ];
        myDataSource5 = new YAHOO.util.DataSource(YAHOO.util.Dom.get("myCustomKits"));
        myDataSource5.responseType = YAHOO.util.DataSource.TYPE_HTMLTABLE;
        myDataSource5.responseSchema = {
            fields: [{key:"kitName"},
                {key:"customKitDate", parser:"date"},
                {key:"kitOptions" }
            ]
        };

     myDataTable5 = new YAHOO.widget.DataTable("markup5", myColumnDefs5, myDataSource5,
     {
        currencyOptions:{prefix: '', decimalPlaces:, decimalSeparator:"", thousandsSeparator:""}
        , sortedBy:{key:"kitName",dir:YAHOO.widget.DataTable.CLASS_ASC}
        ,dateOptions:{format:''}
            , MSG_LOADING:"正在运行"
            , MSG_SORTASC:"点击并按从低到高顺序分类"
            , MSG_SORTDESC:"点击并按从高到低顺序分类"
            , MSG_ERROR:"数据错误。"}
            );

        var records = myDataTable5.getRecordSet();

     for (var i = 0; i < records._records.length; i++) {
        kitButtonArray[i] = "addKIt" + i;
     }

    YAHOO.example.container.tt14 = new YAHOO.widget.Tooltip("tt14", { context:kitButtonArray, text:"设定新的 MyHealthPak" });

    myDataTable5.sortColumn( myDataTable5.getColumn("kitName"), "yui-dt-desc");

}

function init6() {
    myColumnDefs6 = [
        {key:"kitName",label:"<div class='left4'>MySmartStart Kit Name</div>",sortable:true},
        {key:"mySmartKitDate",label:"<div class='left4'>日期</div>",formatter:YAHOO.widget.DataTable.formatDate,sortable:true},
        {key:"kitOptions",label:"<div class='right1'>选项</div>",sortable:false}
    ];
    myDataSource6 = new YAHOO.util.DataSource(YAHOO.util.Dom.get("mySmartKits"));
    myDataSource6.responseType = YAHOO.util.DataSource.TYPE_HTMLTABLE;
    myDataSource6.responseSchema = {
        fields: [
            {key:"kitName"},
            {key:"mySmartKitDate", parser:"date"},
            {key:"kitOptions" }
        ]
    };

    myDataTable6 = new YAHOO.widget.DataTable("markup6", myColumnDefs6, myDataSource6,
    {
        currencyOptions:{prefix: '', decimalPlaces:, decimalSeparator:"",
        thousandsSeparator:""}
        , sortedBy:{key:"kitName",dir:YAHOO.widget.DataTable.CLASS_ASC}
        ,dateOptions:{format:''}
        , MSG_LOADING:"正在运行"
        , MSG_SORTASC:"点击并按从低到高顺序分类"
        , MSG_SORTDESC:"点击并按从高到低顺序分类"
        , MSG_ERROR:"数据错误。"
    });

    var records = myDataTable6.getRecordSet();

    for (var i = 0; i < records._records.length; i++) {
        kitButtonArray[i] = "addKIt" + i;
        kitButtonArray2[i] = "deleteMySmart" + i;
    }

    YAHOO.example.container.tt15 = new YAHOO.widget.Tooltip("tt15", { context:kitButtonArray,text:"my.shopping.add.mySmart" });
    YAHOO.example.container.tt16 = new YAHOO.widget.Tooltip("tt16", { context:kitButtonArray2, text:"Delete Kit" });

    myDataTable6.sortColumn( myDataTable6.getColumn("kitName"), "yui-dt-desc");
}

function init1(){


var parseNumberFromCurrency = function(a,b,desc) {
    // Remove dollar sign and make it a float

    a = a.getData("orderTotal").replace(/[^0-9]/g, "");
    b = b.getData("orderTotal").replace(/[^0-9]/g, "");
    if (desc){
        return parseFloat(a) > parseFloat(b);
    } else {
        return parseFloat(b) > parseFloat(a);
    }

};
            var myColumnDefs = [
                {key:"orderId",label:"<div class='left1'>订单编号</div>",sortable:true},
                {key:"orderDate",label:"<div class='left1'>日期</div>",formatter:YAHOO.widget.DataTable.formatDate,sortable:true},
                {key:"orderTotal",label:"<div class='left1'>金额 </div>",sortable:true, sortOptions:{sortFunction:parseNumberFromCurrency}},
                {key:"orderVolume",label:"<div class='left1'>分数</div>",formatter:YAHOO.widget.DataTable.formatNumber,sortable:true},
                {key:"orderStatus",label:"<div class='left1'>订单状态</div>",sortable:true},
                
                {key:"orderSource",label:"<div class='left1'>订购方式</div>",sortable:true},
                {key:"orderOptions",label:"<div class='right1'>选项</div>",sortable:false}
            ];



            myDataSource = new YAHOO.util.DataSource(YAHOO.util.Dom.get("orders"));
            myDataSource.responseType = YAHOO.util.DataSource.TYPE_HTMLTABLE;
            myDataSource.responseSchema = {
                fields: [{key:"orderId", parser:"number"},
                    {key:"orderDate", parser:"date"},
                    {key:"orderTotal"},
                    {key:"orderVolume", parser:"number"},
                    {key:"orderStatus"},
                    
                    {key:"orderSource"},
                    {key:"orderOptions" }
                ]
            };

            myDataTable = new YAHOO.widget.DataTable("markup", myColumnDefs, myDataSource,
            {
                currencyOptions:{prefix: '', decimalPlaces:, decimalSeparator:"", thousandsSeparator:""}
                , sortedBy:{key:"orderId",dir:YAHOO.widget.DataTable.CLASS_ASC}
                ,dateOptions:{format:''}
                , MSG_EMPTY:"公司配送"
        , MSG_LOADING:"正在运行"
        , MSG_SORTASC:"点击并按从低到高顺序分类"
        , MSG_SORTDESC:"点击并按从高到低顺序分类"
        , MSG_ERROR:"数据错误。"
            }
                    );
           var records = myDataTable.getRecordSet();
            for (var i = 0; i < records._records.length; i++) {
                ordersButtonArray2[i] = "viewOrder" + i;
                ordersButtonArray3[i] = "addOrder" + i;

            }

            var myColumnDefs2 = [
                {key:"autoshipName",label:"<div class='left2'>摘要</div>",sortable:true},
                {key:"autoshipDate",label:"<div class='left2'>下一次出货日期</div>",formatter:YAHOO.widget.DataTable.formatDate,sortable:true},
                {key:"autoshipTotal",label:"<div class='left2'>金额 </div>",formatter:"currency",sortable:true},
                {key:"autoshipVolume",label:"<div class='left2'>分数</div>",formatter:YAHOO.widget.DataTable.formatNumber,sortable:true},
                {key:"autoshipFrequency",label:"<div class='left2'>周期</div>",sortable:true},
                {key:"autoshipOptions",label:"<div class='right1'>选项</div>",sortable:false}
            ];
            myDataSource2 = new YAHOO.util.DataSource(YAHOO.util.Dom.get("autoships"));
            myDataSource2.responseType = YAHOO.util.DataSource.TYPE_HTMLTABLE;
            myDataSource2.responseSchema = {
                fields: [
                    {key:"autoshipName"},
                    {key:"autoshipDate", parser:"date"},
                    {key:"autoshipTotal", parser:"number"},
                    {key:"autoshipVolume", parser:"number"},
                    {key:"autoshipFrequency"},
                    {key:"autoshipOptions" }
                ]
            };
            myDataTable2 = new YAHOO.widget.DataTable("markup2", myColumnDefs2, myDataSource2,
            {    currencyOptions:{prefix: '', decimalPlaces:'', decimalSeparator:'', thousandsSeparator:''} ,
                sortedBy:{key:"autoshipDate",dir:"asc"}
        , dateOptions:{format:''}
        , MSG_EMPTY:"公司配送"
        , MSG_LOADING:"正在运行"
        , MSG_SORTASC:"点击并按从低到高顺序分类"
        , MSG_SORTDESC:"点击并按从高到低顺序分类"
        , MSG_ERROR:"数据错误。"}
                    );
            var records = myDataTable2.getRecordSet();
            for (var i = 0; i < records._records.length; i++) {
                  apoButtonArray3[i] = "editApo_" + i;
            }

    myDataTable.sortColumn( myDataTable.getColumn(""), "" );

    YAHOO.example.container.tt1 = new YAHOO.widget.Tooltip("tt1", { context:"ordersButton", text:"my.shopping.click.to.change.report" });
    YAHOO.example.container.tt2 = new YAHOO.widget.Tooltip("tt2", { context:ordersButtonArray2, text:"查看订单内容" });
    YAHOO.example.container.tt3 = new YAHOO.widget.Tooltip("tt3", { context:ordersButtonArray3, text:"新增订单" });
    YAHOO.example.container.tt4 = new YAHOO.widget.Tooltip("tt4", { context:"apoButton", text:"my.shopping.view.apos" });
    YAHOO.example.container.tt5 = new YAHOO.widget.Tooltip("tt5", { context:"apoButton2", text:"新增自动订货" });
    YAHOO.example.container.tt6 = new YAHOO.widget.Tooltip("tt6", { context:apoButtonArray3, text:"变更自动订货" });

    myDataTable.sortColumn( myDataTable.getColumn(""), "" );

    myDataTable2.sortColumn( myDataTable2.getColumn(""), "" );

        }

//        }();
//    });


   function addOrderToCart(orderId){

        var url = "/cart/AddOrderToCart?orderId=" + orderId ;

            YAHOO.util.Connect.asyncRequest("POST", url ,
    {
        success: function (o) {
            //YAHOO.USANA.cartWidget.showCart();
            var temp = trim( o.responseText)
            if (temp.length > 0 ){

               if (o.responseText.indexOf("my.shopping.no.items.added")>0){
                   alert(temp);
                } else {
                   alert(temp + "\n\n" + "无法新增此产品至购物车")
                   displayCheckMark("addOrderToCart_" + orderId);
               }
            } else {
                displayCheckMark("addOrderToCart_" + orderId);
            }

            updateCustomKits(orderId);
            checkCheckoutButton()
            checkCartOpen();
            refreshMhps();
            loadUserCustomKits();
            loadUserMySmartKits();
            loadingMask.hide();

        },
        failure: function (o) {
            alert("addOrderToCart Ajax request failed!");
        }
    });


    }

var connObj = {
    removeProfile:function(arg){
        var ts = new Date().getTime();
        var url = "/mhp/RemoveMhpProfile?ts=" + ts + "&idToRemove=" + arg;
        YAHOO.util.Connect.asyncRequest("POST", url ,
    {
        success: function (o) {
             refreshMhps()
        },
        failure: function (o) {
            alert("removeProfile Ajax request failed!");
        }
    });
 }
}
 var connObj2 = {
     addToCart:function(arg){
         var url = "/mhp/AddMhpToCart?=" + arg;
         if('' == 1){
            url += "&apoIdFromMyShopping=&appCodeFromMyShopping=";
         }

         YAHOO.util.Connect.asyncRequest("POST", url ,
     {
         success: function (o) {
           displayCheckMark("addMhpToCart_" + arg)
           checkCheckoutButton()
           checkCartOpen();
            refreshMhps();
           loadingMask.hide();
         },
         failure: function (o) {
             alert("addToCart Ajax request failed!");
         }
     });
  }
 }


 var connObj4 = {
     addToCart:function(arg){
         var url = "/cart/MyShoppingAddRecommendToCart?surveyId=" + arg;
         YAHOO.util.Connect.asyncRequest("POST", url ,
     {
         success: function (o) {
            var temp = trim( o.responseText)
            if (temp.length > 0 ){
               alert(temp + "\n\n" + "下列产品因不再供应，因此不出现在购物车中：")

            }
            displayCheckMark("addRecommendToCart_" + arg)
            checkCheckoutButton();
            checkCartOpen(); 

             loadingMask.hide();

         },
         failure: function (o) {
             alert("removeRecommend Ajax request failed!");
         }
     });
  }
 }

function checkCartOpen(){
      var cart = document.getElementById("cartWidget_c");
     if (cart != undefined && cart.style.visibility == "visible") {
         YAHOO.USANA.cartWidget.showCart();
     }
}
var loadingMask;
 function addMhpToCart(idIn){
    if (loadingMask==undefined || loadingMask==null){
        loadingMask= new YAHOO.USANA.LoadingMask(document.body,{});
    }
    loadingMask.show();
    connObj2.addToCart(idIn)
    checkCartOpen();



 }

function addRecommendToCart(idIn){
     if (loadingMask==undefined || loadingMask==null){
        loadingMask= new YAHOO.USANA.LoadingMask(document.body,{});
    }
    loadingMask.show();
    connObj4.addToCart(idIn);

}


YAHOO.namespace("example.container");

function init() {

	// Define various event handlers for Dialog
    var handleYes = function() {

        connObj3.removeRecommend(deleteRecommend);

        this.hide()
    };
    var handleNo = function() {
        this.hide();
    };

    var handleYesMhp = function() {
        connObj.removeProfile(deleteMhp);
        this.hide()
    };
    var handleNoMhp = function() {
        this.hide();
    };

    var handleYesKit = function() {
        hideCustomKit(deleteMySmart);
        this.hide();
    };
    var handleNoKit = function() {
        this.hide();
    };

simpledialog3 = new YAHOO.widget.SimpleDialog("simpledialog3",
                         { width: "300px",
                           fixedcenter: true,
                           visible: false,
                           draggable: true,
                           modal: true,
                           close: true,
                           text: "确认删除建议产品列表?",
                           icon: YAHOO.widget.SimpleDialog.ICON_HELP,
                           constraintoviewport: true,
                           buttons: [ { text:"Yes", handler:handleYes, isDefault:true },
                                      { text:"No",  handler:handleNo} ]
                         } );
    simpledialog3.setHeader("建议产品列表");

	simpledialog3.render("container2");

    simpledialog2 = new YAHOO.widget.SimpleDialog("simpledialog2",
                             {
                                width: "300px",
                                fixedcenter: true,
                                visible: false,
                                draggable: true,
                                modal: true,
                                close: true,
                                text: "确认删除MyHealhPak存档名字?",
                                icon: YAHOO.widget.SimpleDialog.ICON_HELP,
                                constraintoviewport: true,
                                buttons: [ { text:"Yes", handler:handleYesMhp, isDefault:true },
                                          { text:"No",  handler:handleNoMhp } ]
                             }
    );
    simpledialog2.setHeader("删除存档");
    simpledialog2.render("container2");

    mySmartDeleteDialog = new YAHOO.widget.SimpleDialog("mySmartDeleteDialog",
                             {
                                width: "300px",
                                fixedcenter: true,
                                visible: false,
                                draggable: true,
                                modal: true,
                                close: true,
                                text: "OK to delete the MySmartStart kit?",
                                icon: YAHOO.widget.SimpleDialog.ICON_HELP,
                                constraintoviewport: true,
                                buttons: [ { text:"Yes", handler:handleYesKit, isDefault:true },
                                          { text:"No",  handler:handleNoKit } ]
                             }
    );
    mySmartDeleteDialog.setHeader("Delete Kit");
    mySmartDeleteDialog.render("container2");
}
  function setCustomerPackAndSubmit(id){
    document.Step1Form..value = id;
    document.Step1Form.submit();
  }
YAHOO.util.Event.addListener(window, "load", init);
init1();

refreshMhps();
loadUserCustomKits();
loadUserMySmartKits();
YAHOO.namespace("example.container");

   function getSortString(){

       var s = "";

        s= s+ "&sk1=" + myDataTable.get('sortedBy').key;
        s= s+"&sd1=" + myDataTable.get('sortedBy').dir;
       
           s = s + "&sk2=" + myDataTable2.get('sortedBy').key;
           s = s + "&sd2=" + myDataTable2.get('sortedBy').dir;
       
       if (myDataTable3 != null) s = s + "&sk3=" + myDataTable3.get('sortedBy').key;
       if (myDataTable3 != null) s = s + "&sd3=" + myDataTable3.get('sortedBy').dir;
       if (myDataTable4 != null) s = s + "&sk4=" + myDataTable4.get('sortedBy').key;
       if (myDataTable4 != null) s = s + "&sd4=" + myDataTable4.get('sortedBy').dir;
       if (myDataTable5 != null) s = s + "&sk5=" + myDataTable5.get('sortedBy').key;
       if (myDataTable5 != null) s = s + "&sd5=" + myDataTable5.get('sortedBy').dir;
       if (myDataTable6 != null) s = s + "&sk6=" + myDataTable6.get('sortedBy').key;
       if (myDataTable6 != null) s = s + "&sd6=" + myDataTable6.get('sortedBy').dir;

       document.getElementById("sk1").value = myDataTable.get('sortedBy').key;
       document.getElementById("sd1").value = myDataTable.get('sortedBy').dir;
        
           document.getElementById("sk2").value = myDataTable2.get('sortedBy').key;
           document.getElementById("sd2").value = myDataTable2.get('sortedBy').dir;
       

       if (myDataTable3 != null) document.getElementById("sk3").value = myDataTable3.get('sortedBy').key;
       if (myDataTable3 != null) document.getElementById("sd3").value = myDataTable3.get('sortedBy').dir;
       if (myDataTable4 != null) document.getElementById("sk4").value = myDataTable4.get('sortedBy').key;
       if (myDataTable4 != null) document.getElementById("sd4").value = myDataTable4.get('sortedBy').dir;
       if (myDataTable5 != null) document.getElementById("sk5").value = myDataTable5.get('sortedBy').key;
       if (myDataTable5 != null) document.getElementById("sd5").value = myDataTable5.get('sortedBy').dir;
       if (myDataTable6 != null) document.getElementById("sk6").value = myDataTable6.get('sortedBy').key;
       if (myDataTable6 != null) document.getElementById("sd6").value = myDataTable6.get('sortedBy').dir;


       return s;
   }
 function submitDateRange(){

     getSortString()

     document.myShoppingForm.submit();

 }
 checkCheckoutButton();


function trim(stringToTrim) { return stringToTrim.replace(/^\s+|\s+$/g,""); }


// turned off display of div showing table to avoid display issue as table is being populated --turn back on

var div1 = document.getElementById("markup");
var div2 = document.getElementById("markup2");
div1.style.display = 'block';
div2.style.display = 'block';

function showEditErrorMessage(whichError, apoMode, oeMode){
    //alert(apoMode);
    if(apoMode != null && apoMode != undefined && apoMode == 'true'){
        showErrorWindow('您已经在自动订货模式。如果您想另行制作或修改自动订货订单，请先完成当前的自动订货订单并返回到自动订货管理页面。', '请求已略过');    
    }if(oeMode != null && oeMode != undefined && oeMode == 'true'){
        showErrorWindow('shop.my.shopping.cant.leave.oe.funnel', 'shop.my.shopping.cant.leave.oe.funnel.title');    
    }else if(whichError != "ACTIVE"){
        showErrorWindow('&nbsp;', '自动订购订单保留中');
    }else{
        showErrorWindow('\u5EFA\u7ACB\u65B0\u7684\u300C\u81EA\u52A8\u8BA2\u8D27\u300D\u6216\u66F4\u6539\u73B0\u6709\u300C\u81EA\u52A8\u8BA2\u8D27\u300D\u4E4B\u670D\u52A1\u73B0\u6B63\u6682\u505C\uFF0C\u4EE5\u66F4\u65B0\u7CFB\u7EDF\u300C\u81EA\u52A8\u8BA2\u8D27\u300D\u7684\u672C\u5468\u8FD0\u8F6C\u5468\u671F\u65E5\u7A0B\u3002\u5982\u9700\u8981\u6709\u5173\u670D\u52A1\uFF0C \u8BF7\u4E8E24\u5C0F\u65F6\u540E\u767B\u5165\u4F7F\u7528\uFF0C\u6216\u4E8E\u529E\u516C\u65F6\u95F4\u8054\u7EDC\u76F4\u9500\u5546\u670D\u52A1\u90E8\u3002', '自动订单不得在在线变更');
    }
}
$(function(){
    $('#thaSurveyTable').tha_survey_table({
        translations: {
                'my.shopping.recommendation.name': '\u6458\u8981',
                'my.shopping.recommendation.date': '\u65E5\u671F',
                'my.shopping.recommendation.options': '\u9009\u9879',
                'my.shopping.no.records.found': '\u516C\u53F8\u914D\u9001',
                'my.shopping.loading': '\u6B63\u5728\u8FD0\u884C',
                'my.shopping.sort.ascending': '\u70B9\u51FB\u5E76\u6309\u4ECE\u4F4E\u5230\u9AD8\u987A\u5E8F\u5206\u7C7B',
                'my.shopping.sort.descending': '\u70B9\u51FB\u5E76\u6309\u4ECE\u9AD8\u5230\u4F4E\u987A\u5E8F\u5206\u7C7B',
                'my.shopping.error': '\u6570\u636E\u9519\u8BEF\u3002',
                'my.shopping.delete.recommendation.question': '\u786E\u8BA4\u5220\u9664\u5EFA\u8BAE\u4EA7\u54C1\u5217\u8868?',
                'my.shopping.add.mhp': '\u8BBE\u5B9A\u65B0\u7684 MyHealthPak',
                'my.shopping.view.recommendation': '\u67E5\u770B\u5EFA\u8BAE\u4EA7\u54C1\u5217\u8868',
                'apo.remove':'\u5220\u9664' ,
                'my.shopping.editable':'my.shopping.editable',
                'my.shopping.THA.recommendations':'\u771F\u6B63\u5065\u5EB7\u8BC4\u91CF\u5EFA\u8BAE\u4EA7\u54C1',
                'my.shopping.click.to.edit.tooltip':'\u70B9\u51FB\u6B64\u5904\u4F5C\u7F16\u8F91 ',
                'my.shopping.create.new.THA.tooltip':'\u91CD\u65B0\u505A\u4E00\u6B21\u771F\u6B63\u5065\u5EB7\u8BC4\u91CF',
                'my.shopping.create.mhp':'\u5236\u4F5C\u201C\u6211\u7684\u5065\u5EB7\u5957\u88C5\u201D'
                            },
            shopperId: '',
            contextPath: '/shop'
    });
});
YAHOO.util.Event.onDOMReady(function(){
        setupCategoryTree();
    });
function showOrHidePageLoadingMask(showMask){
    var pageLoadingMask = YAHOO.util.Dom.get('pageLoadingMask');
    if(pageLoadingMask != null && pageLoadingMask != undefined){
    if(showMask == "0"){
    YAHOO.util.Dom.removeClass(pageLoadingMask,'showBlock');
    YAHOO.util.Dom.addClass(pageLoadingMask,'hideSection');
    }else{
    YAHOO.util.Dom.removeClass(pageLoadingMask,'hideSection');
    YAHOO.util.Dom.addClass(pageLoadingMask,'showBlock');
    }
    }
    }
YAHOO.namespace("example.container");
    YAHOO.example.container.errorWindow;
    YAHOO.util.Event.onDOMReady(function(){
        turnRed();
        setupErrorMessages();

    });
YAHOO.example.container.askCreateAutoship;
    function askCreateAutoship(theForm, action){
    if('0' == '0'){
    if(theForm != null && theForm != undefined){ disableForm(theForm, true); }
    var panelHtml = '\u60A8\u8981\u73B0\u5728\u8BBE\u5B9A\u81EA\u52A8\u8BA2\u8D27\u9501\u5B9A\u8FD9\u5F20\u8BA2\u5355\u4EAB\u53D710%\u4F18\u60E0\u5417\uFF1F<br>';
    panelHtml +='<br><br>';
    if('0' == '1' && '0' == '1'){
    panelHtml += '<center>';
    panelHtml += '<button type=\"button\" class=\"actionButton\" onclick=\"javascript:finishAskCreateAutoship(\'createRegularAutoship\', \''+action+'\')\">\u662F\u7684\uFF0C\u6211\u51C6\u5907\u597D\u4E86</button>';
    panelHtml += ' ';
    panelHtml += '<button type=\"button\" class=\"actionButton\" onclick=\"javascript:finishAskCreateAutoship(\'createNFRAutoship\', \''+action+'\')\">oe.go.to.autoship.confirm.nfr</button>';
    panelHtml += '<br>';
    panelHtml += '<a href=\"javascript:finishAskCreateAutoship(\'skipAutoship\', \''+action+'\')\">\u8C22\u8C22\uFF0C\u73B0\u5728\u8FD8\u4E0D\u8981</a>';
    panelHtml += '</center>';
    }else{
    panelHtml += '<center>';
    panelHtml += '<button type=\"button\" class=\"actionButton\" onclick=\"javascript:finishAskCreateAutoship(\'createRegularAutoship\', \''+action+'\')\">\u662F\u7684\uFF0C\u6211\u51C6\u5907\u597D\u4E86</button>';
    panelHtml += ' ';
    
    panelHtml += '<a href=\"javascript:finishAskCreateAutoship(\'skipAutoship\', \''+action+'\')\">\u8C22\u8C22\uFF0C\u73B0\u5728\u8FD8\u4E0D\u8981</a>';
    panelHtml += '</center>';
    }
    if(YAHOO.example.container.askCreateAutoship == null || YAHOO.example.container.askCreateAutoship == undefined){
    YAHOO.example.container.askCreateAutoship = new YAHOO.widget.Panel("askCreateAutoshipPanel", {
    width: "500px",
    fixedcenter: true,
    close: true,
    draggable: false,
    zindex:4,
    modal: true,
    visible: false
    }
    );
    }
    YAHOO.example.container.askCreateAutoship.render();
    YAHOO.example.container.askCreateAutoship.setHeader('\u5EFA\u7ACB\u81EA\u52A8\u8BA2\u5355');
    YAHOO.example.container.askCreateAutoship.setBody(panelHtml);
    YAHOO.example.container.askCreateAutoship.render();
    YAHOO.example.container.askCreateAutoship.show();
    }else{
    window.location = "/shop/checkout/SendToCorrectCheckout?goToCreateAutoship=0";
    }
    }
    function finishAskCreateAutoship(userAnswer, action){
    disableButtonsForCheckout();
    YAHOO.example.container.askCreateAutoship.hide();
    for(var i =0; i < document.forms.length; i++){
    disableForm(document.forms[i]);
    }
    if('createRegularAutoship' == userAnswer){
    window.location = "/shop" + action + "?goToCreateAutoship=1";
    }else if('createNFRAutoship' == userAnswer){
    window.location = "/shop" + action + "?goToCreateAutoship=2";
    }else{
    window.location = "/shop/enroll/QuitApo?saveOrderAndCartToEsb=1";
    }
    }

    function cancelAutoship(){
    window.location = '/shop/enroll/QuitApo';
    }

    function checkBdsInCartBeforeSubmit(theForm, location){
    var countryCode =  'US';
    var handleSuccess = function(o){
    if(o.responseText != undefined){
    if(o.responseText.indexOf('##error') > -1){
    sessionTimeout();
    }else{
    if((countryCode == 'CN')){
    if(o.responseText.indexOf('cartContainsBds:-1') > -1){
    disableForm(theForm, true);
    showErrorWindow('\u60A8\u5FC5\u987B\u8D2D\u4E70\u521B\u4E1A\u8D77\u6B65\u5957\u88C5(BDS)\u4EA7\u54C1\u624D\u80FD\u7EE7\u7EED\u60A8\u7684\u5165\u4F1A\u767B\u8BB0\u624B\u7EED\u3002<br><br>\u8BF7\u4ECE\u672C\u9875\u4E0A\u65B9\u7684\u521B\u4E1A\u8D77\u6B65\u5957\u88C5\u4EA7\u54C1\u4E2D\u9009\u62E9\u4E00\u9879\u3002','\u5FC5\u987B\u8D2D\u4E70\u4EA7\u54C1');
    }else{
    if(location != 'SendToCheckout'){
    window.location = location;
    }else{
    askCreateAutoship(theForm, '/checkout/SendToCorrectCheckout');
    }
    }
    }else{
    if(o.responseText.indexOf('cartContainsBds:0') > -1){
    disableForm(theForm, true);
    showErrorWindow('\u60A8\u5FC5\u987B\u8D2D\u4E70\u521B\u4E1A\u8D77\u6B65\u5957\u88C5(BDS)\u4EA7\u54C1\u624D\u80FD\u7EE7\u7EED\u60A8\u7684\u5165\u4F1A\u767B\u8BB0\u624B\u7EED\u3002<br><br>\u8BF7\u4ECE\u672C\u9875\u4E0A\u65B9\u7684\u521B\u4E1A\u8D77\u6B65\u5957\u88C5\u4EA7\u54C1\u4E2D\u9009\u62E9\u4E00\u9879\u3002','\u5FC5\u987B\u8D2D\u4E70\u4EA7\u54C1');
    }else{
    if(location != 'SendToCheckout'){
    window.location = location;
    }else{
    askCreateAutoship(theForm, '/checkout/SendToCorrectCheckout');
    }
    }
    }
    }
    }
    };

    var handleFailure = function(o){
    if(o.responseText !== undefined){
    alert('failure in saveNewCardAjax');
    }
    };

    var callback =
    {
    success:handleSuccess,
    failure:handleFailure,
    argument:["foo", "bar"]
    };
    var sUrl = "/shop/jsp/onlineServices/shop/products/CartContainsBds.jsp";
    var request = YAHOO.util.Connect.asyncRequest('POST', sUrl, callback, null);
    }
    function disableOrEnableAllForms(enable){
    if(document.forms != null && document.forms.length > 0){
    for(var i = 0; i < document.forms.length; i++){
    disableForm(document.forms[i], enable);
    }
    }
    }
    var registerBranchChanged = function(e){
    var addressStateDropDown = YAHOO.util.Dom.get('stateCode2');
    if(addressStateDropDown != null && addressStateDropDown != undefined){
    var callback = {
    success:function(o){
    var rTxt;
    try{
    rTxt= YAHOO.lang.JSON.parse(o.responseText);
    }catch(e){
    alert('failed to parse server response');
    }
    if(rTxt != null && rTxt != undefined && rTxt != ''){
    for(var i = 0; i < addressStateDropDown.length; i++){
    var state = addressStateDropDown[i];
    if(rTxt.registerBranchState.toUpperCase() == state.value.toUpperCase()){
    addressStateDropDown.selectedIndex = i;
    break;
    }
    }
    }
    },
    failure:function(o){
    alert('error');
    },
    argument:[]
    };
    var sUrl = '/shop/enroll/ChangedRegisterBranch';
    var registerBranches = YAHOO.util.Dom.get('registerBranch_en');
    if(registerBranches != null && registerBranches != undefined){
    sUrl += '?registerBranch='+registerBranches.options[registerBranches.selectedIndex].value;
    }
    var transaction = YAHOO.util.Connect.asyncRequest('GET', sUrl, callback, null);
    }
    };

    function printEnrollmentApplicationPdf(){
    var newWindow = window.open('/shop/enroll/applicationForm', '_blank');
    newWindow.focus();
    return false;
    }

    function showToast(msg,type,title) {


    toastr.options = {"closeButton": true, "debug": false, "positionClass": "toast-top-right", "onclick": null,
    "showDuration": "300", "hideDuration": "1000", "timeOut": "5000", "extendedTimeOut": "1000",
    "showEasing": "swing", "hideEasing": "linear", "showMethod": "fadeIn", "hideMethod": "fadeOut"
    }

    if ('info'== type){
        var $toast = toastr.info(msg, title);
    }else if ('warning'== type){
        var $toast = toastr.warning(msg, title);
    }else if ('error'== type){
        var $toast = toastr.error(msg, title);
    } else {
        var $toast = toastr.success(msg, title);
    }






    }
</script>



    
    
        






    <script type="text/javascript">
        var _hmt = _hmt || [];
        (function () {
            var hm = document.createElement("script");
            hm.src = "https://hm.baidu.com/hm.js?05362067a94feb96dcaf79154d65a193";
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(hm, s);
        })();
    </script>



    





    

</body></html>