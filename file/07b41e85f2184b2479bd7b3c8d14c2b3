<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>马拉送生活服务</title>
<meta name="keywords" content="马拉送订餐"/>
<meta name="description" content="马拉送订餐"/>
<link rel="stylesheet" type="text/css" href="/webcss/common/images/common.css"/>
<link rel="stylesheet" type="text/css" href="/webcss/common/images/expand.css"/>
<link rel="stylesheet" type="text/css" href="/webcss/default/images/main.css"/>
<link rel="stylesheet" type="text/css" href="/webcss/default/images/mall.css"/>
<script src="/common.php?app=sys&app_act=web.config&app_ajax=1"></script>
<script src="/webcss/common/js/kj.js"></script>
<script src="/webcss/common/js/kj.ajax.js"></script>
<script src="/webcss/common/js/kj.dialog.js"></script>
<script src="/webcss/default/header.js"></script>
<script src="/webcss/default/member.js"></script>
<script src="/webcss/common/js/kj.rule.js"></script>
<script src="/webcss/common/js/kj.alert.js"></script>
</head>
<body style="background: #FDB932;">
<table align="center" class="tab1">
<tr><td>
<div class="xmenu">
	<li><a href="/">首页</a></li>
	<li><span>&nbsp;</span><a href="/index.php?app=act.gift">礼品兑换</a></li>
	<li><span>&nbsp;</span><a href="/index.php?app_act=help">帮助中心</a></li>
	<li><span>&nbsp;</span><a href="/index.php?app_act=msg">意见反馈</a></li>
	<li><span>&nbsp;</span><a href="/index.php?app_act=cart">购物车</a></li>
			<li style="float:right;margin-top:0px">
						<a href="javascript:void(0);" onmouseover="kj.show('#id_arealogin');" onmouseout="kj.hide('#id_arealogin');"><img src="/webcss/default/images/login1.png" id="id_loginpic"></a>
		</li>
	</div>
</td></tr>
<tr><td><i class="logo2"></i></td></tr>
<tr><td style="padding-top:30px">
	<div class="div2">
	<ul>
		<li onmouseover="kj.addClassName(this,'xsel');" onmouseout="kj.delClassName(this,'xsel');" onclick="thisjs.seltop(this);thisjs.get_area(1,'滨海大港','1','1' ,true);"><span><img src = "/upload/attatch/1/dagangshijiguangchang_1400408998.jpg"></span><h2>滨海大港</h2></li>
		<li onmouseover="kj.addClassName(this,'xsel');" onmouseout="kj.delClassName(this,'xsel');" onclick="thisjs.seltop(this);thisjs.get_area(2,'津南区','1','1' ,true);"><span><img src = "/upload/attatch/1/u=2258199428,2503702090&amp;fm=23&amp;gp=0_1400409009.jpg"></span><h2>津南区</h2></li>
		<li onmouseover="kj.addClassName(this,'xsel');" onmouseout="kj.delClassName(this,'xsel');" onclick="thisjs.seltop(this);thisjs.get_area(3,'滨海塘沽','0','1' ,true);"><span><img src = "/upload/attatch/1/2010112614274002_1400409018.jpg"></span><h2>滨海塘沽</h2></li>
		<li onmouseover="kj.addClassName(this,'xsel');" onmouseout="kj.delClassName(this,'xsel');" onclick="thisjs.seltop(this);thisjs.get_area(16,'和平区','0','1' ,true);"><span><img src = "/upload/attatch/1/heping.jpg"></span><h2>和平区</h2></li>
		<li onmouseover="kj.addClassName(this,'xsel');" onmouseout="kj.delClassName(this,'xsel');" onclick="thisjs.seltop(this);thisjs.get_area(17,'南开区','0','1' ,true);"><span><img src = "/upload/attatch/1/nankai.gif"></span><h2>南开区</h2></li>
		<li onmouseover="kj.addClassName(this,'xsel');" onmouseout="kj.delClassName(this,'xsel');" onclick="thisjs.seltop(this);thisjs.get_area(18,'河西区','0','1' ,true);"><span><img src = "/upload/attatch/1/hexi.jpg"></span><h2>河西区</h2></li>
		<li onmouseover="kj.addClassName(this,'xsel');" onmouseout="kj.delClassName(this,'xsel');" onclick="thisjs.seltop(this);thisjs.get_area(19,'河东区','0','1' ,true);"><span><img src = "/upload/attatch/1/hedong.jpg"></span><h2>河东区</h2></li>
		<li onmouseover="kj.addClassName(this,'xsel');" onmouseout="kj.delClassName(this,'xsel');" onclick="thisjs.seltop(this);thisjs.get_area(20,'唐山市','1','1' ,true);"><span><img src = "/upload/attatch/1/6678425_221657452000_2.jpg"></span><h2>唐山市</h2></li>
		<li onmouseover="kj.addClassName(this,'xsel');" onmouseout="kj.delClassName(this,'xsel');" onclick="thisjs.seltop(this);thisjs.get_area(22,'大港油田','0','1' ,true);"><span><img src = "/upload/attatch/1/jiqi_1441779512.jpg"></span><h2>大港油田</h2></li>
		</ul>
	</div>
</td></tr>
<tr><td>
	<div class="div1">
		<ul class="x1" id="id_search_box">
			<input type="text" name="s_key" value="您所在的地区 / 想要找的店名" class="txt1" onkeyup="thisjs.search(this.value);" onfocus="if(this.value=='您所在的地区 / 想要找的店名'){this.value='';};this.style.color='#000';" onblur="if(this.value==''){this.value='您所在的地区 / 想要找的店名';this.style.color='#888';}"><input type="submit" name="btn_ok" value="" class="btn1">
		</ul>
		<ul class="x2" id="id_area_box" style="display:none">
			<li id="id_path" class="y2"></li>
			<li id="id_area_list" class="y1"></li>
		</ul>
		<ul class="x2" id="id_search_list" style="display:none">
			<li class="y1"></li>
		</ul>
	</div>
</td></tr>
</table>
<div class="arealogin" id="id_arealogin" style="display:none" onmouseover="kj.show('#id_arealogin');" onmouseout="kj.hide('#id_arealogin');">
	<ul><li class="x1"><a href="javascript:jsheader.showlogin();">登录</a></li><li class="x2"><a href="javascript:jsheader.showreg();">注册</a></li></ul>
</div>
<div id="id_loginbox" style="display:none">
	<form name="frmlogin" method="post" action="/common.php?app=sys&app_act=login.verify" onsubmit="return jsheader.on_login();">
	<div class="loginbox">
		<ul class="xleft">
			<li><span class="x1">用户名：</span><span><input type="text" name="uname" class="txt1"/></span></li>
			<li><span class="x1">密码：</span><span><input name="pwd" type="password" class="txt1"/></span></li>
			<li id="id_verify_code" style="display:none"><span class="x1">验证码：</span><span><input name="verifycode" type="text" class="txt2"  onfocus="jsheader.show_verify('#id_verify');"/>&nbsp;<img src="/webcss/default/" id="id_verify_pic" onclick="this.src='/common.php?app=sys&app_act=verifycode&app_contenttype=img&app_rnd='+Math.random();" style="display:none"></span></li>
			<li><span class="x1"></span><span><label><input type="checkbox" name="autologin" value="1" checked>下次自动登录</label>&nbsp;&nbsp;<a href="/index.php?app=index&app_act=findpwd">忘记密码?</a><br><br>
			<input type="submit" name="btn_submit" value="登 录" class="button1" style="font-size:22px">
			</span></li>
		</ul>
				<ul class="xboot a1">
		<h1>还不是会员？</h1>一分钟轻松注册，就可以方便订餐<a href="javascript:jsheader.showreg();">【立即注册】</a>
		</ul>
	</div>
	<input type="hidden" name="jump_fromurl" value="">
	</form>
</div>
<script>
var thisjs = new function() {
	this.path = [];
	this.pids = [];
	this.city_id = kj.toint('');
	this.depth = kj.toint('3');
	this.search = function(key) {
		if(key == '') {
			kj.set("#id_search_list .y1",'innerHTML','');
			kj.hide("#id_search_list");
			return;
		}
		kj.show("#id_search_list");
		kj.ajax.get('/index.php?app_act=area_search&skey='+key,function(data) {
				var obj_arr = kj.json(data);
				var arr = obj_arr.list;
				var html_shop = '',html_menu = '' , html_area = '';
				var html = '<table class="stable">',arr1,area;
				for(var i = 0 ; i < arr.length ; i++ ) {
					if(arr[i].type=='shop') {
						arr1 = arr[i].shop_area.split(" ");
						area = '';
						if(arr1.length>0 && arr1[arr1.length-1] != '') area = "<font style='color:#888'>(" + arr1[arr1.length-1] + ")</font>";
						html_shop += "<a href='/index.php?app_act=shop&id=" + arr[i].shop_id + "'>" + arr[i].shop_name + area + "</a>";
					} else if(arr[i].type=='menu') {
						html_menu += '<a href="/index.php?app_act=shop&id=' + arr[i].shop_id + '">' + arr[i].menu_title + "￥" +  arr[i].menu_price + '&nbsp;<font style="color:#888">(' + arr[i].shop_name + ')</font>' + "</a>";
					} else {
						html_area += '<a href="javascript:thisjs.set_area(' + arr[i].area_id + ',\'' + arr[i].area_name + '\',\''+arr[i].area_childs+'\',\''+arr[i].area_depth+'\',\''+arr[i].area_pids+'\')">' + arr[i].area_name + "</a>";
					}
				}
				if(html_area!='') html += '<tr onmouseover="kj.addClassName(this,\'rowsel\')" onmouseout="kj.delClassName(this,\'rowsel\')"><td class="jian" width="50px" valign="top">区域</td><td>' + html_area + '</td></tr>';
				if(html_shop!='') html += '<tr onmouseover="kj.addClassName(this,\'rowsel\')" onmouseout="kj.delClassName(this,\'rowsel\')"><td class="jian" width="50px" valign="top">店铺</td><td>' + html_shop + '</td></tr>';
				if(html_menu!='') html += '<tr onmouseover="kj.addClassName(this,\'rowsel\')" onmouseout="kj.delClassName(this,\'rowsel\')"><td class="jian" width="50px" valign="top">菜品</td><td>' + html_menu + '</td></tr>';
				html += '</table>';

				thisjs.pids = obj_arr.pids;
				arr = kj.obj("#id_search_list li");
				arr[0].innerHTML = html;
		});
	}
	this.set_area = function(id,name,childs,depth,pids) {
		if(kj.toint(childs)<1 || kj.toint(depth)>=this.depth) {
			this.select(id,name);
			return;
		}
		var arr = pids.split(",");
		for(var i = 0 ; i < arr.length ; i++ ) {
			if(arr[i] == this.city_id) {i++;break;}
		}
		var key = '';
		this.path = [];
		for(var i = i ; i < arr.length ; i++ ) {
			key  = 'id_' + arr[i];
			if( key in this.pids) {
				this.path[this.path.length] = {'id':this.pids[key].area_id,'name':this.pids[key].area_name,'childs':this.pids[key].area_childs,'depth':this.pids[key].area_depth};
			}
		}
		kj.hide("#id_search_list");
		this.get_area(id,name,childs,depth);
	}
	this.set_path = function(id) {
		var html = '';
		for(var i = 0 ; i < this.path.length ; i++) {
			html += '<a href="javascript:thisjs.get_area('+this.path[i].id+',\''+this.path[i].name+'\',\''+this.path[i].childs+'\',\''+this.path[i].depth+'\');">' + this.path[i].name + '</a>';
			if(id == this.path[i].id && i < this.path.length-1) {
				for(var j = i+1 ; j < this.path.length ; j++ ) {
					this.path.removeat(j);
				}
				break;
			}
		}
		kj.obj('#id_path').innerHTML = html + "<span onclick='thisjs.back()'>返回</span>";
	}
	this.get_area = function(id,name,childs,depth,istop) {
		kj.hide("#id_search_box");
		kj.show("#id_area_box");
		if(kj.toint(childs) <= 0 || this.depth<=depth) {
			this.select(id,name);
			return;
		}
		if(istop) this.path = [];
		this.path[this.path.length] = {'id':id,'name':name,'childs':childs,'depth':depth};
		this.set_path(id);
		kj.ajax.get('/index.php?app_act=area_next&pid='+id,function(data) {
			var arr = kj.json(data);
			var arr_jian = [];
			var arr_j = [];
			var jian,j;
			for(var i = 0 ; i < arr.length ; i++) {
				jian = arr[i].area_jian.substr(0,1);
				if(!(jian in arr_jian)) arr_jian[jian] = [];
				if(arr_j.indexOf(jian)<0) arr_j[arr_j.length] = jian;
				arr_jian[jian][arr_jian[jian].length] = arr[i];
				//html+="<li>"+arr[i].area_name+"</li>";
			}
			var html = "<table class='stable'>";
			for(i = 0 ; i < arr_j.length ; i++ ) {
				html += '<tr onmouseover="kj.addClassName(this,\'rowsel\')" onmouseout="kj.delClassName(this,\'rowsel\')"><td class="jian" width="30px" valign="top">' + arr_j[i] + '</td><td>';
				for(j = 0 ; j < arr_jian[arr_j[i]].length ; j++ ) {
					html += '<a href="javascript:thisjs.get_area('+arr_jian[arr_j[i]][j].area_id+',\''+arr_jian[arr_j[i]][j].area_name+'\',\''+arr_jian[arr_j[i]][j].area_childs+'\',\''+arr_jian[arr_j[i]][j].area_depth+'\');">' + arr_jian[arr_j[i]][j].area_name + '</a>';
				}
				html += '</td></tr>';
			}
			html += '</table>';
			kj.obj("#id_area_list").innerHTML = html;
		});
	}
	this.back = function() {
		if(this.path.length>1) {
			this.path.removeat(this.path.length-1);
			this.get_area(this.path[this.path.length-1].id,this.path[this.path.length-1].name,this.path[this.path.length-1].childs);
		} else {
			this.back_home();
		}
	}
	this.back_home = function() {
		kj.delClassName('.div2 ul li' , 'xs');
		kj.hide("#id_area_box");
		kj.show("#id_search_box");
	}
	this.seltop = function(o) {
		kj.delClassName('.div2 ul li' , 'xs');
		kj.addClassName(o , 'xs');
	}
	this.select = function(id,name) {
		kj.cookie_set('area_id' , id , 20000);
		kj.cookie_set('area_name' , name , 20000);
		window.location.href = "http://www.malabida.com/";
	}
}
kj.onload(function(){
	var offset = kj.offset("#id_loginpic");
	var top = offset.top + offset.height;
	var left = offset.left - 44;
	kj.set("#id_arealogin" , "style.top" , top + "px");
	kj.set("#id_arealogin" , "style.left" , left + "px");

	jsheader.rule_uname = "default";
	jsheader.reg_verify = "1";
	jsheader.tempurl = "/webcss/default/";
	jsheader.is_verify = false;
});
</script>
</body>
</html>