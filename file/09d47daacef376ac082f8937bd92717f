<!DOCTYPE html><html><head>
    <title>会员注册_红岭创投_值得信赖的P2P个人理财网贷平台</title>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8;">
    <meta name="author" content="m.my089.com">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
    <meta name="apple-touch-fullscreen" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="format-detection" content="telephone=no">
    <meta name="description" content="">
    <link rel="apple-touch-icon-precomposed" href="/resources/m/touch-icon-iphone.png">
    <link rel="apple-touch-icon" href="/resources/m/touch-icon-iphone.png">
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="/resources/m/touch-icon-iphone72.png">
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="/resources/m/touch-icon-iphone114.png">
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/resources/m/touch-icon-iphone144.png">
    <script src="/scripts/jquery-1.8.3.min.js" type="text/javascript"></script>
    <script src="/scripts/legacy/com.js?t=20170210" type="text/javascript"></script>
    <script src="/scripts/legacy/placeholder.js" type="text/javascript"></script>
    <script src="/scripts/jquery.validate.min.js" type="text/javascript"></script>
    
    
    <link href="https://style.my089.com/m_css/m_base.css?t=201620161123" rel="stylesheet" type="text/css">
    <link href="https://style.my089.com/m_css/m_safe.css?t=201620161123" rel="stylesheet" type="text/css">
</head>
<body>
<style type="text/css">
    .header a.backto{ background-image: none;}
</style>
<div class="header">
    <a class="backto" href="https://m.my089.com">首页</a>
    <div class="reg_login"><a class="current" href="/m/sso/register">注册</a><a href="/m/sso">登录</a></div>
</div>
<div class="content" style="min-height: 400px;">
    <form id="regForm" action="/m/sso/register/submit" method="post" novalidate="novalidate">
        <input type="hidden" id="formFrom" name="formFrom" value="0">
        <div class="m_login">
            <div class="link_touch">
                <ul>
                    <li>
                        <label class="lab_1">手机号</label><label class="lab_2">
                        <input type="text" placeholder="请输入11位手机号" class="User" id="cellphone" name="cellphone" value="" maxlength="11">
                    </label>
                    </li>

                    <li id="randomPageIdLi" class="PicYzm" style="display: none;">
                        <label class="lab_1">图形验证码</label>
                        <label class="lab_2">
                            <input type="text" placeholder="请输入验证码" class="yzm" name="checkCode" id="checkCode" maxlength="4">
                            <input type="hidden" value="" name="randomPageId" id="randomPageId">
                            <img width="100px" height="30px" src="/m/sso/code?randomPageId=" style="cursor:pointer" title="字母不区分大小写，如果看不清可点击图片更换一个" id="codeImage">
                        </label>
                    </li>

                    <li class="VoiceYzm">
                        <label class="lab_1">短信验证码</label>
                        <label class="lab_2">
                            <input type="hidden" id="msgID" name="msgID">
                            <input type="text" maxlength="6" id="code" name="code" placeholder="请输入短信验证码" class="yzm">
                            <input type="button" id="btnCSMS" onclick="SendRegSMS('1');" value="获取验证码" class="SMSyzm">
                        </label>
                    </li>

                    <li class="yuyinyzm" style="display: none;">短信验证码收不到？可
                        <input type="button" id="btnVSMS" onclick="SendRegSMS('2');" class="a_yuyin">
                    </li><!--默认不显示-->

                    <li>
                        <label class="lab_1">登录密码</label>
                        <label class="lab_2">
                            <input type="hidden" id="md5Pwd" name="md5Pwd">
                            <input type="password" placeholder="请输入登录密码" class="Eye-password pd" auckfun="md5Password('md5Pwd','password');" id="password" name="password" maxlength="16" style="display:block;">
                            <input type="text" placeholder="请输入登录密码" auckfun="md5Password('md5Pwd','password2');" id="password2" name="password2" maxlength="16" class="Eye-text pd" style="display: none;">
                            <span class="Eye-close" style="display: block;"></span>
                            <span class="Eye-open" style="display: none;"></span>
                        </label>
                    </li>

                    <li>
                        <label class="lab_1">推荐人</label>
                        <label class="lab_2">
                            <input type="text" placeholder="请输入推荐人ID/优惠码（可不填）" class="pass" id="couponCode" name="couponCode" value="手机专享优惠" maxlength="16">
                        </label>
                    </li>
                </ul>
            </div>
        </div>
        <div class="TextMsg" id="errorMsg" style="display: block"></div>
        <div class="SerAgree">
            <label><input type="checkbox" name="cbxAgree" checked="checked" id="cbxAgree">我已阅读并同意红岭创投</label><a href="/m/sso/protocol" target="_blank">《用户服务协议》</a>
            <a href="https://www.my089.com/faq/serviceRules" target="_blank" class="bule">《会员服务协议》</a>
        </div>

        <div class="S_but">
            <input id="__TOKEN__" name="__TOKEN__" type="hidden" value="L55E1UU77LW362HVOTBEF5N87UBOYQ4Z"><input name="__TOKEN__ID__" type="hidden" value="0uj0E3tHJbhj3LGK">
            <input type="submit" id="btnPost" name="btnPost" value="立即注册" class="Flat_but">
        </div>
    </form>
</div>
<div class="foot">
    <div class="fonnt_txt">
        <p><a href="https://www.my089.com">电脑版</a>|<a class="App" href="https://m.my089.com/dowLoadApp">客户端下载</a>|<a href="https://m.my089.com/notice">网站公告</a></p>
        <p>© 2009-2016 红岭创投</p>
    </div>
    <div style="display:none">
        <script type="text/javascript">
            var cnzz_protocol = (("https:" == document.location.protocol) ? " https://" : " http://");
            document.write(unescape("%3Cspan id='cnzz_stat_icon_1419416'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "s19.cnzz.com/stat.php%3Fid%3D1419416' type='text/javascript'%3E%3C/script%3E"));
        </script><span id="cnzz_stat_icon_1419416"><a href="http://www.cnzz.com/stat/website.php?web_id=1419416" target="_blank" title="站长统计">站长统计</a></span><script src=" https://s19.cnzz.com/stat.php?id=1419416" type="text/javascript"></script><script src="https://c.cnzz.com/core.php?web_id=1419416&amp;t=z" charset="utf-8" type="text/javascript"></script>
    </div>
</div>
<script type="text/javascript" language="javascript">
    //    var CheckForm = new CheckInput();
    var $password = $("#password");
    var isCheckCode=false;
    var isCheckSMSCode=false;
    $(function () {

        $("#regForm").validate({
            onfocusout: false,
            onkeyup: false,
            onclick:false,
            focusInvalid:false,
            rules: {

                cbxAgree:{
                    required: true
                }
            },
            messages: {
                cbxAgree:{
                    required: "阅读并同意协议"
                }
            },
            showErrors: function(errorMap, errorList) {
                if(errorList != null && errorList.length > 0) {
//                    $("#errorMsg").html(errorList[0].message);
                    setErrorMsg(errorList[0].message);
                    return false;
                }
                return true;
            },
            submitHandler: function(form){
                if(checkSubmit())
                {
                    $("#btnPost").attr("disabled", "disabled").val("注册中...");
                    $("#md5Pwd").val(MD5($("#password").val(), 32));
                    $("#password").val('');
                    $("#password2").val('');

                    form.submit();
                }
            }
        });

        $('input[placeholder], textarea[placeholder]').each(function () { $(this).is('input') ? $(this).iePlaceholder() : $(this).iePlaceholder({ onInput: false }); }); //支持placeholder属性

        if (!$("#cbxAgree").attr("checked")) {
            $("#btnPost").attr("disabled", "disabled").attr("value", "阅读并同意协议");
        } else {
            $("#btnPost").removeAttr("disabled").attr("class", "Flat_but").attr("value", "立即注册");
        }

        $("#cbxAgree").click(function () {
            if (!$("#cbxAgree").attr("checked")) {
                $("#btnPost").attr("disabled", "disabled").attr("value", "阅读并同意协议");
            } else {
                $("#btnPost").removeAttr("disabled").attr("class", "Flat_but").attr("value", "立即注册");
            }
        });

        $("#cellphone").blur(function () {
            var username = $("#cellphone").val();
            checkCellphone();
        });

        $(".pd").blur(function () {
            checkPassword();
        });


        $("#checkCode").keyup(function () {
            var checkCode = $("#checkCode").val();
            checkVCode();
        });

        $("#checkCode").blur(function () {
            checkVCode();
        });

        $("#couponCode").blur(function () {
            checkCouponCode();
        });

        $("#codeImage").click(function() {
            $("#codeImage").attr("src","/m/sso/code?randomPageId="+$("#randomPageId").val() + "&c=" + Math.random());
        });

        $(".Eye-close").click(function (){
                    $('.Eye-password').hide();
                    $('.Eye-close').hide();
                    $('.Eye-text').css("display","block");
                    $('.Eye-open').show();
                    $("#password2").val($("#password").val());
                    $password=$('#password2');
                }
        );
        $(".Eye-open").click(function (){
                    $('.Eye-text').hide();
                    $('.Eye-open').hide();
                    $('.Eye-password').show();
                    $('.Eye-close').show();
                    $("#password").val($("#password2").val());
                    $password=$('#password');
                }
        );
    });

    function checkCellphone() {
        var errorMsgInfo = $("#errorMsg").html();
        var cellphone = $("#cellphone").val();
        if (cellphone == "" || cellphone.length!=11 ||!(/^(1)\d{10}$/).test(cellphone)) {
            setErrorMsg("手机号：请输入11位手机号；");
            return false;
        }
        else
        {
            errorMsgInfo = errorMsgInfo.replace("手机号：请输入11位手机号；","");
            errorMsgInfo = errorMsgInfo.replace("您输入的手机号码已经被注册。","");
            errorMsgInfo = errorMsgInfo.replace("您输入的手机号码格式不正确。","");
            errorMsgInfo = errorMsgInfo.replace("您的注册被系统检测到安全风险，请1小时后再试。","");
            $("#errorMsg").html(errorMsgInfo);
        }

        $.ajax({
            type: "Post",
            url: "/sso/checkPhone",
            dataType: "json",
            data:{
                cellphone:cellphone
            },
            success: function(data) {
                if(data.success!=true) {
                    setErrorMsg(data.message);
                    return false;
                } else {
                    errorMsgInfo = errorMsgInfo.replace("手机号：请输入11位手机号；","");
                    errorMsgInfo = errorMsgInfo.replace("您输入的手机号码已经被注册。","");
                    errorMsgInfo = errorMsgInfo.replace("您输入的手机号码格式不正确。","");
                    errorMsgInfo = errorMsgInfo.replace("您的注册被系统检测到安全风险，请1小时后再试。","");
                    $("#errorMsg").html(errorMsgInfo);
                }
            }
        });
        $("#errorMsg").html(errorMsgInfo);
        return true;
    }

    function checkPassword(){
        var errorMsgInfo = $("#errorMsg").html();
        var password = $password.val();
        if (password == "" || password.length<8 || !stationRegularPassword(password)) {
            setErrorMsg("密码：8-16位字符，至少包含英文字母（区分大小写）、数字和“_”的2种；");
            return false;
        }
        else
        {
            errorMsgInfo = errorMsgInfo.replace("密码：8-16位字符，至少包含英文字母（区分大小写）、数字和“_”的2种；","");
            errorMsgInfo = errorMsgInfo.replace("密码不能为空；","");
            $("#errorMsg").html(errorMsgInfo);
        }
        if (!isNaN(password)) {
            setErrorMsg("不能使用纯数字作为密码；");
            return false;
        } else {
            errorMsgInfo = errorMsgInfo.replace("不能使用纯数字作为密码；","");
            $("#errorMsg").html(errorMsgInfo);
        }
        return true;
    }

    function checkCouponCode(){
        var errorMsgInfo = $("#errorMsg").html();
        var couponCode = $("#couponCode").val();
        errorMsgInfo = errorMsgInfo.replace("您的推荐人注册时长未达3分钟，不能作为有效推荐人；","");
        errorMsgInfo = errorMsgInfo.replace("推荐人ID或推广码错误，请确认后重新输入；","");
        $("#errorMsg").html(errorMsgInfo);
        return true;
    }

    function  md5Password(inVal,setVal){
        $('#'+inVal).val(MD5($('#'+setVal).val(), 32));
    }

    function checkVCode() {
        if($('#randomPageIdLi').is(':visible')){
            var errorMsgInfo = $("#errorMsg").html();
            var checkCode = $("#checkCode").val();
            if (checkCode == "" || checkCode.length != 4){
                setErrorMsg("请输入正确的图形验证码；");
                isCheckCode = false;
                return false;
            }
            $.ajax({
                type: "Post",
                url: "/m/sso/checkCode?checkCode=" + checkCode + "&randomPageId=" + $("#randomPageId").val(),
                dataType: "json",
                success: function(data) {
                    if(data == 0){
                        setErrorMsg("请输入正确的图形验证码；");
                        isCheckCode=false;
                    } else if (data == 2){
                        setErrorMsg("图形验证码已失效，请重新获取；");
                        isCheckCode=false;
                    } else {
                        errorMsgInfo = errorMsgInfo.replace("请输入正确的图形验证码；","");
                        errorMsgInfo = errorMsgInfo.replace("图形验证码已失效，请重新获取；","");
                        errorMsgInfo = errorMsgInfo.replace("请输入图形验证码；","");
                        errorMsgInfo = errorMsgInfo.replace("图形验证码已失效，请重新输入；","");
                        errorMsgInfo = errorMsgInfo.replace("图形验证码错误，请重新输入；","");
                        $("#errorMsg").html(errorMsgInfo);
                        isCheckCode=true;
                    }
                }
            });
        }else{
            isCheckCode=true;
        }
        return true;
    }

    function setErrorMsg(errorMsg){
        var errorMsgInfo = $("#errorMsg").html();
        if(errorMsgInfo.indexOf(errorMsg) == -1)
        {
            if(errorMsgInfo == "")
            {
                $("#errorMsg").html(errorMsg);//\r\n
            }
            else
            {
                $("#errorMsg").html(errorMsgInfo + "<br/>" + errorMsg);//\r\n
            }
        }
        errorMsgInfo = $("#errorMsg").html();
        errorMsgInfo = errorMsgInfo.replace("<br><br>","<br/>");
        if(errorMsgInfo.indexOf("<br>") == 0)
        {
            errorMsgInfo = errorMsgInfo.substr(4,errorMsgInfo.length);
        }
        $("#errorMsg").html(errorMsgInfo);
    }

    function checkSubmit()
    {
        if(!checkCellphone())
        {
            return false;
        }
        else if(!checkPassword())
        {
            return false;
        }
        checkVCode();
        if(!isCheckCode)
        {
            return false;
        }
        CheckSMS();
        if(!isCheckSMSCode){
            return false;
        }

        if(!checkCouponCode())
        {
            return false;
        }
        return true;
    }


    function SendRegSMS(cate) {
        var errorMsgInfo = $("#errorMsg").html();
        if(!checkCellphone())
        {
            return false;
        }
        checkVCode();
        if(!isCheckCode)
        {
            return false;
        }
        errorMsgInfo = errorMsgInfo.replace("您的操作请求已达上限，请稍后再试。","");
        errorMsgInfo = errorMsgInfo.replace("您的操作请求过于频繁，请稍后再试。","");
        $("#errorMsg").html(errorMsgInfo);
        var randomPageId = $("#randomPageId").val();
        var checkCode = $("#checkCode").val();
        $.ajax({
            url: '/m/sso/registerCellphoneForSendingVerificationCode',
            data: {
                cellphone: $('#cellphone').val(),
                msType: cate,
                randomPageId:randomPageId,
                checkCode:checkCode
            },
            type: 'post',
            cache: false,
            dataType: 'json',
            success: function (data) {
                if (data.success != true) {
                    setErrorMsg(data.message);
                } else {
                    $('#msgID').val(data.data.msgID);
                    var randomPageId2 = data.data.randomPageId;
                    if(randomPageId2!=null&&randomPageId2.length>0){
                        $("#randomPageId").val(data.data.randomPageId);
                        $("#codeImage").click();
                        $("#randomPageIdLi").show();
                    }
                    settime();
                }
            },
            error: function () {

            }
        });
        return false;
    }

    var countdown = 60;
    function settime() {
        var val =   document.getElementById('btnCSMS');
        var val2 = document.getElementById('btnVSMS');
        if (countdown == 0) {
            val.removeAttribute("disabled");
            $(val).val("重新获取");
            val2.removeAttribute("disabled");
            $(val2).val("获取语音验证码");
            $(val).removeClass("SMSyzm_none");
            $('#btnVSMS').parent().show();
            countdown = 60;
        } else {
            val.setAttribute("disabled", true);
            $(val).val("重新获取(" + countdown + ")");
            val2.setAttribute("disabled", true);
            $(val2).val("获取语音验证码(" + countdown + ")");
            $(val).addClass("SMSyzm_none");
            countdown--;
        }

        if(countdown!=60){
            setTimeout(function() {
                settime();
            }, 1000);
        }
    }
    var st = new SNSTime('btnCSMS', '获取短信验证码');
    var stV = new SNSTime('btnVSMS', '获取语音验证码');

    $("#code").blur(function () {
        var errorMsgInfo = $("#errorMsg").html();
        var code = $("#code").val();
        if (code == "" || code.length != 6) {
            setErrorMsg("您输入的短信验证码不正确，请查证后重试");
            return;
        } else{
            errorMsgInfo = errorMsgInfo.replace("您输入的短信验证码不正确，请查证后重试","");
            $("#errorMsg").html(errorMsgInfo);
        }
        $("#code").attr("ptitle", "");
        CheckSMS();
    });

    function CheckSMS() {
        var errorMsgInfo = $("#errorMsg").html();
        if(!checkCellphone())
        {
            isCheckSMSCode=false;
            return false;
        }

        errorMsgInfo = errorMsgInfo.replace("您输入的短信验证码不正确，请查证后重试","");
        errorMsgInfo = errorMsgInfo.replace("短信验证码已失效，请重新获取。","");
        errorMsgInfo = errorMsgInfo.replace("校验验证码错误次数过多，请重新获取短信验证码。","");
        errorMsgInfo = errorMsgInfo.replace("您输入的短信验证码不正确，请查证后重试。","");
        $("#errorMsg").html(errorMsgInfo);

        var co = $('#code').val();
        if (!co || co.length < 6 || co.length > 6) {
            setErrorMsg("您输入的短信验证码不正确，请查证后重试");
            isCheckSMSCode=false;
            return false;
        }

        $.ajax({
            url: '/sso/checkSMS',
            data: {
                cellphone: $('#cellphone').val(),
                verificationCode: co,
                sno: $('#msgID').val(),
                requestId : $('#requestId').val()
            },
            type: 'post',
            cache: false,
            dataType: 'json',
            success: function (data) {
                if (data.success != true) {
                    setErrorMsg(data.message);
                    isCheckSMSCode=false;
                    return false;
                } else{
                    isCheckSMSCode=true;
                    return true;
                }
            },
            error: function () {

            }
        });
    }
</script>

</body></html>